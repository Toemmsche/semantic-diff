export const batchPlans = `[
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "1.sql",
    "queryText": "with customer_total_return as\\n(select sr_customer_sk as ctr_customer_sk\\n,sr_store_sk as ctr_store_sk\\n,sum(SR_FEE) as ctr_total_return\\nfrom store_returns\\n,date_dim\\nwhere sr_returned_date_sk = d_date_sk\\nand d_year =2000\\ngroup by sr_customer_sk\\n,sr_store_sk)\\n select  c_customer_id\\nfrom customer_total_return ctr1\\n,store\\n,customer\\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\nfrom customer_total_return ctr2\\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\\nand s_store_sk = ctr1.ctr_store_sk\\nand s_state = 'SD'\\nand ctr1.ctr_customer_sk = c_customer_sk\\norder by c_customer_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 17.381
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Select exact_cardinality=\\"49939\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"50441\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"55820\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></Select></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"55820\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"0\\" /></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "2.sql",
    "queryText": "with wscs as\\n (select sold_date_sk\\n        ,sales_price\\n  from  (select ws_sold_date_sk sold_date_sk\\n              ,ws_ext_sales_price sales_price\\n        from web_sales) x\\n        union all\\n        select cs_sold_date_sk sold_date_sk\\n              ,cs_ext_sales_price sales_price\\n        from catalog_sales),\\n wswscs as \\n (select d_week_seq,\\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\\n from wscs\\n     ,date_dim\\n where d_date_sk = sold_date_sk\\n group by d_week_seq)\\n select d_week_seq1\\n       ,round(sun_sales1/sun_sales2,2)\\n       ,round(mon_sales1/mon_sales2,2)\\n       ,round(tue_sales1/tue_sales2,2)\\n       ,round(wed_sales1/wed_sales2,2)\\n       ,round(thu_sales1/thu_sales2,2)\\n       ,round(fri_sales1/fri_sales2,2)\\n       ,round(sat_sales1/sat_sales2,2)\\n from\\n (select wswscs.d_week_seq d_week_seq1\\n        ,sun_sales sun_sales1\\n        ,mon_sales mon_sales1\\n        ,tue_sales tue_sales1\\n        ,wed_sales wed_sales1\\n        ,thu_sales thu_sales1\\n        ,fri_sales fri_sales1\\n        ,sat_sales sat_sales1\\n  from wswscs,date_dim\\n  where date_dim.d_week_seq = wswscs.d_week_seq and\\n        d_year = 1998) y,\\n (select wswscs.d_week_seq d_week_seq2\\n        ,sun_sales sun_sales2\\n        ,mon_sales mon_sales2\\n        ,tue_sales tue_sales2\\n        ,wed_sales wed_sales2\\n        ,thu_sales thu_sales2\\n        ,fri_sales fri_sales2\\n        ,sat_sales sat_sales2\\n  from wswscs\\n      ,date_dim\\n  where date_dim.d_week_seq = wswscs.d_week_seq and\\n        d_year = 1998+1) z\\n where d_week_seq1=d_week_seq2-53\\n order by d_week_seq1;",
    "benchmarkResult": {
      "total": 51.467999999999996
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"2513\\"><Sort exact_cardinality=\\"2513\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2513\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"365\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"263\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2153563\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"2160932\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></SetOperation></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"365\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"263\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2153563\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"2160932\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></SetOperation></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "3.sql",
    "queryText": "select  dt.d_year \\n       ,item.i_brand_id brand_id \\n       ,item.i_brand brand\\n       ,sum(ss_sales_price) sum_agg\\n from  date_dim dt \\n      ,store_sales\\n      ,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n   and store_sales.ss_item_sk = item.i_item_sk\\n   and item.i_manufact_id = 816\\n   and dt.d_moy=11\\n group by dt.d_year\\n      ,item.i_brand\\n      ,item.i_brand_id\\n order by dt.d_year\\n         ,sum_agg desc\\n         ,brand_id\\n limit 100;",
    "benchmarkResult": {
      "total": 3.756
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"31\\"><Sort exact_cardinality=\\"31\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"31\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"287\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1981\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"11\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"6000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "4.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\\n       ,'c' sale_type\\n from customer\\n     ,catalog_sales\\n     ,date_dim\\n where c_customer_sk = cs_bill_customer_sk\\n   and cs_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\nunion all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n         )\\n  select  \\n                  t_s_secyear.customer_id\\n                 ,t_s_secyear.customer_first_name\\n                 ,t_s_secyear.customer_last_name\\n                 ,t_s_secyear.customer_birth_country\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_c_firstyear\\n     ,year_total t_c_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n   and t_s_firstyear.sale_type = 's'\\n   and t_c_firstyear.sale_type = 'c'\\n   and t_w_firstyear.sale_type = 'w'\\n   and t_s_secyear.sale_type = 's'\\n   and t_c_secyear.sale_type = 'c'\\n   and t_w_secyear.sale_type = 'w'\\n   and t_s_firstyear.dyear =  1999\\n   and t_s_secyear.dyear = 1999+1\\n   and t_c_firstyear.dyear =  1999\\n   and t_c_secyear.dyear =  1999+1\\n   and t_w_firstyear.dyear = 1999\\n   and t_w_secyear.dyear = 1999+1\\n   and t_s_firstyear.year_total > 0\\n   and t_c_firstyear.year_total > 0\\n   and t_w_firstyear.year_total > 0\\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\\n order by t_s_secyear.customer_id\\n         ,t_s_secyear.customer_first_name\\n         ,t_s_secyear.customer_last_name\\n         ,t_s_secyear.customer_birth_country\\nlimit 100;",
    "benchmarkResult": {
      "total": 259.319
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"4\\"><Sort exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"140\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"354\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1276\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11153\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142164\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142182\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy><Select exact_cardinality=\\"11077\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11256\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142842\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142857\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"27449\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"286844\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"287535\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"38252\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"540806\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"553861\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"9835\\"><Select exact_cardinality=\\"26331\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"27379\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285027\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285693\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select><Select exact_cardinality=\\"37708\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"37708\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"531222\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"544141\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "5.sql",
    "queryText": "with ssr as\\n (select s_store_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  ss_store_sk as store_sk,\\n            ss_sold_date_sk  as date_sk,\\n            ss_ext_sales_price as sales_price,\\n            ss_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from store_sales\\n    union all\\n    select sr_store_sk as store_sk,\\n           sr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           sr_return_amt as return_amt,\\n           sr_net_loss as net_loss\\n    from store_returns\\n   ) salesreturns,\\n     date_dim,\\n     store\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date) \\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and store_sk = s_store_sk\\n group by s_store_id)\\n ,\\n csr as\\n (select cp_catalog_page_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  cs_catalog_page_sk as page_sk,\\n            cs_sold_date_sk  as date_sk,\\n            cs_ext_sales_price as sales_price,\\n            cs_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from catalog_sales\\n    union all\\n    select cr_catalog_page_sk as page_sk,\\n           cr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           cr_return_amount as return_amt,\\n           cr_net_loss as net_loss\\n    from catalog_returns\\n   ) salesreturns,\\n     date_dim,\\n     catalog_page\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date)\\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and page_sk = cp_catalog_page_sk\\n group by cp_catalog_page_id)\\n ,\\n wsr as\\n (select web_site_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  ws_web_site_sk as wsr_web_site_sk,\\n            ws_sold_date_sk  as date_sk,\\n            ws_ext_sales_price as sales_price,\\n            ws_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from web_sales\\n    union all\\n    select ws_web_site_sk as wsr_web_site_sk,\\n           wr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           wr_return_amt as return_amt,\\n           wr_net_loss as net_loss\\n    from web_returns left outer join web_sales on\\n         ( wr_item_sk = ws_item_sk\\n           and wr_order_number = ws_order_number)\\n   ) salesreturns,\\n     date_dim,\\n     web_site\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date)\\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and wsr_web_site_sk = web_site_sk\\n group by web_site_id)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , 'store' || s_store_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from   ssr\\n union all\\n select 'catalog channel' as channel\\n        , 'catalog_page' || cp_catalog_page_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from  csr\\n union all\\n select 'web channel' as channel\\n        , 'web_site' || web_site_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from   wsr\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 13.431000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"606\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"602\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"587\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"30223\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"30903\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"15\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"3167918\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></SetOperation></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"581\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15841\\"><TableScan table_name=\\"catalog_page\\" exact_cardinality=\\"11718\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15882\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"15\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"1585615\\"><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></SetOperation></Join></Join></GroupBy></SetOperation><GroupBy method=\\"hash\\" exact_cardinality=\\"15\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8395\\"><TableScan table_name=\\"web_site\\" exact_cardinality=\\"30\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8398\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"15\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"791147\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /><Join type=\\"leftouter\\" method=\\"hash\\" exact_cardinality=\\"71763\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "6.sql",
    "queryText": "select  a.ca_state state, count(*) cnt\\n from customer_address a\\n     ,customer c\\n     ,store_sales s\\n     ,date_dim d\\n     ,item i\\n where       a.ca_address_sk = c.c_current_addr_sk\\n \\tand c.c_customer_sk = s.ss_customer_sk\\n \\tand s.ss_sold_date_sk = d.d_date_sk\\n \\tand s.ss_item_sk = i.i_item_sk\\n \\tand d.d_month_seq = \\n \\t     (select distinct (d_month_seq)\\n \\t      from date_dim\\n               where d_year = 2002\\n \\t        and d_moy = 3 )\\n \\tand i.i_current_price > 1.2 * \\n             (select avg(j.i_current_price) \\n \\t     from item j \\n \\t     where j.i_category = i.i_category)\\n group by a.ca_state\\n having count(*) >= 10\\n order by cnt, a.ca_state \\n limit 100;",
    "benchmarkResult": {
      "total": 196.282
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"44\\"><Sort exact_cardinality=\\"44\\"><Select exact_cardinality=\\"44\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"50\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"2707\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"10\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"17957\\" /></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"25904\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /></GroupBy></Sort></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2685453\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2685453\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750652\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"100000\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Join></Join></Join></Join></Join></GroupBy></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "7.sql",
    "queryText": "select  i_item_id, \\n        avg(ss_quantity) agg1,\\n        avg(ss_list_price) agg2,\\n        avg(ss_coupon_amt) agg3,\\n        avg(ss_sales_price) agg4 \\n from store_sales, customer_demographics, date_dim, item, promotion\\n where ss_sold_date_sk = d_date_sk and\\n       ss_item_sk = i_item_sk and\\n       ss_cdemo_sk = cd_demo_sk and\\n       ss_promo_sk = p_promo_sk and\\n       cd_gender = 'F' and \\n       cd_marital_status = 'W' and\\n       cd_education_status = 'College' and\\n       (p_channel_email = 'N' or p_channel_event = 'N') and\\n       d_year = 2001 \\n group by i_item_id\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 54.82299999999999
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"4864\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7084\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7084\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"299\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7213\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"546310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"27440\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "8.sql",
    "queryText": "select  s_store_name\\n      ,sum(ss_net_profit)\\n from store_sales\\n     ,date_dim\\n     ,store,\\n     (select ca_zip\\n     from (\\n      SELECT substr(ca_zip,1,5) ca_zip\\n      FROM customer_address\\n      WHERE substr(ca_zip,1,5) IN (\\n                          '47602','16704','35863','28577','83910','36201',\\n                          '58412','48162','28055','41419','80332',\\n                          '38607','77817','24891','16226','18410',\\n                          '21231','59345','13918','51089','20317',\\n                          '17167','54585','67881','78366','47770',\\n                          '18360','51717','73108','14440','21800',\\n                          '89338','45859','65501','34948','25973',\\n                          '73219','25333','17291','10374','18829',\\n                          '60736','82620','41351','52094','19326',\\n                          '25214','54207','40936','21814','79077',\\n                          '25178','75742','77454','30621','89193',\\n                          '27369','41232','48567','83041','71948',\\n                          '37119','68341','14073','16891','62878',\\n                          '49130','19833','24286','27700','40979',\\n                          '50412','81504','94835','84844','71954',\\n                          '39503','57649','18434','24987','12350',\\n                          '86379','27413','44529','98569','16515',\\n                          '27287','24255','21094','16005','56436',\\n                          '91110','68293','56455','54558','10298',\\n                          '83647','32754','27052','51766','19444',\\n                          '13869','45645','94791','57631','20712',\\n                          '37788','41807','46507','21727','71836',\\n                          '81070','50632','88086','63991','20244',\\n                          '31655','51782','29818','63792','68605',\\n                          '94898','36430','57025','20601','82080',\\n                          '33869','22728','35834','29086','92645',\\n                          '98584','98072','11652','78093','57553',\\n                          '43830','71144','53565','18700','90209',\\n                          '71256','38353','54364','28571','96560',\\n                          '57839','56355','50679','45266','84680',\\n                          '34306','34972','48530','30106','15371',\\n                          '92380','84247','92292','68852','13338',\\n                          '34594','82602','70073','98069','85066',\\n                          '47289','11686','98862','26217','47529',\\n                          '63294','51793','35926','24227','14196',\\n                          '24594','32489','99060','49472','43432',\\n                          '49211','14312','88137','47369','56877',\\n                          '20534','81755','15794','12318','21060',\\n                          '73134','41255','63073','81003','73873',\\n                          '66057','51184','51195','45676','92696',\\n                          '70450','90669','98338','25264','38919',\\n                          '59226','58581','60298','17895','19489',\\n                          '52301','80846','95464','68770','51634',\\n                          '19988','18367','18421','11618','67975',\\n                          '25494','41352','95430','15734','62585',\\n                          '97173','33773','10425','75675','53535',\\n                          '17879','41967','12197','67998','79658',\\n                          '59130','72592','14851','43933','68101',\\n                          '50636','25717','71286','24660','58058',\\n                          '72991','95042','15543','33122','69280',\\n                          '11912','59386','27642','65177','17672',\\n                          '33467','64592','36335','54010','18767',\\n                          '63193','42361','49254','33113','33159',\\n                          '36479','59080','11855','81963','31016',\\n                          '49140','29392','41836','32958','53163',\\n                          '13844','73146','23952','65148','93498',\\n                          '14530','46131','58454','13376','13378',\\n                          '83986','12320','17193','59852','46081',\\n                          '98533','52389','13086','68843','31013',\\n                          '13261','60560','13443','45533','83583',\\n                          '11489','58218','19753','22911','25115',\\n                          '86709','27156','32669','13123','51933',\\n                          '39214','41331','66943','14155','69998',\\n                          '49101','70070','35076','14242','73021',\\n                          '59494','15782','29752','37914','74686',\\n                          '83086','34473','15751','81084','49230',\\n                          '91894','60624','17819','28810','63180',\\n                          '56224','39459','55233','75752','43639',\\n                          '55349','86057','62361','50788','31830',\\n                          '58062','18218','85761','60083','45484',\\n                          '21204','90229','70041','41162','35390',\\n                          '16364','39500','68908','26689','52868',\\n                          '81335','40146','11340','61527','61794',\\n                          '71997','30415','59004','29450','58117',\\n                          '69952','33562','83833','27385','61860',\\n                          '96435','48333','23065','32961','84919',\\n                          '61997','99132','22815','56600','68730',\\n                          '48017','95694','32919','88217','27116',\\n                          '28239','58032','18884','16791','21343',\\n                          '97462','18569','75660','15475')\\n     intersect\\n      select ca_zip\\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\\n            FROM customer_address, customer\\n            WHERE ca_address_sk = c_current_addr_sk and\\n                  c_preferred_cust_flag='Y'\\n            group by ca_zip\\n            having count(*) > 10)A1)A2) V1\\n where ss_store_sk = s_store_sk\\n  and ss_sold_date_sk = d_date_sk\\n  and d_qoy = 2 and d_year = 1998\\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\\n group by s_store_name\\n order by s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 17.232999999999997
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"5\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"276\\"><Select exact_cardinality=\\"962\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3146\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"47428\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"47428\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"300\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"400\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Join></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"77230\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"78999\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "9.sql",
    "queryText": "select case when (select count(*) \\n                  from store_sales \\n                  where ss_quantity between 1 and 20) > 157344\\n            then (select avg(ss_ext_discount_amt) \\n                  from store_sales \\n                  where ss_quantity between 1 and 20) \\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 1 and 20) end bucket1 ,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) > 34708\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) \\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) end bucket2,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60) > 253327\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60) end bucket3,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80) > 272224\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80) end bucket4,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100) > 428113\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100) end bucket5\\nfrom reason\\nwhere r_reason_sk = 1\\n;",
    "benchmarkResult": {
      "total": 51.115
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><TableScan table_name=\\"reason\\" exact_cardinality=\\"1\\" /><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550003\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550003\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550003\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549402\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549402\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549402\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549650\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549650\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"549650\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550565\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550565\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550565\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550788\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550788\\" /></GroupBy></Sort></GroupBy></CrossProduct><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"550788\\" /></GroupBy></Sort></GroupBy></CrossProduct></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "10.sql",
    "queryText": "select  \\n  cd_gender,\\n  cd_marital_status,\\n  cd_education_status,\\n  count(*) cnt1,\\n  cd_purchase_estimate,\\n  count(*) cnt2,\\n  cd_credit_rating,\\n  count(*) cnt3,\\n  cd_dep_count,\\n  count(*) cnt4,\\n  cd_dep_employed_count,\\n  count(*) cnt5,\\n  cd_dep_college_count,\\n  count(*) cnt6\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  ca_county in ('Vermilion County','Park County','Dorchester County','Republic County','Hayes County') and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 2000 and\\n                d_moy between 4 and 4+3) and\\n   (exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 2000 and\\n                  d_moy between 4 ANd 4+3) or \\n    exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 2000 and\\n                  d_moy between 4 and 4+3))\\n group by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n order by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\nlimit 100;",
    "benchmarkResult": {
      "total": 20.049
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"3\\"><Sort exact_cardinality=\\"3\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"55589\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"122\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1434322\\" /></Join><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"23\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"27491\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"122\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719217\\" /></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"23\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"103310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"122\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2750652\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"294\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"308\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"151\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"5\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "11.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag \\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year \\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag \\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n         )\\n  select  \\n                  t_s_secyear.customer_id\\n                 ,t_s_secyear.customer_first_name\\n                 ,t_s_secyear.customer_last_name\\n                 ,t_s_secyear.customer_login\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n         and t_s_firstyear.sale_type = 's'\\n         and t_w_firstyear.sale_type = 'w'\\n         and t_s_secyear.sale_type = 's'\\n         and t_w_secyear.sale_type = 'w'\\n         and t_s_firstyear.dyear = 2001\\n         and t_s_secyear.dyear = 2001+1\\n         and t_w_firstyear.dyear = 2001\\n         and t_w_secyear.dyear = 2001+1\\n         and t_s_firstyear.year_total > 0\\n         and t_w_firstyear.year_total > 0\\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\\n order by t_s_secyear.customer_id\\n         ,t_s_secyear.customer_first_name\\n         ,t_s_secyear.customer_last_name\\n         ,t_s_secyear.customer_login\\nlimit 100;",
    "benchmarkResult": {
      "total": 209.237
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"88\\"><Sort exact_cardinality=\\"88\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"88\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"522\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1326\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11252\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142486\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142498\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy><Select exact_cardinality=\\"11552\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11552\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"147007\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"147019\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"38175\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"536297\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"549330\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Join><Select exact_cardinality=\\"37923\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"37923\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"533564\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"546310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "12.sql",
    "queryText": "select  i_item_id\\n      ,i_item_desc \\n      ,i_category \\n      ,i_class \\n      ,i_current_price\\n      ,sum(ws_ext_sales_price) as itemrevenue \\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\\n          (partition by i_class) as revenueratio\\nfrom\\t\\n\\tweb_sales\\n    \\t,item \\n    \\t,date_dim\\nwhere \\n\\tws_item_sk = i_item_sk \\n  \\tand i_category in ('Men', 'Sports', 'Home')\\n  \\tand ws_sold_date_sk = d_date_sk\\n\\tand d_date between cast('2001-03-04' as date) \\n\\t\\t\\t\\tand (cast('2001-03-04' as date) + interval '30 days')\\ngroup by \\n\\ti_item_id\\n        ,i_item_desc \\n        ,i_category\\n        ,i_class\\n        ,i_current_price\\norder by \\n\\ti_category\\n        ,i_class\\n        ,i_item_id\\n        ,i_item_desc\\n        ,revenueratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 10.755
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Window exact_cardinality=\\"1500\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1500\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2183\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"214504\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"5401\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "13.sql",
    "queryText": "select avg(ss_quantity)\\n       ,avg(ss_ext_sales_price)\\n       ,avg(ss_ext_wholesale_cost)\\n       ,sum(ss_ext_wholesale_cost)\\n from store_sales\\n     ,store\\n     ,customer_demographics\\n     ,household_demographics\\n     ,customer_address\\n     ,date_dim\\n where s_store_sk = ss_store_sk\\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\\n and((ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'W'\\n  and cd_education_status = 'Advanced Degree'\\n  and ss_sales_price between 100.00 and 150.00\\n  and hd_dep_count = 3   \\n     )or\\n     (ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'U'\\n  and cd_education_status = 'Primary'\\n  and ss_sales_price between 50.00 and 100.00   \\n  and hd_dep_count = 1\\n     ) or \\n     (ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'S'\\n  and cd_education_status = '4 yr Degree'\\n  and ss_sales_price between 150.00 and 200.00 \\n  and hd_dep_count = 1  \\n     ))\\n and((ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('NE', 'IN', 'NC')\\n  and ss_net_profit between 100 and 200  \\n     ) or\\n     (ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('ID', 'GA', 'ME')\\n  and ss_net_profit between 150 and 300  \\n     ) or\\n     (ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('TN', 'AL', 'FL')\\n  and ss_net_profit between 50 and 250  \\n     ))\\n;",
    "benchmarkResult": {
      "total": 29.528
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5005\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5028\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5056\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"48475\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"546310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></GroupBy></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "14a.sql",
    "queryText": "with  cross_items as\\n (select i_item_sk ss_item_sk\\n from item,\\n (select iss.i_brand_id brand_id\\n     ,iss.i_class_id class_id\\n     ,iss.i_category_id category_id\\n from store_sales\\n     ,item iss\\n     ,date_dim d1\\n where ss_item_sk = iss.i_item_sk\\n   and ss_sold_date_sk = d1.d_date_sk\\n   and d1.d_year between 1998 AND 1998 + 2\\n intersect\\n select ics.i_brand_id\\n     ,ics.i_class_id\\n     ,ics.i_category_id\\n from catalog_sales\\n     ,item ics\\n     ,date_dim d2\\n where cs_item_sk = ics.i_item_sk\\n   and cs_sold_date_sk = d2.d_date_sk\\n   and d2.d_year between 1998 AND 1998 + 2\\n intersect\\n select iws.i_brand_id\\n     ,iws.i_class_id\\n     ,iws.i_category_id\\n from web_sales\\n     ,item iws\\n     ,date_dim d3\\n where ws_item_sk = iws.i_item_sk\\n   and ws_sold_date_sk = d3.d_date_sk\\n   and d3.d_year between 1998 AND 1998 + 2) x\\n where i_brand_id = brand_id\\n      and i_class_id = class_id\\n      and i_category_id = category_id\\n),\\n avg_sales as\\n (select avg(quantity*list_price) average_sales\\n  from (select ss_quantity quantity\\n             ,ss_list_price list_price\\n       from store_sales\\n           ,date_dim\\n       where ss_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select cs_quantity quantity\\n             ,cs_list_price list_price\\n       from catalog_sales\\n           ,date_dim\\n       where cs_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select ws_quantity quantity\\n             ,ws_list_price list_price\\n       from web_sales\\n           ,date_dim\\n       where ws_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2) x)\\n  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)::integer\\n from(\\n       select 'store' channel, i_brand_id,i_class_id\\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\\n             , count(*) number_sales\\n       from store_sales\\n           ,item\\n           ,date_dim\\n       where ss_item_sk in (select ss_item_sk from cross_items)\\n         and ss_item_sk = i_item_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\\n       union all\\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\\n       from catalog_sales\\n           ,item\\n           ,date_dim\\n       where cs_item_sk in (select ss_item_sk from cross_items)\\n         and cs_item_sk = i_item_sk\\n         and cs_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\\n       union all\\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\\n       from web_sales\\n           ,item\\n           ,date_dim\\n       where ws_item_sk in (select ss_item_sk from cross_items)\\n         and ws_item_sk = i_item_sk\\n         and ws_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\\n ) y\\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\\n order by channel,i_brand_id,i_class_id,i_category_id\\n limit 100;",
    "benchmarkResult": {
      "total": 145.02200000000002
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"14754\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"6854\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"4831\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"2447\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2935653\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2507514\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"2450\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"88270\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14626\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"88679\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"88679\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"2384\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2935653\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2507514\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"2440\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"46529\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14626\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"46730\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"46730\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Join></SetOperation><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"2023\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2935653\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2507514\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"2343\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"22312\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14626\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22399\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22399\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "14b.sql",
    "queryText": "with  cross_items as\\n (select i_item_sk ss_item_sk\\n from item,\\n (select iss.i_brand_id brand_id\\n     ,iss.i_class_id class_id\\n     ,iss.i_category_id category_id\\n from store_sales\\n     ,item iss\\n     ,date_dim d1\\n where ss_item_sk = iss.i_item_sk\\n   and ss_sold_date_sk = d1.d_date_sk\\n   and d1.d_year between 1998 AND 1998 + 2\\n intersect\\n select ics.i_brand_id\\n     ,ics.i_class_id\\n     ,ics.i_category_id\\n from catalog_sales\\n     ,item ics\\n     ,date_dim d2\\n where cs_item_sk = ics.i_item_sk\\n   and cs_sold_date_sk = d2.d_date_sk\\n   and d2.d_year between 1998 AND 1998 + 2\\n intersect\\n select iws.i_brand_id\\n     ,iws.i_class_id\\n     ,iws.i_category_id\\n from web_sales\\n     ,item iws\\n     ,date_dim d3\\n where ws_item_sk = iws.i_item_sk\\n   and ws_sold_date_sk = d3.d_date_sk\\n   and d3.d_year between 1998 AND 1998 + 2) x\\n where i_brand_id = brand_id\\n      and i_class_id = class_id\\n      and i_category_id = category_id\\n),\\n avg_sales as\\n(select avg(quantity*list_price) average_sales\\n  from (select ss_quantity quantity\\n             ,ss_list_price list_price\\n       from store_sales\\n           ,date_dim\\n       where ss_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select cs_quantity quantity\\n             ,cs_list_price list_price\\n       from catalog_sales\\n           ,date_dim\\n       where cs_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select ws_quantity quantity\\n             ,ws_list_price list_price\\n       from web_sales\\n           ,date_dim\\n       where ws_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2) x)\\n  select  * from\\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\\n from store_sales \\n     ,item\\n     ,date_dim\\n where ss_item_sk in (select ss_item_sk from cross_items)\\n   and ss_item_sk = i_item_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_week_seq = (select d_week_seq\\n                     from date_dim\\n                     where d_year = 1998 + 1\\n                       and d_moy = 12\\n                       and d_dom = 20)\\n group by i_brand_id,i_class_id,i_category_id\\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\\n (select 'store' channel, i_brand_id,i_class_id\\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\\n from store_sales\\n     ,item\\n     ,date_dim\\n where ss_item_sk in (select ss_item_sk from cross_items)\\n   and ss_item_sk = i_item_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_week_seq = (select d_week_seq\\n                     from date_dim\\n                     where d_year = 1998\\n                       and d_moy = 12\\n                       and d_dom = 20)\\n group by i_brand_id,i_class_id,i_category_id\\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\\n where this_year.i_brand_id= last_year.i_brand_id\\n   and this_year.i_class_id = last_year.i_class_id\\n   and this_year.i_category_id = last_year.i_category_id\\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\\n limit 100;",
    "benchmarkResult": {
      "total": 108.77000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"795\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"812\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2935653\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2507514\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"836\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"20736\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1\\" /></Sort></GroupBy><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2447472\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14626\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750311\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2880404\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"816\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2935653\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2507514\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></SetOperation></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"837\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21817\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1\\" /></Sort></GroupBy><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2447472\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14626\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"428139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2537\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"858916\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1648598\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></GroupBy></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750311\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2880404\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "15.sql",
    "queryText": "select  ca_zip\\n       ,sum(cs_sales_price)\\n from catalog_sales\\n     ,customer\\n     ,customer_address\\n     ,date_dim\\n where cs_bill_customer_sk = c_customer_sk\\n \\tand c_current_addr_sk = ca_address_sk \\n \\tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\\n                                   '85392', '85460', '80348', '81792')\\n \\t      or ca_state in ('CA','WA','GA')\\n \\t      or cs_sales_price > 500)\\n \\tand cs_sold_date_sk = d_date_sk\\n \\tand d_qoy = 1 and d_year = 2000\\n group by ca_zip\\n order by ca_zip\\n limit 100;",
    "benchmarkResult": {
      "total": 29.192
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"192\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3305\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"115807\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"9\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1434519\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"100000\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "16.sql",
    "queryText": "select  \\n   count(distinct cs_order_number) as \\"order count\\"\\n  ,sum(cs_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(cs_net_profit) as \\"total net profit\\"\\nfrom\\n   catalog_sales cs1\\n  ,date_dim\\n  ,customer_address\\n  ,call_center\\nwhere\\n    d_date between '2002-2-01' and \\n           (cast('2002-2-01' as date) + interval '60 days')\\nand cs1.cs_ship_date_sk = d_date_sk\\nand cs1.cs_ship_addr_sk = ca_address_sk\\nand ca_state = 'WA'\\nand cs1.cs_call_center_sk = cc_call_center_sk\\nand cc_county in ('Ziebach County','Walker County','Williamson County','Walker County',\\n                  'Ziebach County'\\n)\\nand exists (select *\\n            from catalog_sales cs2\\n            where cs1.cs_order_number = cs2.cs_order_number\\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\\nand not exists(select *\\n               from catalog_returns cr1\\n               where cs1.cs_order_number = cr1.cr_order_number)\\norder by count(distinct cs_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 29.911
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1434402\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"6\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"5\\" /><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"631\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "17.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,s_state\\n       ,count(ss_quantity) as store_sales_quantitycount\\n       ,avg(ss_quantity) as store_sales_quantityave\\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\\n       ,count(sr_return_quantity) as store_returns_quantitycount\\n       ,avg(sr_return_quantity) as store_returns_quantityave\\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\\n from store_sales\\n     ,store_returns\\n     ,catalog_sales\\n     ,date_dim d1\\n     ,date_dim d2\\n     ,date_dim d3\\n     ,store\\n     ,item\\n where d1.d_quarter_name = '2000Q1'\\n   and d1.d_date_sk = ss_sold_date_sk\\n   and i_item_sk = ss_item_sk\\n   and s_store_sk = ss_store_sk\\n   and ss_customer_sk = sr_customer_sk\\n   and ss_item_sk = sr_item_sk\\n   and ss_ticket_number = sr_ticket_number\\n   and sr_returned_date_sk = d2.d_date_sk\\n   and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\\n   and sr_customer_sk = cs_bill_customer_sk\\n   and sr_item_sk = cs_item_sk\\n   and cs_sold_date_sk = d3.d_date_sk\\n   and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\\n group by i_item_id\\n         ,i_item_desc\\n         ,s_state\\n order by i_item_id\\n         ,i_item_desc\\n         ,s_state\\nlimit 100;",
    "benchmarkResult": {
      "total": 25.298000000000002
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"274\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6143\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"82213\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"84199\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"84199\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"40672\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"274\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></Join><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "18.sql",
    "queryText": "select  i_item_id,\\n        ca_country,\\n        ca_state, \\n        ca_county,\\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\\n from catalog_sales, customer_demographics cd1, \\n      customer_demographics cd2, customer, customer_address, date_dim, item\\n where cs_sold_date_sk = d_date_sk and\\n       cs_item_sk = i_item_sk and\\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\\n       cs_bill_customer_sk = c_customer_sk and\\n       cd1.cd_gender = 'M' and \\n       cd1.cd_education_status = '4 yr Degree' and\\n       c_current_cdemo_sk = cd2.cd_demo_sk and\\n       c_current_addr_sk = ca_address_sk and\\n       c_birth_month in (6,8,3,11,9,10) and\\n       d_year = 2001 and\\n       ca_state in ('AR','TN','KS'\\n                   ,'TX','SD','NY','IN')\\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\\n order by ca_country,\\n        ca_state, \\n        ca_county,\\n\\ti_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 48.868
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"7140\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1913\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1949\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1949\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"30704\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11097\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"11576\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"7\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"48489\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"6\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"286707\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"137200\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "19.sql",
    "queryText": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\\n \\tsum(ss_ext_sales_price) ext_price\\n from date_dim, store_sales, item,customer,customer_address,store\\n where d_date_sk = ss_sold_date_sk\\n   and ss_item_sk = i_item_sk\\n   and i_manager_id=13\\n   and d_moy=12\\n   and d_year=2000\\n   and ss_customer_sk = c_customer_sk \\n   and c_current_addr_sk = ca_address_sk\\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \\n   and ss_store_sk = s_store_sk \\n group by i_brand\\n      ,i_brand_id\\n      ,i_manufact_id\\n      ,i_manufact\\n order by ext_price desc\\n         ,i_brand\\n         ,i_brand_id\\n         ,i_manufact_id\\n         ,i_manufact\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 120.624
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"181\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1710\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"48376\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"339\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2599183\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1161208\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"581008\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "20.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc \\n       ,i_category \\n       ,i_class \\n       ,i_current_price\\n       ,sum(cs_ext_sales_price) as itemrevenue \\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\\n           (partition by i_class) as revenueratio\\n from\\tcatalog_sales\\n     ,item \\n     ,date_dim\\n where cs_item_sk = i_item_sk \\n   and i_category in ('Children', 'Men', 'Sports')\\n   and cs_sold_date_sk = d_date_sk\\n and d_date between cast('1999-05-24' as date) \\n \\t\\t\\t\\tand (cast('1999-05-24' as date) + interval '30 days')\\n group by i_item_id\\n         ,i_item_desc \\n         ,i_category\\n         ,i_class\\n         ,i_current_price\\n order by i_category\\n         ,i_class\\n         ,i_item_id\\n         ,i_item_desc\\n         ,revenueratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 14.401
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Window exact_cardinality=\\"2116\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"2116\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4204\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"427674\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"5380\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "21.sql",
    "queryText": "select  *\\n from(select w_warehouse_name\\n            ,i_item_id\\n            ,sum(case when (cast(d_date as date) < cast ('2002-05-26' as date))\\n\\t                then inv_quantity_on_hand \\n                      else 0 end) as inv_before\\n            ,sum(case when (cast(d_date as date) >= cast ('2002-05-26' as date))\\n                      then inv_quantity_on_hand \\n                      else 0 end) as inv_after\\n   from inventory\\n       ,warehouse\\n       ,item\\n       ,date_dim\\n   where i_current_price between 0.99 and 1.49\\n     and i_item_sk          = inv_item_sk\\n     and inv_warehouse_sk   = w_warehouse_sk\\n     and inv_date_sk    = d_date_sk\\n     and d_date between (cast ('2002-05-26' as date) - interval '30 days')\\n                    and (cast ('2002-05-26' as date) + interval '30 days')\\n   group by w_warehouse_name, i_item_id) x\\n where (case when inv_before > 0 \\n             then inv_after / inv_before \\n             else null\\n             end) between 2.0/3.0 and 3.0/2.0\\n order by w_warehouse_name\\n         ,i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 12.669
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Select exact_cardinality=\\"1220\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"2840\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22720\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22720\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1104\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"360000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"61\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></Join></GroupBy></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "22.sql",
    "queryText": "select  i_product_name\\n             ,i_brand\\n             ,i_class\\n             ,i_category\\n             ,avg(inv_quantity_on_hand::bigint) qoh\\n       from inventory\\n           ,date_dim\\n           ,item\\n       where inv_date_sk=d_date_sk\\n              and inv_item_sk=i_item_sk\\n              and d_month_seq between 1219 and 1219 + 11\\n       group by rollup(i_product_name\\n                       ,i_brand\\n                       ,i_class\\n                       ,i_category)\\norder by qoh, i_product_name, i_brand, i_class, i_category\\nlimit 100;",
    "benchmarkResult": {
      "total": 322.749
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"47968\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2340000\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2340000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "23a.sql",
    "queryText": "with frequent_ss_items as \\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\\n  from store_sales\\n      ,date_dim \\n      ,item\\n  where ss_sold_date_sk = d_date_sk\\n    and ss_item_sk = i_item_sk \\n    and d_year in (1999,1999+1,1999+2,1999+3)\\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\\n  having count(*) >4),\\n max_store_sales as\\n (select max(csales) tpcds_cmax \\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\\n        from store_sales\\n            ,customer\\n            ,date_dim \\n        where ss_customer_sk = c_customer_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year in (1999,1999+1,1999+2,1999+3) \\n        group by c_customer_sk) x),\\n best_ss_customer as\\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\\n  from store_sales\\n      ,customer\\n  where ss_customer_sk = c_customer_sk\\n  group by c_customer_sk\\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\\n  *\\nfrom\\n max_store_sales))\\n  select  sum(sales)\\n from (select cs_quantity*cs_list_price sales\\n       from catalog_sales\\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and cs_sold_date_sk = d_date_sk \\n         and cs_item_sk in (select item_sk from frequent_ss_items)\\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n      union all\\n      select ws_quantity*ws_list_price sales\\n       from web_sales \\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and ws_sold_date_sk = d_date_sk \\n         and ws_item_sk in (select item_sk from frequent_ss_items)\\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) y\\n limit 100;",
    "benchmarkResult": {
      "total": 576.308
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"0\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"14\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"85116\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2141889\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"90858\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750652\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"66\\"><Select exact_cardinality=\\"65\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1975696\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Select><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14197\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"14\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"85116\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2141889\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"90858\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750652\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"31\\"><Select exact_cardinality=\\"65\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1975696\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Select><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7125\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "23b.sql",
    "queryText": "with frequent_ss_items as\\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\\n  from store_sales\\n      ,date_dim\\n      ,item\\n  where ss_sold_date_sk = d_date_sk\\n    and ss_item_sk = i_item_sk\\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\\n  having count(*) >4),\\n max_store_sales as\\n (select max(csales) tpcds_cmax\\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\\n        from store_sales\\n            ,customer\\n            ,date_dim \\n        where ss_customer_sk = c_customer_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year in (1999,1999+1,1999+2,1999+3)\\n        group by c_customer_sk) x),\\n best_ss_customer as\\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\\n  from store_sales\\n      ,customer\\n  where ss_customer_sk = c_customer_sk\\n  group by c_customer_sk\\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\\n  *\\n from max_store_sales))\\n  select  c_last_name,c_first_name,sales\\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\\n        from catalog_sales\\n            ,customer\\n            ,date_dim \\n        where d_year = 1999 \\n         and d_moy = 7 \\n         and cs_sold_date_sk = d_date_sk \\n         and cs_item_sk in (select item_sk from frequent_ss_items)\\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n         and cs_bill_customer_sk = c_customer_sk \\n       group by c_last_name,c_first_name\\n      union all\\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\\n       from web_sales\\n           ,customer\\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and ws_sold_date_sk = d_date_sk \\n         and ws_item_sk in (select item_sk from frequent_ss_items)\\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n         and ws_bill_customer_sk = c_customer_sk\\n       group by c_last_name,c_first_name) y\\n     order by c_last_name,c_first_name,sales\\n  limit 100;",
    "benchmarkResult": {
      "total": 477.742
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"14\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"85116\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2141889\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"90858\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750652\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"66\\"><Select exact_cardinality=\\"65\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1975696\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Select><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14164\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14197\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"14\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"85116\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2141889\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"90858\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750652\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"31\\"><Select exact_cardinality=\\"65\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1975696\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2193642\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1461\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Select><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7124\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7125\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Join></Join></GroupBy></SetOperation></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "24a.sql",
    "queryText": "with ssales as\\n(select c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,ca_state\\n      ,s_state\\n      ,i_color\\n      ,i_current_price\\n      ,i_manager_id\\n      ,i_units\\n      ,i_size\\n      ,sum(ss_sales_price) netpaid\\nfrom store_sales\\n    ,store_returns\\n    ,store\\n    ,item\\n    ,customer\\n    ,customer_address\\nwhere ss_ticket_number = sr_ticket_number\\n  and ss_item_sk = sr_item_sk\\n  and ss_customer_sk = c_customer_sk\\n  and ss_item_sk = i_item_sk\\n  and ss_store_sk = s_store_sk\\n  and c_current_addr_sk = ca_address_sk\\n  and c_birth_country <> upper(ca_country)\\n  and s_zip = ca_zip\\nand s_market_id=9\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n        ,ca_state\\n        ,s_state\\n        ,i_color\\n        ,i_current_price\\n        ,i_manager_id\\n        ,i_units\\n        ,i_size)\\nselect c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,sum(netpaid) paid\\nfrom ssales\\nwhere i_color = 'chocolate'\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\\n                                 from ssales)\\norder by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n;",
    "benchmarkResult": {
      "total": 16.1
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"42\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"42\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"74\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"44\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"38\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"74\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"44\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "24b.sql",
    "queryText": "with ssales as\\n(select c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,ca_state\\n      ,s_state\\n      ,i_color\\n      ,i_current_price\\n      ,i_manager_id\\n      ,i_units\\n      ,i_size\\n      ,sum(ss_sales_price) netpaid\\nfrom store_sales\\n    ,store_returns\\n    ,store\\n    ,item\\n    ,customer\\n    ,customer_address\\nwhere ss_ticket_number = sr_ticket_number\\n  and ss_item_sk = sr_item_sk\\n  and ss_customer_sk = c_customer_sk\\n  and ss_item_sk = i_item_sk\\n  and ss_store_sk = s_store_sk\\n  and c_current_addr_sk = ca_address_sk\\n  and c_birth_country <> upper(ca_country)\\n  and s_zip = ca_zip\\n  and s_market_id = 9\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n        ,ca_state\\n        ,s_state\\n        ,i_color\\n        ,i_current_price\\n        ,i_manager_id\\n        ,i_units\\n        ,i_size)\\nselect c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,sum(netpaid) paid\\nfrom ssales\\nwhere i_color = 'lawn'\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\\n                           from ssales)\\norder by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n;",
    "benchmarkResult": {
      "total": 24.69
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"42\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"42\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"74\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"44\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"137\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"396\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"74\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"44\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></GroupBy></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "25.sql",
    "queryText": "select  \\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n ,stddev_samp(ss_net_profit) as store_sales_profit\\n ,stddev_samp(sr_net_loss) as store_returns_loss\\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\\n from\\n store_sales\\n ,store_returns\\n ,catalog_sales\\n ,date_dim d1\\n ,date_dim d2\\n ,date_dim d3\\n ,store\\n ,item\\n where\\n d1.d_moy = 4\\n and d1.d_year = 2002\\n and d1.d_date_sk = ss_sold_date_sk\\n and i_item_sk = ss_item_sk\\n and s_store_sk = ss_store_sk\\n and ss_customer_sk = sr_customer_sk\\n and ss_item_sk = sr_item_sk\\n and ss_ticket_number = sr_ticket_number\\n and sr_returned_date_sk = d2.d_date_sk\\n and d2.d_moy               between 4 and  10\\n and d2.d_year              = 2002\\n and sr_customer_sk = cs_bill_customer_sk\\n and sr_item_sk = cs_item_sk\\n and cs_sold_date_sk = d3.d_date_sk\\n and d3.d_moy               between 4 and  10 \\n and d3.d_year              = 2002\\n group by\\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n order by\\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 15.741000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"25859\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"214\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"149388\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"214\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "26.sql",
    "queryText": "select  i_item_id, \\n        avg(cs_quantity) agg1,\\n        avg(cs_list_price) agg2,\\n        avg(cs_coupon_amt) agg3,\\n        avg(cs_sales_price) agg4 \\n from catalog_sales, customer_demographics, date_dim, item, promotion\\n where cs_sold_date_sk = d_date_sk and\\n       cs_item_sk = i_item_sk and\\n       cs_bill_cdemo_sk = cd_demo_sk and\\n       cs_promo_sk = p_promo_sk and\\n       cd_gender = 'M' and \\n       cd_marital_status = 'D' and\\n       cd_education_status = 'Secondary' and\\n       (p_channel_email = 'N' or p_channel_event = 'N') and\\n       d_year = 2001 \\n group by i_item_id\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 40.756
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3095\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3784\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3784\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"299\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3803\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"286707\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"27440\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "27.sql",
    "queryText": "select  i_item_id,\\n        s_state, grouping(s_state) g_state,\\n        avg(ss_quantity) agg1,\\n        avg(ss_list_price) agg2,\\n        avg(ss_coupon_amt) agg3,\\n        avg(ss_sales_price) agg4\\n from store_sales, customer_demographics, date_dim, store, item\\n where ss_sold_date_sk = d_date_sk and\\n       ss_item_sk = i_item_sk and\\n       ss_store_sk = s_store_sk and\\n       ss_cdemo_sk = cd_demo_sk and\\n       cd_gender = 'F' and\\n       cd_marital_status = 'M' and\\n       cd_education_status = 'Advanced Degree' and\\n       d_year = 1998 and\\n       s_state in ('TN','AL', 'SD', 'SD', 'SD', 'SD')\\n group by rollup (i_item_id, s_state)\\n order by i_item_id\\n         ,s_state\\n limit 100;",
    "benchmarkResult": {
      "total": 61.744
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"9775\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7100\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"6\\" /><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7191\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"550596\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"27440\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "28.sql",
    "queryText": "select  *\\nfrom (select avg(ss_list_price) B1_LP\\n            ,count(ss_list_price) B1_CNT\\n            ,count(distinct ss_list_price) B1_CNTD\\n      from store_sales\\n      where ss_quantity between 0 and 5\\n        and (ss_list_price between 32 and 32+10 \\n             or ss_coupon_amt between 4429 and 4429+1000\\n             or ss_wholesale_cost between 0 and 0+20)) B1,\\n     (select avg(ss_list_price) B2_LP\\n            ,count(ss_list_price) B2_CNT\\n            ,count(distinct ss_list_price) B2_CNTD\\n      from store_sales\\n      where ss_quantity between 6 and 10\\n        and (ss_list_price between 170 and 170+10\\n          or ss_coupon_amt between 4727 and 4727+1000\\n          or ss_wholesale_cost between 8 and 8+20)) B2,\\n     (select avg(ss_list_price) B3_LP\\n            ,count(ss_list_price) B3_CNT\\n            ,count(distinct ss_list_price) B3_CNTD\\n      from store_sales\\n      where ss_quantity between 11 and 15\\n        and (ss_list_price between 124 and 124+10\\n          or ss_coupon_amt between 9657 and 9657+1000\\n          or ss_wholesale_cost between 43 and 43+20)) B3,\\n     (select avg(ss_list_price) B4_LP\\n            ,count(ss_list_price) B4_CNT\\n            ,count(distinct ss_list_price) B4_CNTD\\n      from store_sales\\n      where ss_quantity between 16 and 20\\n        and (ss_list_price between 104 and 104+10\\n          or ss_coupon_amt between 17161 and 17161+1000\\n          or ss_wholesale_cost between 34 and 34+20)) B4,\\n     (select avg(ss_list_price) B5_LP\\n            ,count(ss_list_price) B5_CNT\\n            ,count(distinct ss_list_price) B5_CNTD\\n      from store_sales\\n      where ss_quantity between 21 and 25\\n        and (ss_list_price between 73 and 73+10\\n          or ss_coupon_amt between 17064 and 17064+1000\\n          or ss_wholesale_cost between 56 and 56+20)) B5,\\n     (select avg(ss_list_price) B6_LP\\n            ,count(ss_list_price) B6_CNT\\n            ,count(distinct ss_list_price) B6_CNTD\\n      from store_sales\\n      where ss_quantity between 26 and 30\\n        and (ss_list_price between 65 and 65+10\\n          or ss_coupon_amt between 10899 and 10899+1000\\n          or ss_wholesale_cost between 54 and 54+20)) B6\\nlimit 100;",
    "benchmarkResult": {
      "total": 41.13
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"34122\\" /></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"28748\\" /></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"32921\\" /></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"35082\\" /></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"32627\\" /></GroupBy><GroupBy exact_cardinality=\\"1\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"32736\\" /></GroupBy></CrossProduct></CrossProduct></CrossProduct></CrossProduct></CrossProduct></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "29.sql",
    "queryText": "select   \\n     i_item_id\\n    ,i_item_desc\\n    ,s_store_id\\n    ,s_store_name\\n    ,stddev_samp(ss_quantity)        as store_sales_quantity\\n    ,stddev_samp(sr_return_quantity) as store_returns_quantity\\n    ,stddev_samp(cs_quantity)        as catalog_sales_quantity\\n from\\n    store_sales\\n   ,store_returns\\n   ,catalog_sales\\n   ,date_dim             d1\\n   ,date_dim             d2\\n   ,date_dim             d3\\n   ,store\\n   ,item\\n where\\n     d1.d_moy               = 4 \\n and d1.d_year              = 2000\\n and d1.d_date_sk           = ss_sold_date_sk\\n and i_item_sk              = ss_item_sk\\n and s_store_sk             = ss_store_sk\\n and ss_customer_sk         = sr_customer_sk\\n and ss_item_sk             = sr_item_sk\\n and ss_ticket_number       = sr_ticket_number\\n and sr_returned_date_sk    = d2.d_date_sk\\n and d2.d_moy               between 4 and  4 + 3 \\n and d2.d_year              = 2000\\n and sr_customer_sk         = cs_bill_customer_sk\\n and sr_item_sk             = cs_item_sk\\n and cs_sold_date_sk        = d3.d_date_sk     \\n and d3.d_year              in (2000,2000+1,2000+2)\\n group by\\n    i_item_id\\n   ,i_item_desc\\n   ,s_store_id\\n   ,s_store_name\\n order by\\n    i_item_id \\n   ,i_item_desc\\n   ,s_store_id\\n   ,s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 15.454
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1096\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1116\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1130\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15723\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15723\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"122\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"25705\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "30.sql",
    "queryText": "with customer_total_return as\\n (select wr_returning_customer_sk as ctr_customer_sk\\n        ,ca_state as ctr_state, \\n \\tsum(wr_return_amt) as ctr_total_return\\n from web_returns\\n     ,date_dim\\n     ,customer_address\\n where wr_returned_date_sk = d_date_sk \\n   and d_year =2001\\n   and wr_returning_addr_sk = ca_address_sk \\n group by wr_returning_customer_sk\\n         ,ca_state)\\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\\n       ,c_last_review_date_sk,ctr_total_return\\n from customer_total_return ctr1\\n     ,customer_address\\n     ,customer\\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\n \\t\\t\\t  from customer_total_return ctr2 \\n                  \\t  where ctr1.ctr_state = ctr2.ctr_state)\\n       and ca_address_sk = c_current_addr_sk\\n       and ca_state = 'GA'\\n       and ctr1.ctr_customer_sk = c_customer_sk\\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\\n                  ,c_last_review_date_sk,ctr_total_return\\nlimit 100;",
    "benchmarkResult": {
      "total": 20.207
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"167\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"51\\"><Select exact_cardinality=\\"12723\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"13117\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13271\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13580\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"636\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"2446\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13079\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"13117\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13271\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13580\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "31.sql",
    "queryText": "with ss as\\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\\n from store_sales,date_dim,customer_address\\n where ss_sold_date_sk = d_date_sk\\n  and ss_addr_sk=ca_address_sk\\n group by ca_county,d_qoy, d_year),\\n ws as\\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\\n from web_sales,date_dim,customer_address\\n where ws_sold_date_sk = d_date_sk\\n  and ws_bill_addr_sk=ca_address_sk\\n group by ca_county,d_qoy, d_year)\\n select \\n        ss1.ca_county\\n       ,ss1.d_year\\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\\n from\\n        ss ss1\\n       ,ss ss2\\n       ,ss ss3\\n       ,ws ws1\\n       ,ws ws2\\n       ,ws ws3\\n where\\n    ss1.d_qoy = 1\\n    and ss1.d_year = 2000\\n    and ss1.ca_county = ss2.ca_county\\n    and ss2.d_qoy = 2\\n    and ss2.d_year = 2000\\n and ss2.ca_county = ss3.ca_county\\n    and ss3.d_qoy = 3\\n    and ss3.d_year = 2000\\n    and ss1.ca_county = ws1.ca_county\\n    and ws1.d_qoy = 1\\n    and ws1.d_year = 2000\\n    and ws1.ca_county = ws2.ca_county\\n    and ws2.d_qoy = 2\\n    and ws2.d_year = 2000\\n    and ws1.ca_county = ws3.ca_county\\n    and ws3.d_qoy = 3\\n    and ws3.d_year =2000\\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\\n order by store_q2_q3_increase;",
    "benchmarkResult": {
      "total": 26.393
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"51\\"><Sort exact_cardinality=\\"51\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"51\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1686\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"82209\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"84199\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"152\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"385\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"389\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"675\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1261\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"37599\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"37602\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"92\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"935\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"20824\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"20826\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"942\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21648\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21652\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"1809\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143944\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"147381\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"92\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"1657\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"77668\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"79545\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "32.sql",
    "queryText": "select  sum(cs_ext_discount_amt)  as \\"excess discount amount\\" \\nfrom \\n   catalog_sales \\n   ,item \\n   ,date_dim\\nwhere\\ni_manufact_id = 994\\nand i_item_sk = cs_item_sk \\nand d_date between '2001-03-14' and \\n        (cast('2001-03-14' as date) + interval '90 days')\\nand d_date_sk = cs_sold_date_sk \\nand cs_ext_discount_amt  \\n     > ( \\n         select \\n            1.3 * avg(cs_ext_discount_amt) \\n         from \\n            catalog_sales \\n           ,date_dim\\n         where \\n              cs_item_sk = i_item_sk \\n          and d_date between '2001-03-14' and\\n                             (cast('2001-03-14' as date) + interval '90 days')\\n          and d_date_sk = cs_sold_date_sk \\n      ) \\nlimit 100;",
    "benchmarkResult": {
      "total": 6.061000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"2\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"8909\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"41523\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"356\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"3\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "33.sql",
    "queryText": "with ss as (\\n select\\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_manufact_id),\\n cs as (\\n select\\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id               in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_manufact_id),\\n ws as (\\n select\\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id               in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6\\n group by i_manufact_id)\\n  select  i_manufact_id ,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_manufact_id\\n order by total_sales\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.35
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"721\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2043\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"1413\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"719\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"9886\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1740\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11482\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11482\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"26587\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"694\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"5249\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1740\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6049\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6049\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13763\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation><GroupBy method=\\"hash\\" exact_cardinality=\\"630\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2441\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1740\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2820\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2820\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6425\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "34.sql",
    "queryText": "select c_last_name\\n       ,c_first_name\\n       ,c_salutation\\n       ,c_preferred_cust_flag\\n       ,ss_ticket_number\\n       ,cnt from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,count(*) cnt\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\\n    and (household_demographics.hd_buy_potential = '>10000' or\\n         household_demographics.hd_buy_potential = '0-500')\\n    and household_demographics.hd_vehicle_count > 0\\n    and (case when household_demographics.hd_vehicle_count > 0 \\n\\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \\n\\telse null \\n\\tend)  > 1.2\\n    and date_dim.d_year in (2000,2000+1,2000+2)\\n    and store.s_county in ('Ziebach County','Williamson County','Walker County','Ziebach County',\\n                           'Ziebach County','Ziebach County','Ziebach County','Ziebach County')\\n    group by ss_ticket_number,ss_customer_sk) dn,customer\\n    where ss_customer_sk = c_customer_sk\\n      and cnt between 15 and 20\\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;",
    "benchmarkResult": {
      "total": 11.207999999999998
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"353\\"><Sort exact_cardinality=\\"353\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"353\\"><Select exact_cardinality=\\"353\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3976\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"41114\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"8\\" /><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"41613\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"800\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"376414\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"252\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Select><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "35.sql",
    "queryText": "select   \\n  ca_state,\\n  cd_gender,\\n  cd_marital_status,\\n  cd_dep_count,\\n  count(*) cnt1,\\n  sum(cd_dep_count),\\n  min(cd_dep_count),\\n  stddev_samp(cd_dep_count),\\n  cd_dep_employed_count,\\n  count(*) cnt2,\\n  sum(cd_dep_employed_count),\\n  min(cd_dep_employed_count),\\n  stddev_samp(cd_dep_employed_count),\\n  cd_dep_college_count,\\n  count(*) cnt3,\\n  sum(cd_dep_college_count),\\n  min(cd_dep_college_count),\\n  stddev_samp(cd_dep_college_count)\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 1999 and\\n                d_qoy < 4) and\\n   (exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 1999 and\\n                  d_qoy < 4) or \\n    exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 1999 and\\n                  d_qoy < 4))\\n group by ca_state,\\n          cd_gender,\\n          cd_marital_status,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n order by ca_state,\\n          cd_gender,\\n          cd_marital_status,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n limit 100;",
    "benchmarkResult": {
      "total": 42.907000000000004
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"4741\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"4846\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"158959\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"274\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1434322\\" /></Join><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"22601\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"79629\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"274\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719217\\" /></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"22601\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"298656\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"274\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2750652\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96562\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"100000\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "36.sql",
    "queryText": "select  \\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\\n   ,i_category\\n   ,i_class\\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(i_category)+grouping(i_class),\\n \\tcase when grouping(i_class) = 0 then i_category end \\n \\torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\\n from\\n    store_sales\\n   ,date_dim       d1\\n   ,item\\n   ,store\\n where\\n    d1.d_year = 1998 \\n and d1.d_date_sk = ss_sold_date_sk\\n and i_item_sk  = ss_item_sk \\n and s_store_sk  = ss_store_sk\\n and s_state in ('TN','AL','SD','AL',\\n                 'SD','SD','SD','SD')\\n group by rollup(i_category,i_class)\\n order by\\n   lochierarchy desc\\n  ,case when lochierarchy = 0 then i_category end\\n  ,rank_within_parent\\n  limit 100;",
    "benchmarkResult": {
      "total": 81.099
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Window exact_cardinality=\\"136\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"136\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"537716\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"537716\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"8\\" /><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"550596\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "37.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,i_current_price\\n from item, inventory, date_dim, catalog_sales\\n where i_current_price between 58 and 58 + 30\\n and inv_item_sk = i_item_sk\\n and d_date_sk=inv_date_sk\\n and d_date between cast('2002-02-18' as date) and (cast('2002-02-18' as date) +  interval '60 days')\\n and i_manufact_id in (832,757,736,999)\\n and inv_quantity_on_hand between 100 and 500\\n and cs_item_sk = i_item_sk\\n group by i_item_id,i_item_desc,i_current_price\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 28.302
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"61\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"388\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"2\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"4469511\\" /></Join></Join><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"0\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "38.sql",
    "queryText": "select  count(*) from (\\n    select distinct c_last_name, c_first_name, d_date\\n    from store_sales, date_dim, customer\\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n      and store_sales.ss_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n  intersect\\n    select distinct c_last_name, c_first_name, d_date\\n    from catalog_sales, date_dim, customer\\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n  intersect\\n    select distinct c_last_name, c_first_name, d_date\\n    from web_sales, date_dim, customer\\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n) hot_cust\\nlimit 100;",
    "benchmarkResult": {
      "total": 39.269999999999996
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"115\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"115\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11974\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144292\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144309\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"328\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"328\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"31552\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285120\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285803\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"47942\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"543189\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"556310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join></GroupBy></Join></GroupBy></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "39a.sql",
    "queryText": "with inv as\\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\\n      from inventory\\n          ,item\\n          ,warehouse\\n          ,date_dim\\n      where inv_item_sk = i_item_sk\\n        and inv_warehouse_sk = w_warehouse_sk\\n        and inv_date_sk = d_date_sk\\n        and d_year =1998\\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\\n where case mean when 0 then 0 else stdev/mean end > 1)\\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\\nfrom inv inv1,inv inv2\\nwhere inv1.i_item_sk = inv2.i_item_sk\\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\\n  and inv1.d_moy=4\\n  and inv2.d_moy=4+1\\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\\n        ,inv2.d_moy,inv2.mean, inv2.cov\\n;",
    "benchmarkResult": {
      "total": 46.558
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"146\\"><Sort exact_cardinality=\\"146\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"146\\"><Select exact_cardinality=\\"3193\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"45000\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></Join></GroupBy></Select><Select exact_cardinality=\\"2160\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"45000\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></Join></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "39b.sql",
    "queryText": "with inv as\\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\\n      from inventory\\n          ,item\\n          ,warehouse\\n          ,date_dim\\n      where inv_item_sk = i_item_sk\\n        and inv_warehouse_sk = w_warehouse_sk\\n        and inv_date_sk = d_date_sk\\n        and d_year =1998\\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\\n where case mean when 0 then 0 else stdev/mean end > 1)\\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\\nfrom inv inv1,inv inv2\\nwhere inv1.i_item_sk = inv2.i_item_sk\\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\\n  and inv1.d_moy=4\\n  and inv2.d_moy=4+1\\n  and inv1.cov > 1.5\\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\\n        ,inv2.d_moy,inv2.mean, inv2.cov\\n;",
    "benchmarkResult": {
      "total": 40.731
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"7\\"><Sort exact_cardinality=\\"7\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><Select exact_cardinality=\\"3193\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"45000\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"180000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></Join></GroupBy></Select><Select exact_cardinality=\\"56\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"45000\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"225000\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join></Join></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "40.sql",
    "queryText": "select  \\n   w_state\\n  ,i_item_id\\n  ,sum(case when (cast(d_date as date) < cast ('1999-04-25' as date)) \\n \\t\\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\\n  ,sum(case when (cast(d_date as date) >= cast ('1999-04-25' as date)) \\n \\t\\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\\n from\\n   catalog_sales left outer join catalog_returns on\\n       (cs_order_number = cr_order_number \\n        and cs_item_sk = cr_item_sk)\\n  ,warehouse \\n  ,item\\n  ,date_dim\\n where\\n     i_current_price between 0.99 and 1.49\\n and i_item_sk          = cs_item_sk\\n and cs_warehouse_sk    = w_warehouse_sk \\n and cs_sold_date_sk    = d_date_sk\\n and d_date between (cast ('1999-04-25' as date) - interval '30 days')\\n                and (cast ('1999-04-25' as date) + interval '30 days') \\n group by\\n    w_state,i_item_id\\n order by w_state,i_item_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 15.671999999999999
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"523\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1712\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1722\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"61\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"89246\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1104\\" /><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"1441548\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "41.sql",
    "queryText": "select  distinct(i_product_name)\\n from item i1\\n where i_manufact_id between 739 and 739+40 \\n   and (select count(*) as item_cnt\\n        from item\\n        where (i_manufact = i1.i_manufact and\\n        ((i_category = 'Women' and \\n        (i_color = 'mint' or i_color = 'almond') and \\n        (i_units = 'Dozen' or i_units = 'Carton') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ) or\\n        (i_category = 'Women' and\\n        (i_color = 'lime' or i_color = 'dodger') and\\n        (i_units = 'Pallet' or i_units = 'Ounce') and\\n        (i_size = 'economy' or i_size = 'medium')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'salmon' or i_color = 'navy') and\\n        (i_units = 'Bunch' or i_units = 'Oz') and\\n        (i_size = 'N/A' or i_size = 'small')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'antique' or i_color = 'white') and\\n        (i_units = 'Unknown' or i_units = 'Tbl') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ))) or\\n       (i_manufact = i1.i_manufact and\\n        ((i_category = 'Women' and \\n        (i_color = 'dim' or i_color = 'chiffon') and \\n        (i_units = 'Box' or i_units = 'N/A') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ) or\\n        (i_category = 'Women' and\\n        (i_color = 'lemon' or i_color = 'rosy') and\\n        (i_units = 'Tsp' or i_units = 'Dram') and\\n        (i_size = 'economy' or i_size = 'medium')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'deep' or i_color = 'smoke') and\\n        (i_units = 'Gram' or i_units = 'Pound') and\\n        (i_size = 'N/A' or i_size = 'small')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'metallic' or i_color = 'olive') and\\n        (i_units = 'Lb' or i_units = 'Case') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        )))) > 0\\n order by i_product_name\\n limit 100;",
    "benchmarkResult": {
      "total": 3.558
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"single\\" method=\\"delim\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"239\\" /><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"239\\"><Join type=\\"leftouter\\" method=\\"hash\\" exact_cardinality=\\"68\\"><TableScan table_name=\\"&lt;???&gt;\\" exact_cardinality=\\"0\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"2\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"2\\" /></GroupBy></Join><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"239\\" /></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"68\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "42.sql",
    "queryText": "select  dt.d_year\\n \\t,item.i_category_id\\n \\t,item.i_category\\n \\t,sum(ss_ext_sales_price)\\n from \\tdate_dim dt\\n \\t,store_sales\\n \\t,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n \\tand store_sales.ss_item_sk = item.i_item_sk\\n \\tand item.i_manager_id = 1  \\t\\n \\tand dt.d_moy=12\\n \\tand dt.d_year=1999\\n group by \\tdt.d_year\\n \\t\\t,item.i_category_id\\n \\t\\t,item.i_category\\n order by       sum(ss_ext_sales_price) desc,dt.d_year\\n \\t\\t,item.i_category_id\\n \\t\\t,item.i_category\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 3.321
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"10\\"><Sort exact_cardinality=\\"10\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"10\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1636\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"50047\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"321\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "43.sql",
    "queryText": "select  s_store_name, s_store_id,\\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\\n from date_dim, store_sales, store\\n where d_date_sk = ss_sold_date_sk and\\n       s_store_sk = ss_store_sk and\\n       s_gmt_offset = -6 and\\n       d_year = 2000 \\n group by s_store_name, s_store_id\\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\\n limit 100;",
    "benchmarkResult": {
      "total": 1.121
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"0\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "44.sql",
    "queryText": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\\nfrom(select *\\n     from (select item_sk,rank() over (order by rank_col asc) rnk\\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \\n                 from store_sales ss1\\n                 where ss_store_sk = 29\\n                 group by ss_item_sk\\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\\n                                                  from store_sales\\n                                                  where ss_store_sk = 29\\n                                                    and ss_cdemo_sk is null\\n                                                  group by ss_store_sk))V1)V11\\n     where rnk  < 11) asceding,\\n    (select *\\n     from (select item_sk,rank() over (order by rank_col desc) rnk\\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\\n                 from store_sales ss1\\n                 where ss_store_sk = 29\\n                 group by ss_item_sk\\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\\n                                                  from store_sales\\n                                                  where ss_store_sk = 29\\n                                                    and ss_cdemo_sk is null\\n                                                  group by ss_store_sk))V2)V21\\n     where rnk  < 11) descending,\\nitem i1,\\nitem i2\\nwhere asceding.rnk = descending.rnk \\n  and i1.i_item_sk=asceding.item_sk\\n  and i2.i_item_sk=descending.item_sk\\norder by asceding.rnk\\nlimit 100;",
    "benchmarkResult": {
      "total": 1.688
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Select exact_cardinality=\\"0\\"><Window exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /></GroupBy></Join></Window></Select><Select exact_cardinality=\\"0\\"><Window exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /></GroupBy></Sort></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /></GroupBy></Join></Window></Select></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "45.sql",
    "queryText": "select  ca_zip, ca_city, sum(ws_sales_price)\\n from web_sales, customer, customer_address, date_dim, item\\n where ws_bill_customer_sk = c_customer_sk\\n \\tand c_current_addr_sk = ca_address_sk \\n \\tand ws_item_sk = i_item_sk \\n \\tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\\n \\t      or \\n \\t      i_item_id in (select i_item_id\\n                             from item\\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\\n                             )\\n \\t    )\\n \\tand ws_sold_date_sk = d_date_sk\\n \\tand d_qoy = 2 and d_year = 2001\\n group by ca_zip, ca_city\\n order by ca_zip, ca_city\\n limit 100;",
    "benchmarkResult": {
      "total": 13.082
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"19\\"><Sort exact_cardinality=\\"19\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"19\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"19\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"9\\" /><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"21362\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"10\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"10\\" /><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21362\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21362\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21363\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21363\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "46.sql",
    "queryText": "select  c_last_name\\n       ,c_first_name\\n       ,ca_city\\n       ,bought_city\\n       ,ss_ticket_number\\n       ,amt,profit \\n from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,ca_city bought_city\\n          ,sum(ss_coupon_amt) amt\\n          ,sum(ss_net_profit) profit\\n    from store_sales,date_dim,store,household_demographics,customer_address \\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\\n    and (household_demographics.hd_dep_count = 8 or\\n         household_demographics.hd_vehicle_count= 4)\\n    and date_dim.d_dow in (6,0)\\n    and date_dim.d_year in (1999,1999+1,1999+2) \\n    and store.s_city in ('Five Points','Riverside','Fairview','Midway','Pleasant Hill') \\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\\n    where ss_customer_sk = c_customer_sk\\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\\n      and current_addr.ca_city <> bought_city\\n  order by c_last_name\\n          ,c_first_name\\n          ,ca_city\\n          ,bought_city\\n          ,ss_ticket_number\\n  limit 100;",
    "benchmarkResult": {
      "total": 36.259
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"9580\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"10240\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"10588\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"112669\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"113362\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1800\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"464669\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"5\\" /><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"475932\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"314\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "47.sql",
    "queryText": "with v1 as(\\n select i_category, i_brand,\\n        s_store_name, s_company_name,\\n        d_year, d_moy,\\n        sum(ss_sales_price) sum_sales,\\n        avg(sum(ss_sales_price)) over\\n          (partition by i_category, i_brand,\\n                     s_store_name, s_company_name, d_year)\\n          avg_monthly_sales,\\n        rank() over\\n          (partition by i_category, i_brand,\\n                     s_store_name, s_company_name\\n           order by d_year, d_moy) rn\\n from item, store_sales, date_dim, store\\n where ss_item_sk = i_item_sk and\\n       ss_sold_date_sk = d_date_sk and\\n       ss_store_sk = s_store_sk and\\n       (\\n         d_year = 2001 or\\n         ( d_year = 2001-1 and d_moy =12) or\\n         ( d_year = 2001+1 and d_moy =1)\\n       )\\n group by i_category, i_brand,\\n          s_store_name, s_company_name,\\n          d_year, d_moy),\\n v2 as(\\n select v1.s_store_name, v1.s_company_name\\n        ,v1.d_year\\n        ,v1.avg_monthly_sales\\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\\n from v1, v1 v1_lag, v1 v1_lead\\n where v1.i_category = v1_lag.i_category and\\n       v1.i_category = v1_lead.i_category and\\n       v1.i_brand = v1_lag.i_brand and\\n       v1.i_brand = v1_lead.i_brand and\\n       v1.s_store_name = v1_lag.s_store_name and\\n       v1.s_store_name = v1_lead.s_store_name and\\n       v1.s_company_name = v1_lag.s_company_name and\\n       v1.s_company_name = v1_lead.s_company_name and\\n       v1.rn = v1_lag.rn + 1 and\\n       v1.rn = v1_lead.rn - 1)\\n  select  *\\n from v2\\n where  d_year = 2001 and    \\n        avg_monthly_sales > 0 and\\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\n order by sum_sales - avg_monthly_sales, 3\\n limit 100;",
    "benchmarkResult": {
      "total": 250.328
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"35512\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"39143\\"><Window exact_cardinality=\\"50384\\"><Window exact_cardinality=\\"50384\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"50384\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"656497\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Window><Window exact_cardinality=\\"50384\\"><Window exact_cardinality=\\"50384\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"50384\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"656497\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Window></Join><Select exact_cardinality=\\"37016\\"><Window exact_cardinality=\\"50384\\"><Window exact_cardinality=\\"50384\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"50384\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"656497\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"672242\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Window></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "48.sql",
    "queryText": "select sum (ss_quantity)\\n from store_sales, store, customer_demographics, customer_address, date_dim\\n where s_store_sk = ss_store_sk\\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\\n and  \\n (\\n  (\\n   cd_demo_sk = ss_cdemo_sk\\n   and \\n   cd_marital_status = 'W'\\n   and \\n   cd_education_status = 'Unknown'\\n   and \\n   ss_sales_price between 100.00 and 150.00  \\n   )\\n or\\n  (\\n  cd_demo_sk = ss_cdemo_sk\\n   and \\n   cd_marital_status = 'S'\\n   and \\n   cd_education_status = 'Primary'\\n   and \\n   ss_sales_price between 50.00 and 100.00   \\n  )\\n or \\n (\\n  cd_demo_sk = ss_cdemo_sk\\n  and \\n   cd_marital_status = 'D'\\n   and \\n   cd_education_status = '4 yr Degree'\\n   and \\n   ss_sales_price between 150.00 and 200.00  \\n )\\n )\\n and\\n (\\n  (\\n  ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('WA', 'NC', 'SD')\\n  and ss_net_profit between 0 and 2000  \\n  )\\n or\\n  (ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('WI', 'TN', 'MN')\\n  and ss_net_profit between 150 and 3000 \\n  )\\n or\\n  (ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('IL', 'OH', 'NE')\\n  and ss_net_profit between 50 and 25000 \\n  )\\n )\\n;",
    "benchmarkResult": {
      "total": 37.653
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"441\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"24627\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"24774\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"48475\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"544141\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></GroupBy></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "49.sql",
    "queryText": "select  channel, item, return_ratio, return_rank, currency_rank from\\n (select\\n 'web' as channel\\n ,web.item\\n ,web.return_ratio\\n ,web.return_rank\\n ,web.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect ws.ws_item_sk as item\\n \\t\\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\t web_sales ws left outer join web_returns wr \\n \\t\\t\\ton (ws.ws_order_number = wr.wr_order_number and \\n \\t\\t\\tws.ws_item_sk = wr.wr_item_sk)\\n                 ,date_dim\\n \\t\\twhere \\n \\t\\t\\twr.wr_return_amt > 10000 \\n \\t\\t\\tand ws.ws_net_profit > 1\\n                         and ws.ws_net_paid > 0\\n                         and ws.ws_quantity > 0\\n                         and ws_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n \\t\\tgroup by ws.ws_item_sk\\n \\t) in_web\\n ) web\\n where \\n (\\n web.return_rank <= 10\\n or\\n web.currency_rank <= 10\\n )\\n union\\n select \\n 'catalog' as channel\\n ,catalog.item\\n ,catalog.return_ratio\\n ,catalog.return_rank\\n ,catalog.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect \\n \\t\\tcs.cs_item_sk as item\\n \\t\\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\tcatalog_sales cs left outer join catalog_returns cr\\n \\t\\t\\ton (cs.cs_order_number = cr.cr_order_number and \\n \\t\\t\\tcs.cs_item_sk = cr.cr_item_sk)\\n                ,date_dim\\n \\t\\twhere \\n \\t\\t\\tcr.cr_return_amount > 10000 \\n \\t\\t\\tand cs.cs_net_profit > 1\\n                         and cs.cs_net_paid > 0\\n                         and cs.cs_quantity > 0\\n                         and cs_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n                 group by cs.cs_item_sk\\n \\t) in_cat\\n ) catalog\\n where \\n (\\n catalog.return_rank <= 10\\n or\\n catalog.currency_rank <=10\\n )\\n union\\n select \\n 'store' as channel\\n ,store.item\\n ,store.return_ratio\\n ,store.return_rank\\n ,store.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect sts.ss_item_sk as item\\n \\t\\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\tstore_sales sts left outer join store_returns sr\\n \\t\\t\\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\\n                ,date_dim\\n \\t\\twhere \\n \\t\\t\\tsr.sr_return_amt > 10000 \\n \\t\\t\\tand sts.ss_net_profit > 1\\n                         and sts.ss_net_paid > 0 \\n                         and sts.ss_quantity > 0\\n                         and ss_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n \\t\\tgroup by sts.ss_item_sk\\n \\t) in_store\\n ) store\\n where  (\\n store.return_rank <= 10\\n or \\n store.currency_rank <= 10\\n )\\n ) x\\n order by 1,4,5,2\\n limit 100;",
    "benchmarkResult": {
      "total": 16.685
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"33\\"><Sort exact_cardinality=\\"33\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"33\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"33\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"22\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"22\\"><Select exact_cardinality=\\"10\\"><Window exact_cardinality=\\"20\\"><Window exact_cardinality=\\"20\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"20\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"20\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"9299\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"279926\\" /></Join><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"632\\" /></Join></GroupBy></Window></Window></Select><Select exact_cardinality=\\"12\\"><Window exact_cardinality=\\"30\\"><Window exact_cardinality=\\"30\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"30\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"30\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"18002\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"556341\\" /></Join><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"1217\\" /></Join></GroupBy></Window></Window></Select></SetOperation></GroupBy><Select exact_cardinality=\\"11\\"><Window exact_cardinality=\\"16\\"><Window exact_cardinality=\\"16\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"16\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"16\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21879\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"687109\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"507\\" /></Join></GroupBy></Window></Window></Select></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "50.sql",
    "queryText": "select  \\n   s_store_name\\n  ,s_company_id\\n  ,s_street_number\\n  ,s_street_name\\n  ,s_street_type\\n  ,s_suite_number\\n  ,s_city\\n  ,s_county\\n  ,s_state\\n  ,s_zip\\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   store_sales\\n  ,store_returns\\n  ,store\\n  ,date_dim d1\\n  ,date_dim d2\\nwhere\\n    d2.d_year = 1999\\nand d2.d_moy  = 9\\nand ss_ticket_number = sr_ticket_number\\nand ss_item_sk = sr_item_sk\\nand ss_sold_date_sk   = d1.d_date_sk\\nand sr_returned_date_sk   = d2.d_date_sk\\nand ss_customer_sk = sr_customer_sk\\nand ss_store_sk = s_store_sk\\ngroup by\\n   s_store_name\\n  ,s_company_id\\n  ,s_street_number\\n  ,s_street_name\\n  ,s_street_type\\n  ,s_suite_number\\n  ,s_city\\n  ,s_county\\n  ,s_state\\n  ,s_zip\\norder by s_store_name\\n        ,s_company_id\\n        ,s_street_number\\n        ,s_street_name\\n        ,s_street_type\\n        ,s_suite_number\\n        ,s_city\\n        ,s_county\\n        ,s_state\\n        ,s_zip\\nlimit 100;",
    "benchmarkResult": {
      "total": 13.077
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"6\\"><Sort exact_cardinality=\\"6\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2342\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2368\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2432\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3304\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "51.sql",
    "queryText": "WITH web_v1 as (\\nselect\\n  ws_item_sk item_sk, d_date,\\n  sum(sum(ws_sales_price))\\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\\nfrom web_sales\\n    ,date_dim\\nwhere ws_sold_date_sk=d_date_sk\\n  and d_month_seq between 1221 and 1221+11\\n  and ws_item_sk is not NULL\\ngroup by ws_item_sk, d_date),\\nstore_v1 as (\\nselect\\n  ss_item_sk item_sk, d_date,\\n  sum(sum(ss_sales_price))\\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\\nfrom store_sales\\n    ,date_dim\\nwhere ss_sold_date_sk=d_date_sk\\n  and d_month_seq between 1221 and 1221+11\\n  and ss_item_sk is not NULL\\ngroup by ss_item_sk, d_date)\\n select  *\\nfrom (select item_sk\\n     ,d_date\\n     ,web_sales\\n     ,store_sales\\n     ,max(web_sales)\\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\\n     ,max(store_sales)\\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\\n                 ,web.cume_sales web_sales\\n                 ,store.cume_sales store_sales\\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\\n                                                          and web.d_date = store.d_date)\\n          )x )y\\nwhere web_cumulative > store_cumulative\\norder by item_sk\\n        ,d_date\\nlimit 100;",
    "benchmarkResult": {
      "total": 244.327
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Select exact_cardinality=\\"30614\\"><Window exact_cardinality=\\"605497\\"><Join type=\\"fullouter\\" method=\\"hash\\" exact_cardinality=\\"605497\\"><Window exact_cardinality=\\"492886\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"492886\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"547037\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Window><Window exact_cardinality=\\"139166\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"139166\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143385\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></GroupBy></Window></Join></Window></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "52.sql",
    "queryText": "select  dt.d_year\\n \\t,item.i_brand_id brand_id\\n \\t,item.i_brand brand\\n \\t,sum(ss_ext_sales_price) ext_price\\n from date_dim dt\\n     ,store_sales\\n     ,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n    and store_sales.ss_item_sk = item.i_item_sk\\n    and item.i_manager_id = 1\\n    and dt.d_moy=12\\n    and dt.d_year=1998\\n group by dt.d_year\\n \\t,item.i_brand\\n \\t,item.i_brand_id\\n order by dt.d_year\\n \\t,ext_price desc\\n \\t,brand_id\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 4.9319999999999995
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"104\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1606\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"50047\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"321\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "53.sql",
    "queryText": "select  * from \\n(select i_manufact_id,\\nsum(ss_sales_price) sum_sales,\\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\\nfrom item, store_sales, date_dim, store\\nwhere ss_item_sk = i_item_sk and\\nss_sold_date_sk = d_date_sk and\\nss_store_sk = s_store_sk and\\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\\n((i_category in ('Books','Children','Electronics') and\\ni_class in ('personal','portable','reference','self-help') and\\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\\n\\t\\t'exportiunivamalg #9','scholaramalgamalg #9'))\\nor(i_category in ('Women','Music','Men') and\\ni_class in ('accessories','classical','fragrances','pants') and\\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\\n\\t\\t'importoamalg #1')))\\ngroup by i_manufact_id, d_qoy ) tmp1\\nwhere case when avg_quarterly_sales > 0 \\n\\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \\n\\telse null end > 0.1\\norder by avg_quarterly_sales,\\n\\t sum_sales,\\n\\t i_manufact_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 5.954
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"14\\"><Sort exact_cardinality=\\"14\\"><Select exact_cardinality=\\"14\\"><Window exact_cardinality=\\"16\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"16\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"228\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"234\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"120146\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"934\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "54.sql",
    "queryText": "with my_customers as (\\n select distinct c_customer_sk\\n        , c_current_addr_sk\\n from   \\n        ( select cs_sold_date_sk sold_date_sk,\\n                 cs_bill_customer_sk customer_sk,\\n                 cs_item_sk item_sk\\n          from   catalog_sales\\n          union all\\n          select ws_sold_date_sk sold_date_sk,\\n                 ws_bill_customer_sk customer_sk,\\n                 ws_item_sk item_sk\\n          from   web_sales\\n         ) cs_or_ws_sales,\\n         item,\\n         date_dim,\\n         customer\\n where   sold_date_sk = d_date_sk\\n         and item_sk = i_item_sk\\n         and i_category = 'Men'\\n         and i_class = 'shirts'\\n         and c_customer_sk = cs_or_ws_sales.customer_sk\\n         and d_moy = 7\\n         and d_year = 2000\\n )\\n , my_revenue as (\\n select c_customer_sk,\\n        sum(ss_ext_sales_price) as revenue\\n from   my_customers,\\n        store_sales,\\n        customer_address,\\n        store,\\n        date_dim\\n where  c_current_addr_sk = ca_address_sk\\n        and ca_county = s_county\\n        and ca_state = s_state\\n        and ss_sold_date_sk = d_date_sk\\n        and c_customer_sk = ss_customer_sk\\n        and d_month_seq between (select distinct d_month_seq+1\\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\\n                           and  (select distinct d_month_seq+3\\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\\n group by c_customer_sk\\n )\\n , segments as\\n (select cast((revenue/50) as int) as segment\\n  from   my_revenue\\n )\\n  select  segment, count(*) as num_customers, segment*50 as segment_base\\n from segments\\n group by segment\\n order by segment, num_customers\\n limit 100;",
    "benchmarkResult": {
      "total": 78.733
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /></GroupBy></Sort></GroupBy><Join type=\\"inner\\" method=\\"nl\\" exact_cardinality=\\"0\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /></GroupBy></Sort></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14587\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14587\\"><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"525\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"614\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"615\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"58108\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"492\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"2160932\\"><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></SetOperation></Join></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Join></Join></Join></Join></Join></Join></GroupBy></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "55.sql",
    "queryText": "select  i_brand_id brand_id, i_brand brand,\\n \\tsum(ss_ext_sales_price) ext_price\\n from date_dim, store_sales, item\\n where d_date_sk = ss_sold_date_sk\\n \\tand ss_item_sk = i_item_sk\\n \\tand i_manager_id=1\\n \\tand d_moy=11\\n \\tand d_year=2002\\n group by i_brand, i_brand_id\\n order by ext_price desc, i_brand_id\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 4.468
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"127\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1653\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"30\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"50047\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"321\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "56.sql",
    "queryText": "with ss as (\\n select i_item_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where i_item_id in (select\\n     i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_item_id),\\n cs as (\\n select i_item_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_item_id),\\n ws as (\\n select i_item_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6\\n group by i_item_id)\\n  select  i_item_id ,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_item_id\\n order by total_sales,\\n          i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 7.313
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"508\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"847\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"695\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"432\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"823\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"561\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"12642\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"12642\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29757\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"263\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"357\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"561\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6232\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6232\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14205\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation><GroupBy method=\\"hash\\" exact_cardinality=\\"152\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"177\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"561\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3375\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3375\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"21901\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7371\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "57.sql",
    "queryText": "with v1 as(\\n select i_category, i_brand,\\n        cc_name,\\n        d_year, d_moy,\\n        sum(cs_sales_price) sum_sales,\\n        avg(sum(cs_sales_price)) over\\n          (partition by i_category, i_brand,\\n                     cc_name, d_year)\\n          avg_monthly_sales,\\n        rank() over\\n          (partition by i_category, i_brand,\\n                     cc_name\\n           order by d_year, d_moy) rn\\n from item, catalog_sales, date_dim, call_center\\n where cs_item_sk = i_item_sk and\\n       cs_sold_date_sk = d_date_sk and\\n       cc_call_center_sk= cs_call_center_sk and\\n       (\\n         d_year = 1999 or\\n         ( d_year = 1999-1 and d_moy =12) or\\n         ( d_year = 1999+1 and d_moy =1)\\n       )\\n group by i_category, i_brand,\\n          cc_name , d_year, d_moy),\\n v2 as(\\n select v1.i_category, v1.i_brand\\n        ,v1.d_year\\n        ,v1.avg_monthly_sales\\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\\n from v1, v1 v1_lag, v1 v1_lead\\n where v1.i_category = v1_lag.i_category and\\n       v1.i_category = v1_lead.i_category and\\n       v1.i_brand = v1_lag.i_brand and\\n       v1.i_brand = v1_lead.i_brand and\\n       v1. cc_name = v1_lag. cc_name and\\n       v1. cc_name = v1_lead. cc_name and\\n       v1.rn = v1_lag.rn + 1 and\\n       v1.rn = v1_lead.rn - 1)\\n  select  *\\n from v2\\n where  d_year = 1999 and\\n        avg_monthly_sales > 0 and\\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\n order by sum_sales - avg_monthly_sales, 3\\n limit 100;",
    "benchmarkResult": {
      "total": 163.92100000000002
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"24615\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"27021\\"><Window exact_cardinality=\\"32775\\"><Window exact_cardinality=\\"32775\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"32775\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348067\\"><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Window></Window><Window exact_cardinality=\\"32775\\"><Window exact_cardinality=\\"32775\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"32775\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348067\\"><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Window></Window></Join><Select exact_cardinality=\\"25513\\"><Window exact_cardinality=\\"32775\\"><Window exact_cardinality=\\"32775\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"32775\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348067\\"><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"348892\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"427\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Window></Window></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "58.sql",
    "queryText": "with ss_items as\\n (select i_item_id item_id\\n        ,sum(ss_ext_sales_price) ss_item_rev \\n from store_sales\\n     ,item\\n     ,date_dim\\n where ss_item_sk = i_item_sk\\n   and d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq = (select d_week_seq \\n                                      from date_dim\\n                                      where d_date = '1998-06-23'))\\n   and ss_sold_date_sk   = d_date_sk\\n group by i_item_id),\\n cs_items as\\n (select i_item_id item_id\\n        ,sum(cs_ext_sales_price) cs_item_rev\\n  from catalog_sales\\n      ,item\\n      ,date_dim\\n where cs_item_sk = i_item_sk\\n  and  d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq = (select d_week_seq \\n                                      from date_dim\\n                                      where d_date = '1998-06-23'))\\n  and  cs_sold_date_sk = d_date_sk\\n group by i_item_id),\\n ws_items as\\n (select i_item_id item_id\\n        ,sum(ws_ext_sales_price) ws_item_rev\\n  from web_sales\\n      ,item\\n      ,date_dim\\n where ws_item_sk = i_item_sk\\n  and  d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq =(select d_week_seq \\n                                     from date_dim\\n                                     where d_date = '1998-06-23'))\\n  and ws_sold_date_sk   = d_date_sk\\n group by i_item_id)\\n  select  ss_items.item_id\\n       ,ss_item_rev\\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\\n       ,cs_item_rev\\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\\n       ,ws_item_rev\\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\\n from ss_items,cs_items,ws_items\\n where ss_items.item_id=cs_items.item_id\\n   and ss_items.item_id=ws_items.item_id \\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\\n order by ss_items.item_id\\n         ,ss_item_rev\\n limit 100;",
    "benchmarkResult": {
      "total": 15.454
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1604\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1688\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1\\" /></Sort></GroupBy><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"719195\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"719384\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"2631\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"3168\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1\\" /></Sort></GroupBy><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1434368\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1441548\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"4266\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"5819\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7\\"><GroupBy exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"1\\" /></Sort></GroupBy><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750311\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2880404\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "59.sql",
    "queryText": "with wss as \\n (select d_week_seq,\\n        ss_store_sk,\\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\\n from store_sales,date_dim\\n where d_date_sk = ss_sold_date_sk\\n group by d_week_seq,ss_store_sk\\n )\\n  select  s_store_name1,s_store_id1,d_week_seq1\\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\\n from\\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\\n        ,s_store_id s_store_id1,sun_sales sun_sales1\\n        ,mon_sales mon_sales1,tue_sales tue_sales1\\n        ,wed_sales wed_sales1,thu_sales thu_sales1\\n        ,fri_sales fri_sales1,sat_sales sat_sales1\\n  from wss,store,date_dim d\\n  where d.d_week_seq = wss.d_week_seq and\\n        ss_store_sk = s_store_sk and \\n        d_month_seq between 1211 and 1211 + 11) y,\\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\\n        ,s_store_id s_store_id2,sun_sales sun_sales2\\n        ,mon_sales mon_sales2,tue_sales tue_sales2\\n        ,wed_sales wed_sales2,thu_sales thu_sales2\\n        ,fri_sales fri_sales2,sat_sales sat_sales2\\n  from wss,store,date_dim d\\n  where d.d_week_seq = wss.d_week_seq and\\n        ss_store_sk = s_store_sk and \\n        d_month_seq between 1211+ 12 and 1211 + 23) x\\n where s_store_id1=s_store_id2\\n   and d_week_seq1=d_week_seq2-52\\n order by s_store_name1,s_store_id1,d_week_seq1\\nlimit 100;",
    "benchmarkResult": {
      "total": 103.76
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15186\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2190\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1572\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"1834\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750311\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2190\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1572\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><GroupBy method=\\"hash\\" exact_cardinality=\\"1834\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2750311\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "60.sql",
    "queryText": "with ss as (\\n select\\n          i_item_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -5 \\n group by i_item_id),\\n cs as (\\n select\\n          i_item_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -5 \\n group by i_item_id),\\n ws as (\\n select\\n          i_item_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -5\\n group by i_item_id)\\n  select   \\n  i_item_id\\n,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_item_id\\n order by i_item_id\\n      ,total_sales\\n limit 100;",
    "benchmarkResult": {
      "total": 10.799
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1680\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"3584\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"2760\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1561\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"4224\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1835\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22042\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"22042\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"18246\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"61975\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"1199\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2197\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1835\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11553\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11553\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"18246\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"32123\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation><GroupBy method=\\"hash\\" exact_cardinality=\\"824\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1135\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1835\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5833\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5833\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"18246\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15961\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "61.sql",
    "queryText": "select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\\nfrom\\n  (select sum(ss_ext_sales_price) promotions\\n   from  store_sales\\n        ,store\\n        ,promotion\\n        ,date_dim\\n        ,customer\\n        ,customer_address \\n        ,item\\n   where ss_sold_date_sk = d_date_sk\\n   and   ss_store_sk = s_store_sk\\n   and   ss_promo_sk = p_promo_sk\\n   and   ss_customer_sk= c_customer_sk\\n   and   ca_address_sk = c_current_addr_sk\\n   and   ss_item_sk = i_item_sk \\n   and   ca_gmt_offset = -7\\n   and   i_category = 'Books'\\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\\n   and   s_gmt_offset = -7\\n   and   d_year = 2001\\n   and   d_moy  = 12) promotional_sales,\\n  (select sum(ss_ext_sales_price) total\\n   from  store_sales\\n        ,store\\n        ,date_dim\\n        ,customer\\n        ,customer_address\\n        ,item\\n   where ss_sold_date_sk = d_date_sk\\n   and   ss_store_sk = s_store_sk\\n   and   ss_customer_sk= c_customer_sk\\n   and   ca_address_sk = c_current_addr_sk\\n   and   ss_item_sk = i_item_sk\\n   and   ca_gmt_offset = -7\\n   and   i_category = 'Books'\\n   and   s_gmt_offset = -7\\n   and   d_year = 2001\\n   and   d_moy  = 12) all_sales\\norder by promotions, total\\nlimit 100;",
    "benchmarkResult": {
      "total": 2.3640000000000003
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"158\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1733\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"0\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"0\\" /></Join></GroupBy><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><EmptyResult exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1733\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"0\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"0\\" /></Join></GroupBy></CrossProduct></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "62.sql",
    "queryText": "select  \\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,web_name\\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   web_sales\\n  ,warehouse\\n  ,ship_mode\\n  ,web_site\\n  ,date_dim\\nwhere\\n    d_month_seq between 1213 and 1213 + 11\\nand ws_ship_date_sk   = d_date_sk\\nand ws_warehouse_sk   = w_warehouse_sk\\nand ws_ship_mode_sk   = sm_ship_mode_sk\\nand ws_web_site_sk    = web_site_sk\\ngroup by\\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,web_name\\norder by substr(w_warehouse_name,1,20)\\n        ,sm_type\\n       ,web_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 11.259
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"150\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"145964\\"><TableScan table_name=\\"web_site\\" exact_cardinality=\\"30\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"145972\\"><TableScan table_name=\\"ship_mode\\" exact_cardinality=\\"20\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"145980\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"145997\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "63.sql",
    "queryText": "select  * \\nfrom (select i_manager_id\\n             ,sum(ss_sales_price) sum_sales\\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\\n      from item\\n          ,store_sales\\n          ,date_dim\\n          ,store\\n      where ss_item_sk = i_item_sk\\n        and ss_sold_date_sk = d_date_sk\\n        and ss_store_sk = s_store_sk\\n        and d_month_seq in (1217,1217+1,1217+2,1217+3,1217+4,1217+5,1217+6,1217+7,1217+8,1217+9,1217+10,1217+11)\\n        and ((    i_category in ('Books','Children','Electronics')\\n              and i_class in ('personal','portable','reference','self-help')\\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\\n\\t\\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\\n           or(    i_category in ('Women','Music','Men')\\n              and i_class in ('accessories','classical','fragrances','pants')\\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\\n\\t\\t                 'importoamalg #1')))\\ngroup by i_manager_id, d_moy) tmp1\\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\norder by i_manager_id\\n        ,avg_monthly_sales\\n        ,sum_sales\\nlimit 100;",
    "benchmarkResult": {
      "total": 8.472
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Select exact_cardinality=\\"381\\"><Window exact_cardinality=\\"450\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"450\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4733\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4831\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"120146\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"934\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "64.sql",
    "queryText": "with cs_ui as\\n (select cs_item_sk\\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\\n  from catalog_sales\\n      ,catalog_returns\\n  where cs_item_sk = cr_item_sk\\n    and cs_order_number = cr_order_number\\n  group by cs_item_sk\\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\\ncross_sales as\\n (select i_product_name product_name\\n     ,i_item_sk item_sk\\n     ,s_store_name store_name\\n     ,s_zip store_zip\\n     ,ad1.ca_street_number b_street_number\\n     ,ad1.ca_street_name b_street_name\\n     ,ad1.ca_city b_city\\n     ,ad1.ca_zip b_zip\\n     ,ad2.ca_street_number c_street_number\\n     ,ad2.ca_street_name c_street_name\\n     ,ad2.ca_city c_city\\n     ,ad2.ca_zip c_zip\\n     ,d1.d_year as syear\\n     ,d2.d_year as fsyear\\n     ,d3.d_year s2year\\n     ,count(*) cnt\\n     ,sum(ss_wholesale_cost) s1\\n     ,sum(ss_list_price) s2\\n     ,sum(ss_coupon_amt) s3\\n  FROM   store_sales\\n        ,store_returns\\n        ,cs_ui\\n        ,date_dim d1\\n        ,date_dim d2\\n        ,date_dim d3\\n        ,store\\n        ,customer\\n        ,customer_demographics cd1\\n        ,customer_demographics cd2\\n        ,promotion\\n        ,household_demographics hd1\\n        ,household_demographics hd2\\n        ,customer_address ad1\\n        ,customer_address ad2\\n        ,income_band ib1\\n        ,income_band ib2\\n        ,item\\n  WHERE  ss_store_sk = s_store_sk AND\\n         ss_sold_date_sk = d1.d_date_sk AND\\n         ss_customer_sk = c_customer_sk AND\\n         ss_cdemo_sk= cd1.cd_demo_sk AND\\n         ss_hdemo_sk = hd1.hd_demo_sk AND\\n         ss_addr_sk = ad1.ca_address_sk and\\n         ss_item_sk = i_item_sk and\\n         ss_item_sk = sr_item_sk and\\n         ss_ticket_number = sr_ticket_number and\\n         ss_item_sk = cs_ui.cs_item_sk and\\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\\n         c_current_addr_sk = ad2.ca_address_sk and\\n         c_first_sales_date_sk = d2.d_date_sk and\\n         c_first_shipto_date_sk = d3.d_date_sk and\\n         ss_promo_sk = p_promo_sk and\\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\\n         cd1.cd_marital_status <> cd2.cd_marital_status and\\n         i_color in ('blue','dodger','navy','almond','khaki','tan') and\\n         i_current_price between 29 and 29 + 10 and\\n         i_current_price between 29 + 1 and 29 + 15\\ngroup by i_product_name\\n       ,i_item_sk\\n       ,s_store_name\\n       ,s_zip\\n       ,ad1.ca_street_number\\n       ,ad1.ca_street_name\\n       ,ad1.ca_city\\n       ,ad1.ca_zip\\n       ,ad2.ca_street_number\\n       ,ad2.ca_street_name\\n       ,ad2.ca_city\\n       ,ad2.ca_zip\\n       ,d1.d_year\\n       ,d2.d_year\\n       ,d3.d_year\\n)\\nselect cs1.product_name\\n     ,cs1.store_name\\n     ,cs1.store_zip\\n     ,cs1.b_street_number\\n     ,cs1.b_street_name\\n     ,cs1.b_city\\n     ,cs1.b_zip\\n     ,cs1.c_street_number\\n     ,cs1.c_street_name\\n     ,cs1.c_city\\n     ,cs1.c_zip\\n     ,cs1.syear\\n     ,cs1.cnt\\n     ,cs1.s1 as s11\\n     ,cs1.s2 as s21\\n     ,cs1.s3 as s31\\n     ,cs2.s1 as s12\\n     ,cs2.s2 as s22\\n     ,cs2.s3 as s32\\n     ,cs2.syear\\n     ,cs2.cnt\\nfrom cross_sales cs1,cross_sales cs2\\nwhere cs1.item_sk=cs2.item_sk and\\n     cs1.syear = 2001 and\\n     cs2.syear = 2001 + 1 and\\n     cs2.cnt <= cs1.cnt and\\n     cs1.store_name = cs2.store_name and\\n     cs1.store_zip = cs2.store_zip\\norder by cs1.product_name\\n       ,cs1.store_name\\n       ,cs2.cnt\\n       ,cs1.s1\\n       ,cs2.s1;",
    "benchmarkResult": {
      "total": 145.391
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"5\\"><Sort exact_cardinality=\\"5\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"23\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"30\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"300\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"32\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"186\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"6\\" /><TableScan table_name=\\"item\\" exact_cardinality=\\"190\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"549330\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7200\\"><TableScan table_name=\\"income_band\\" exact_cardinality=\\"20\\" /><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"93454\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"93875\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"94792\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96569\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96569\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7200\\"><TableScan table_name=\\"income_band\\" exact_cardinality=\\"20\\" /><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Join><Select exact_cardinality=\\"17169\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"17862\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144067\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy></Select></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"28\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"29\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"44\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"45\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"45\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"45\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"45\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"300\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"48\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"186\\"><Join type=\\"rightmark\\" method=\\"hash\\" exact_cardinality=\\"12\\"><TableScan table_name=\\"&lt;column data&gt;\\" exact_cardinality=\\"6\\" /><TableScan table_name=\\"item\\" exact_cardinality=\\"190\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"546310\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7200\\"><TableScan table_name=\\"income_band\\" exact_cardinality=\\"20\\" /><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"93454\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"93875\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"94792\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96569\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96569\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7200\\"><TableScan table_name=\\"income_band\\" exact_cardinality=\\"20\\" /><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Join><Select exact_cardinality=\\"17169\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"17862\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144067\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy></Select></Join></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "65.sql",
    "queryText": "select \\n\\ts_store_name,\\n\\ti_item_desc,\\n\\tsc.revenue,\\n\\ti_current_price,\\n\\ti_wholesale_cost,\\n\\ti_brand\\n from store, item,\\n     (select ss_store_sk, avg(revenue) as ave\\n \\tfrom\\n \\t    (select  ss_store_sk, ss_item_sk, \\n \\t\\t     sum(ss_sales_price) as revenue\\n \\t\\tfrom store_sales, date_dim\\n \\t\\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1206 and 1206+11\\n \\t\\tgroup by ss_store_sk, ss_item_sk) sa\\n \\tgroup by ss_store_sk) sb,\\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\\n \\tfrom store_sales, date_dim\\n \\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1206 and 1206+11\\n \\tgroup by ss_store_sk, ss_item_sk) sc\\n where sb.ss_store_sk = sc.ss_store_sk and \\n       sc.revenue <= 0.1 * sb.ave and\\n       s_store_sk = sc.ss_store_sk and\\n       i_item_sk = sc.ss_item_sk\\n order by s_store_name, i_item_desc\\nlimit 100;",
    "benchmarkResult": {
      "total": 50.323
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2754\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2754\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2754\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"78413\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"548695\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"7\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"78413\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"548695\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></GroupBy></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "66.sql",
    "queryText": "select   \\n         w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n        ,ship_carriers\\n        ,year\\n \\t,sum(jan_sales) as jan_sales\\n \\t,sum(feb_sales) as feb_sales\\n \\t,sum(mar_sales) as mar_sales\\n \\t,sum(apr_sales) as apr_sales\\n \\t,sum(may_sales) as may_sales\\n \\t,sum(jun_sales) as jun_sales\\n \\t,sum(jul_sales) as jul_sales\\n \\t,sum(aug_sales) as aug_sales\\n \\t,sum(sep_sales) as sep_sales\\n \\t,sum(oct_sales) as oct_sales\\n \\t,sum(nov_sales) as nov_sales\\n \\t,sum(dec_sales) as dec_sales\\n \\t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\\n \\t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\\n \\t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\\n \\t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\\n \\t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\\n \\t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\\n \\t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\\n \\t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\\n \\t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\\n \\t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\\n \\t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\\n \\t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\\n \\t,sum(jan_net) as jan_net\\n \\t,sum(feb_net) as feb_net\\n \\t,sum(mar_net) as mar_net\\n \\t,sum(apr_net) as apr_net\\n \\t,sum(may_net) as may_net\\n \\t,sum(jun_net) as jun_net\\n \\t,sum(jul_net) as jul_net\\n \\t,sum(aug_net) as aug_net\\n \\t,sum(sep_net) as sep_net\\n \\t,sum(oct_net) as oct_net\\n \\t,sum(nov_net) as nov_net\\n \\t,sum(dec_net) as dec_net\\n from (\\n     select \\n \\tw_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,'DHL' || ',' || 'TBS' as ship_carriers\\n       ,d_year as year\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net\\n \\t,sum(case when d_moy = 2\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net\\n     from\\n          web_sales\\n         ,warehouse\\n         ,date_dim\\n         ,time_dim\\n \\t  ,ship_mode\\n     where\\n            ws_warehouse_sk =  w_warehouse_sk\\n        and ws_sold_date_sk = d_date_sk\\n        and ws_sold_time_sk = t_time_sk\\n \\tand ws_ship_mode_sk = sm_ship_mode_sk\\n        and d_year = 2002\\n \\tand t_time between 51277 and 51277+28800 \\n \\tand sm_carrier in ('DHL','TBS')\\n     group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n       ,d_year\\n union all\\n     select \\n \\tw_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,'DHL' || ',' || 'TBS' as ship_carriers\\n       ,d_year as year\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\\n     from\\n          catalog_sales\\n         ,warehouse\\n         ,date_dim\\n         ,time_dim\\n \\t ,ship_mode\\n     where\\n            cs_warehouse_sk =  w_warehouse_sk\\n        and cs_sold_date_sk = d_date_sk\\n        and cs_sold_time_sk = t_time_sk\\n \\tand cs_ship_mode_sk = sm_ship_mode_sk\\n        and d_year = 2002\\n \\tand t_time between 51277 AND 51277+28800 \\n \\tand sm_carrier in ('DHL','TBS')\\n     group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n       ,d_year\\n ) x\\n group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,ship_carriers\\n       ,year\\n order by w_warehouse_name\\n limit 100;",
    "benchmarkResult": {
      "total": 22.681
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"5\\"><Sort exact_cardinality=\\"5\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"5\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"10\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"5\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6397\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6397\\"><TableScan table_name=\\"ship_mode\\" exact_cardinality=\\"2\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"64558\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142498\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"28801\\" /></Join></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"5\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"12884\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"12895\\"><TableScan table_name=\\"ship_mode\\" exact_cardinality=\\"2\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"129135\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"28801\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285286\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "67.sql",
    "queryText": "select  *\\nfrom (select i_category\\n            ,i_class\\n            ,i_brand\\n            ,i_product_name\\n            ,d_year\\n            ,d_qoy\\n            ,d_moy\\n            ,s_store_id\\n            ,sumsales\\n            ,rank() over (partition by i_category order by sumsales desc) rk\\n      from (select i_category\\n                  ,i_class\\n                  ,i_brand\\n                  ,i_product_name\\n                  ,d_year\\n                  ,d_qoy\\n                  ,d_moy\\n                  ,s_store_id\\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\\n            from store_sales\\n                ,date_dim\\n                ,store\\n                ,item\\n       where  ss_sold_date_sk=d_date_sk\\n          and ss_item_sk=i_item_sk\\n          and ss_store_sk = s_store_sk\\n          and d_month_seq between 1178 and 1178+11\\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\\nwhere rk <= 100\\norder by i_category\\n        ,i_class\\n        ,i_brand\\n        ,i_product_name\\n        ,d_year\\n        ,d_qoy\\n        ,d_moy\\n        ,s_store_id\\n        ,sumsales\\n        ,rk\\nlimit 100;",
    "benchmarkResult": {
      "total": 517.298
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Select exact_cardinality=\\"1100\\"><Window exact_cardinality=\\"525991\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"525991\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"544247\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"557307\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"557307\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "68.sql",
    "queryText": "select  c_last_name\\n       ,c_first_name\\n       ,ca_city\\n       ,bought_city\\n       ,ss_ticket_number\\n       ,extended_price\\n       ,extended_tax\\n       ,list_price\\n from (select ss_ticket_number\\n             ,ss_customer_sk\\n             ,ca_city bought_city\\n             ,sum(ss_ext_sales_price) extended_price \\n             ,sum(ss_ext_list_price) list_price\\n             ,sum(ss_ext_tax) extended_tax \\n       from store_sales\\n           ,date_dim\\n           ,store\\n           ,household_demographics\\n           ,customer_address \\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n         and store_sales.ss_store_sk = store.s_store_sk  \\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\\n        and date_dim.d_dom between 1 and 2 \\n        and (household_demographics.hd_dep_count = 6 or\\n             household_demographics.hd_vehicle_count= 2)\\n        and date_dim.d_year in (2000,2000+1,2000+2)\\n        and store.s_city in ('Pleasant Hill','Oak Grove')\\n       group by ss_ticket_number\\n               ,ss_customer_sk\\n               ,ss_addr_sk,ca_city) dn\\n      ,customer\\n      ,customer_address current_addr\\n where ss_customer_sk = c_customer_sk\\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\\n   and current_addr.ca_city <> bought_city\\n order by c_last_name\\n         ,ss_ticket_number\\n limit 100;",
    "benchmarkResult": {
      "total": 2.274
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1800\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"72\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"0\\" /></Join></GroupBy><TableScan table_name=\\"customer\\" exact_cardinality=\\"0\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"0\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "69.sql",
    "queryText": "select  \\n  cd_gender,\\n  cd_marital_status,\\n  cd_education_status,\\n  count(*) cnt1,\\n  cd_purchase_estimate,\\n  count(*) cnt2,\\n  cd_credit_rating,\\n  count(*) cnt3\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  ca_state in ('IN','IL','GA') and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 2001 and\\n                d_moy between 2 and 2+2) and\\n   (not exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 2001 and\\n                  d_moy between 2 and 2+2) and\\n    not exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 2001 and\\n                  d_moy between 2 and 2+2))\\n group by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating\\n order by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating\\n limit 100;",
    "benchmarkResult": {
      "total": 23.664
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"596\\"><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"627\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"39935\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"89\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1434322\\" /></Join><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"666\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"21155\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"89\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719217\\" /></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"680\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"74012\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"89\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2750652\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"10599\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"10996\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"5436\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "70.sql",
    "queryText": "select  \\n    sum(ss_net_profit) as total_sum\\n   ,s_state\\n   ,s_county\\n   ,grouping(s_state)+grouping(s_county) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(s_state)+grouping(s_county),\\n \\tcase when grouping(s_county) = 0 then s_state end \\n \\torder by sum(ss_net_profit) desc) as rank_within_parent\\n from\\n    store_sales\\n   ,date_dim       d1\\n   ,store\\n where\\n    d1.d_month_seq between 1224 and 1224+11\\n and d1.d_date_sk = ss_sold_date_sk\\n and s_store_sk  = ss_store_sk\\n and s_state in\\n             ( select s_state\\n               from  (select s_state as s_state,\\n \\t\\t\\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\\n                      from   store_sales, store, date_dim\\n                      where  d_month_seq between 1224 and 1224+11\\n \\t\\t\\t    and d_date_sk = ss_sold_date_sk\\n \\t\\t\\t    and s_store_sk  = ss_store_sk\\n                      group by s_state\\n                     ) tmp1 \\n               where ranking <= 5\\n             )\\n group by rollup(s_state,s_county)\\n order by\\n   lochierarchy desc\\n  ,case when lochierarchy = 0 then s_state end\\n  ,rank_within_parent\\n limit 100;",
    "benchmarkResult": {
      "total": 20.418
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"3\\"><Sort exact_cardinality=\\"3\\"><Window exact_cardinality=\\"3\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"536455\\"><Select exact_cardinality=\\"1\\"><Window exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"536455\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"549330\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Window></Select><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"536455\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"549330\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "71.sql",
    "queryText": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\\n \\tsum(ext_price) ext_price\\n from item, (select ws_ext_sales_price as ext_price, \\n                        ws_sold_date_sk as sold_date_sk,\\n                        ws_item_sk as sold_item_sk,\\n                        ws_sold_time_sk as time_sk  \\n                 from web_sales,date_dim\\n                 where d_date_sk = ws_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 union all\\n                 select cs_ext_sales_price as ext_price,\\n                        cs_sold_date_sk as sold_date_sk,\\n                        cs_item_sk as sold_item_sk,\\n                        cs_sold_time_sk as time_sk\\n                 from catalog_sales,date_dim\\n                 where d_date_sk = cs_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 union all\\n                 select ss_ext_sales_price as ext_price,\\n                        ss_sold_date_sk as sold_date_sk,\\n                        ss_item_sk as sold_item_sk,\\n                        ss_sold_time_sk as time_sk\\n                 from store_sales,date_dim\\n                 where d_date_sk = ss_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 ) tmp,time_dim\\n where\\n   sold_item_sk = i_item_sk\\n   and i_manager_id=1\\n   and time_sk = t_time_sk\\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\\n group by i_brand, i_brand_id,t_hour,t_minute\\n order by ext_price desc, i_brand_id\\n ;",
    "benchmarkResult": {
      "total": 9.179
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1066\\"><Sort exact_cardinality=\\"1066\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1066\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1090\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2888\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"321\\" /><SetOperation type=\\"unionall\\" exact_cardinality=\\"167903\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"73852\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"25139\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"48713\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"94051\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></SetOperation></Join><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"25200\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "72.sql",
    "queryText": "select  i_item_desc\\n      ,w_warehouse_name\\n      ,d1.d_week_seq\\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\\n      ,count(*) total_cnt\\nfrom catalog_sales\\njoin inventory on (cs_item_sk = inv_item_sk)\\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\\njoin item on (i_item_sk = cs_item_sk)\\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\\nwhere d1.d_week_seq = d2.d_week_seq\\n  and inv_quantity_on_hand < cs_quantity \\n  and d3.d_date > d1.d_date + interval '5 days'\\n  and hd_buy_potential = '>10000'\\n  and d1.d_year = 1998\\n  and cd_marital_status = 'D'\\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\\norder by total_cnt desc, i_item_desc, w_warehouse_name, d1.d_week_seq\\nlimit 100;",
    "benchmarkResult": {
      "total": 733.373
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"2022\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"2032\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><Join type=\\"leftouter\\" method=\\"hash\\" exact_cardinality=\\"2032\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2032\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2032\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"62440\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8920\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8920\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"45842\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1200\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"272290\\"><Join type=\\"inner\\" method=\\"piecewise_merge\\" exact_cardinality=\\"13529820\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"384160\\" /></Join><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><TableScan table_name=\\"inventory\\" exact_cardinality=\\"11745000\\" /></Join></Join><TableScan table_name=\\"promotion\\" exact_cardinality=\\"300\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "73.sql",
    "queryText": "select c_last_name\\n       ,c_first_name\\n       ,c_salutation\\n       ,c_preferred_cust_flag \\n       ,ss_ticket_number\\n       ,cnt from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,count(*) cnt\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and date_dim.d_dom between 1 and 2 \\n    and (household_demographics.hd_buy_potential = '1001-5000' or\\n         household_demographics.hd_buy_potential = '0-500')\\n    and household_demographics.hd_vehicle_count > 0\\n    and case when household_demographics.hd_vehicle_count > 0 then \\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\\n    and date_dim.d_year in (2000,2000+1,2000+2)\\n    and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County')\\n    group by ss_ticket_number,ss_customer_sk) dj,customer\\n    where ss_customer_sk = c_customer_sk\\n      and cnt between 1 and 5\\n    order by cnt desc, c_last_name asc;",
    "benchmarkResult": {
      "total": 11.270000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"4\\"><Sort exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Select exact_cardinality=\\"71\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1075\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11149\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"11285\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"72\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"305108\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Select><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "74.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,d_year as year\\n       ,avg(ss_net_paid) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_year in (1998,1998+1)\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,d_year\\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,d_year as year\\n       ,avg(ws_net_paid) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n   and d_year in (1998,1998+1)\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,d_year\\n         )\\n  select \\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n         and t_s_firstyear.sale_type = 's'\\n         and t_w_firstyear.sale_type = 'w'\\n         and t_s_secyear.sale_type = 's'\\n         and t_w_secyear.sale_type = 'w'\\n         and t_s_firstyear.year = 1998\\n         and t_s_secyear.year = 1998+1\\n         and t_w_firstyear.year = 1998\\n         and t_w_secyear.year = 1998+1\\n         and t_s_firstyear.year_total > 0\\n         and t_w_firstyear.year_total > 0\\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\\n order by 3,1,2\\nlimit 100;",
    "benchmarkResult": {
      "total": 153.517
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"99\\"><Sort exact_cardinality=\\"99\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"99\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"490\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1253\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11256\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142842\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142857\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy><Select exact_cardinality=\\"11309\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11309\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143081\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143100\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"37708\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"531222\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"544141\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Join><Select exact_cardinality=\\"37991\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"37991\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"537636\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"550596\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "75.sql",
    "queryText": "WITH all_sales AS (\\n SELECT d_year\\n       ,i_brand_id\\n       ,i_class_id\\n       ,i_category_id\\n       ,i_manufact_id\\n       ,SUM(sales_cnt) AS sales_cnt\\n       ,SUM(sales_amt) AS sales_amt\\n FROM (SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \\n                                                    AND cs_item_sk=cr_item_sk)\\n       WHERE i_category='Home'\\n       UNION\\n       SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \\n                                                AND ss_item_sk=sr_item_sk)\\n       WHERE i_category='Home'\\n       UNION\\n       SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \\n                                            AND ws_item_sk=wr_item_sk)\\n       WHERE i_category='Home') sales_detail\\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\\n SELECT  prev_yr.d_year AS prev_year\\n                          ,curr_yr.d_year AS year\\n                          ,curr_yr.i_brand_id\\n                          ,curr_yr.i_class_id\\n                          ,curr_yr.i_category_id\\n                          ,curr_yr.i_manufact_id\\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\\n FROM all_sales curr_yr, all_sales prev_yr\\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\\n   AND curr_yr.i_class_id=prev_yr.i_class_id\\n   AND curr_yr.i_category_id=prev_yr.i_category_id\\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\\n   AND curr_yr.d_year=1999\\n   AND prev_yr.d_year=1999-1\\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\\n ORDER BY sales_cnt_diff,sales_amt_diff\\n limit 100;",
    "benchmarkResult": {
      "total": 66.158
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"220\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"882\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"95814\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"95847\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"81923\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"82216\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"28005\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28005\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285688\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"54211\\"><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"54211\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"550596\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></SetOperation></GroupBy><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"13924\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"13924\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143100\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></SetOperation></GroupBy></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"882\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"95374\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"95400\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"81276\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"81565\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"27956\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"27956\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285693\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"53609\\"><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"53609\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"544141\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></SetOperation></GroupBy><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"14124\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"14124\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1807\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142857\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></SetOperation></GroupBy></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "76.sql",
    "queryText": "select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\\n        SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\\n         FROM store_sales, item, date_dim\\n         WHERE ss_customer_sk IS NULL\\n           AND ss_sold_date_sk=d_date_sk\\n           AND ss_item_sk=i_item_sk\\n        UNION ALL\\n        SELECT 'web' as channel, 'ws_warehouse_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\\n         FROM web_sales, item, date_dim\\n         WHERE ws_warehouse_sk IS NULL\\n           AND ws_sold_date_sk=d_date_sk\\n           AND ws_item_sk=i_item_sk\\n        UNION ALL\\n        SELECT 'catalog' as channel, 'cs_bill_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\\n         FROM catalog_sales, item, date_dim\\n         WHERE cs_bill_hdemo_sk IS NULL\\n           AND cs_sold_date_sk=d_date_sk\\n           AND cs_item_sk=i_item_sk) foo\\nGROUP BY channel, col_name, d_year, d_qoy, i_category\\nORDER BY channel, col_name, d_year, d_qoy, i_category\\nlimit 100;",
    "benchmarkResult": {
      "total": 10.120000000000001
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"511\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"68529\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"64946\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"64858\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"129752\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"129752\\" /></Join></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"88\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"179\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"179\\" /></Join></Join></SetOperation><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3583\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"7060\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"7060\\" /></Join></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "77.sql",
    "queryText": "with ss as\\n (select s_store_sk,\\n         sum(ss_ext_sales_price) as sales,\\n         sum(ss_net_profit) as profit\\n from store_sales,\\n      date_dim,\\n      store\\n where ss_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date) \\n                  and (cast('2001-08-29' as date) +  interval '30 days') \\n       and ss_store_sk = s_store_sk\\n group by s_store_sk)\\n ,\\n sr as\\n (select s_store_sk,\\n         sum(sr_return_amt) as returns,\\n         sum(sr_net_loss) as profit_loss\\n from store_returns,\\n      date_dim,\\n      store\\n where sr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and sr_store_sk = s_store_sk\\n group by s_store_sk), \\n cs as\\n (select cs_call_center_sk,\\n        sum(cs_ext_sales_price) as sales,\\n        sum(cs_net_profit) as profit\\n from catalog_sales,\\n      date_dim\\n where cs_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n group by cs_call_center_sk \\n ), \\n cr as\\n (select cr_call_center_sk,\\n         sum(cr_return_amount) as returns,\\n         sum(cr_net_loss) as profit_loss\\n from catalog_returns,\\n      date_dim\\n where cr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n group by cr_call_center_sk\\n ), \\n ws as\\n ( select wp_web_page_sk,\\n        sum(ws_ext_sales_price) as sales,\\n        sum(ws_net_profit) as profit\\n from web_sales,\\n      date_dim,\\n      web_page\\n where ws_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and ws_web_page_sk = wp_web_page_sk\\n group by wp_web_page_sk), \\n wr as\\n (select wp_web_page_sk,\\n        sum(wr_return_amt) as returns,\\n        sum(wr_net_loss) as profit_loss\\n from web_returns,\\n      date_dim,\\n      web_page\\n where wr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and wr_web_page_sk = wp_web_page_sk\\n group by wp_web_page_sk)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , ss.s_store_sk as id\\n        , sales\\n        , coalesce(returns, 0) as returns\\n        , (profit - coalesce(profit_loss,0)) as profit\\n from   ss left join sr\\n        on  ss.s_store_sk = sr.s_store_sk\\n union all\\n select 'catalog channel' as channel\\n        , cs_call_center_sk as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from  cs\\n       , cr\\n union all\\n select 'web channel' as channel\\n        , ws.wp_web_page_sk as id\\n        , sales\\n        , coalesce(returns, 0) as returns\\n        , (profit - coalesce(profit_loss,0)) as profit\\n from   ws left join wr\\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 6.306
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"44\\"><Sort exact_cardinality=\\"44\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"44\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"56\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"26\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"6\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3445\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3510\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"59074\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"60491\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join><CrossProduct exact_cardinality=\\"20\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"32165\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"5\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1482\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></Join></GroupBy></CrossProduct></SetOperation><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"30\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"40\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1008\\"><TableScan table_name=\\"web_page\\" exact_cardinality=\\"60\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1027\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"30\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17064\\"><TableScan table_name=\\"web_page\\" exact_cardinality=\\"60\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17066\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "78.sql",
    "queryText": "with ws as\\n  (select d_year AS ws_sold_year, ws_item_sk,\\n    ws_bill_customer_sk ws_customer_sk,\\n    sum(ws_quantity) ws_qty,\\n    sum(ws_wholesale_cost) ws_wc,\\n    sum(ws_sales_price) ws_sp\\n   from web_sales\\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\\n   join date_dim on ws_sold_date_sk = d_date_sk\\n   where wr_order_number is null\\n   group by d_year, ws_item_sk, ws_bill_customer_sk\\n   ),\\ncs as\\n  (select d_year AS cs_sold_year, cs_item_sk,\\n    cs_bill_customer_sk cs_customer_sk,\\n    sum(cs_quantity) cs_qty,\\n    sum(cs_wholesale_cost) cs_wc,\\n    sum(cs_sales_price) cs_sp\\n   from catalog_sales\\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\\n   join date_dim on cs_sold_date_sk = d_date_sk\\n   where cr_order_number is null\\n   group by d_year, cs_item_sk, cs_bill_customer_sk\\n   ),\\nss as\\n  (select d_year AS ss_sold_year, ss_item_sk,\\n    ss_customer_sk,\\n    sum(ss_quantity) ss_qty,\\n    sum(ss_wholesale_cost) ss_wc,\\n    sum(ss_sales_price) ss_sp\\n   from store_sales\\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\\n   join date_dim on ss_sold_date_sk = d_date_sk\\n   where sr_ticket_number is null\\n   group by d_year, ss_item_sk, ss_customer_sk\\n   )\\n select \\nss_customer_sk,\\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2)::integer ratio,\\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\\nfrom ss\\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\\norder by \\n  ss_customer_sk,\\n  ss_qty desc, ss_wc desc, ss_sp desc,\\n  other_chan_qty,\\n  other_chan_wholesale_cost,\\n  other_chan_sales_price,\\n  ratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 332.022
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"196\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"256795\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"256845\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"1297481\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /></Join></GroupBy><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"489260\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"128249\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"128249\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"647621\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"489260\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"494626\\"><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"2592890\\"><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "79.sql",
    "queryText": "select \\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\\n  from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,store.s_city\\n          ,sum(ss_coupon_amt) amt\\n          ,sum(ss_net_profit) profit\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and (household_demographics.hd_dep_count = 9 or household_demographics.hd_vehicle_count > 3)\\n    and date_dim.d_dow = 1\\n    and date_dim.d_year in (1999,1999+1,1999+2) \\n    and store.s_number_employees between 200 and 295\\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\\n    where ss_customer_sk = c_customer_sk\\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\\nlimit 100;",
    "benchmarkResult": {
      "total": 15.657
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4423\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"4710\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"47180\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1800\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"190648\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"11\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"235448\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"157\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "80.sql",
    "queryText": "with ssr as\\n (select  s_store_id as store_id,\\n          sum(ss_ext_sales_price) as sales,\\n          sum(coalesce(sr_return_amt, 0)) as returns,\\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\\n  from store_sales left outer join store_returns on\\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\\n     date_dim,\\n     store,\\n     item,\\n     promotion\\n where ss_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date) \\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n       and ss_store_sk = s_store_sk\\n       and ss_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and ss_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\n group by s_store_id)\\n ,\\n csr as\\n (select  cp_catalog_page_id as catalog_page_id,\\n          sum(cs_ext_sales_price) as sales,\\n          sum(coalesce(cr_return_amount, 0)) as returns,\\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\\n  from catalog_sales left outer join catalog_returns on\\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\\n     date_dim,\\n     catalog_page,\\n     item,\\n     promotion\\n where cs_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date)\\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n        and cs_catalog_page_sk = cp_catalog_page_sk\\n       and cs_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and cs_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\ngroup by cp_catalog_page_id)\\n ,\\n wsr as\\n (select  web_site_id,\\n          sum(ws_ext_sales_price) as sales,\\n          sum(coalesce(wr_return_amt, 0)) as returns,\\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\\n  from web_sales left outer join web_returns on\\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\\n     date_dim,\\n     web_site,\\n     item,\\n     promotion\\n where ws_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date)\\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n        and ws_web_site_sk = web_site_sk\\n       and ws_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and ws_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\ngroup by web_site_id)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , 'store' || store_id as id\\n        , sales\\n        , returns\\n        , profit\\n from   ssr\\n union all\\n select 'catalog channel' as channel\\n        , 'catalog_page' || catalog_page_id as id\\n        , sales\\n        , returns\\n        , profit\\n from  csr\\n union all\\n select 'web channel' as channel\\n        , 'web_site' || web_site_id as id\\n        , sales\\n        , returns\\n        , profit\\n from   wsr\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 61.559999999999995
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"432\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"428\\"><SetOperation type=\\"unionall\\" exact_cardinality=\\"413\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"6\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3406\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3450\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"153351\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"294\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"163811\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1055\\" /><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"2880404\\"><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"407\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1781\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1783\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"80054\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"294\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"82069\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1055\\" /><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"1441548\\"><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></Join><TableScan table_name=\\"catalog_page\\" exact_cardinality=\\"11718\\" /></Join></GroupBy></SetOperation><GroupBy method=\\"hash\\" exact_cardinality=\\"15\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"883\\"><TableScan table_name=\\"web_site\\" exact_cardinality=\\"30\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"883\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"39998\\"><TableScan table_name=\\"promotion\\" exact_cardinality=\\"294\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"40835\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1055\\" /><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"719384\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "81.sql",
    "queryText": "with customer_total_return as\\n (select cr_returning_customer_sk as ctr_customer_sk\\n        ,ca_state as ctr_state, \\n \\tsum(cr_return_amt_inc_tax) as ctr_total_return\\n from catalog_returns\\n     ,date_dim\\n     ,customer_address\\n where cr_returned_date_sk = d_date_sk \\n   and d_year =1999\\n   and cr_returning_addr_sk = ca_address_sk \\n group by cr_returning_customer_sk\\n         ,ca_state )\\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\\n                  ,ca_location_type,ctr_total_return\\n from customer_total_return ctr1\\n     ,customer_address\\n     ,customer\\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\n \\t\\t\\t  from customer_total_return ctr2 \\n                  \\t  where ctr1.ctr_state = ctr2.ctr_state)\\n       and ca_address_sk = c_current_addr_sk\\n       and ca_state = 'CO'\\n       and ctr1.ctr_customer_sk = c_customer_sk\\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\\n                  ,ca_location_type,ctr_total_return\\n limit 100;",
    "benchmarkResult": {
      "total": 24.577
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"154\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"51\\"><Select exact_cardinality=\\"27049\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"27893\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28314\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28891\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"590\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1985\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"980\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"27893\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28314\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"28891\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "82.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,i_current_price\\n from item, inventory, date_dim, store_sales\\n where i_current_price between 34 and 34+30\\n and inv_item_sk = i_item_sk\\n and d_date_sk=inv_date_sk\\n and d_date between cast('2002-04-30' as date) and (cast('2002-04-30' as date) +  interval '60 days')\\n and i_manufact_id in (840,109,510,582)\\n and inv_quantity_on_hand between 100 and 500\\n and ss_item_sk = i_item_sk\\n group by i_item_id,i_item_desc,i_current_price\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 21.425
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1020\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"61\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"98\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"1\\" /><TableScan table_name=\\"inventory\\" exact_cardinality=\\"4469511\\" /></Join></Join><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "83.sql",
    "queryText": "with sr_items as\\n (select i_item_id item_id,\\n        sum(sr_return_quantity) sr_item_qty\\n from store_returns,\\n      item,\\n      date_dim\\n where sr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t  where d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   sr_returned_date_sk   = d_date_sk\\n group by i_item_id),\\n cr_items as\\n (select i_item_id item_id,\\n        sum(cr_return_quantity) cr_item_qty\\n from catalog_returns,\\n      item,\\n      date_dim\\n where cr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t  where d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   cr_returned_date_sk   = d_date_sk\\n group by i_item_id),\\n wr_items as\\n (select i_item_id item_id,\\n        sum(wr_return_quantity) wr_item_qty\\n from web_returns,\\n      item,\\n      date_dim\\n where wr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t\\twhere d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   wr_returned_date_sk   = d_date_sk\\n group by i_item_id)\\n  select  sr_items.item_id\\n       ,sr_item_qty\\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\\n       ,cr_item_qty\\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\\n       ,wr_item_qty\\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\\n from sr_items\\n     ,cr_items\\n     ,wr_items\\n where sr_items.item_id=cr_items.item_id\\n   and sr_items.item_id=wr_items.item_id \\n order by sr_items.item_id\\n         ,sr_item_qty\\n limit 100;",
    "benchmarkResult": {
      "total": 21.776
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"25\\"><Sort exact_cardinality=\\"25\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"25\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"97\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"702\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"726\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"21\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"3\\" /><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"68636\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"71763\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"1298\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"1391\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"21\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"3\\" /><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144067\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"144067\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join></Join></GroupBy></Join><GroupBy method=\\"hash\\" exact_cardinality=\\"2514\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"2916\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"21\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"3\\" /><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"277502\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"73049\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"287514\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join></Join></Join></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "84.sql",
    "queryText": "select  c_customer_id as customer_id\\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\\n from customer\\n     ,customer_address\\n     ,customer_demographics\\n     ,household_demographics\\n     ,income_band\\n     ,store_returns\\n where ca_city\\t        =  'Hamilton'\\n   and c_current_addr_sk = ca_address_sk\\n   and ib_lower_bound   >=  51361\\n   and ib_upper_bound   <=  51361 + 50000\\n   and ib_income_band_sk = hd_income_band_sk\\n   and cd_demo_sk = c_current_cdemo_sk\\n   and hd_demo_sk = c_current_hdemo_sk\\n   and sr_cdemo_sk = cd_demo_sk\\n order by c_customer_id\\n limit 100;",
    "benchmarkResult": {
      "total": 10.08
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"17\\"><Sort exact_cardinality=\\"17\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17\\"><TableScan table_name=\\"income_band\\" exact_cardinality=\\"4\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"100\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"102\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"822\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"402\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /></Join><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"7200\\" /></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "85.sql",
    "queryText": "select  substr(r_reason_desc,1,20)\\n       ,avg(ws_quantity)\\n       ,avg(wr_refunded_cash)\\n       ,avg(wr_fee)\\n from web_sales, web_returns, web_page, customer_demographics cd1,\\n      customer_demographics cd2, customer_address, date_dim, reason \\n where ws_web_page_sk = wp_web_page_sk\\n   and ws_item_sk = wr_item_sk\\n   and ws_order_number = wr_order_number\\n   and ws_sold_date_sk = d_date_sk and d_year = 1999\\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\\n   and ca_address_sk = wr_refunded_addr_sk\\n   and r_reason_sk = wr_reason_sk\\n   and\\n   (\\n    (\\n     cd1.cd_marital_status = 'U'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = 'Advanced Degree'\\n     and \\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 100.00 and 150.00\\n    )\\n   or\\n    (\\n     cd1.cd_marital_status = 'D'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = 'Secondary' \\n     and\\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 50.00 and 100.00\\n    )\\n   or\\n    (\\n     cd1.cd_marital_status = 'M'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = '2 yr Degree'\\n     and\\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 150.00 and 200.00\\n    )\\n   )\\n   and\\n   (\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('KY', 'OK', 'MO')\\n     and ws_net_profit between 100 and 200  \\n    )\\n    or\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('IN', 'AK', 'MN')\\n     and ws_net_profit between 150 and 300  \\n    )\\n    or\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('WI', 'KS', 'GA')\\n     and ws_net_profit between 50 and 250  \\n    )\\n   )\\ngroup by r_reason_desc\\norder by substr(r_reason_desc,1,20)\\n        ,avg(ws_quantity)\\n        ,avg(wr_refunded_cash)\\n        ,avg(wr_fee)\\nlimit 100;",
    "benchmarkResult": {
      "total": 56.474999999999994
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"3\\"><Sort exact_cardinality=\\"3\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"155\\"><TableScan table_name=\\"web_page\\" exact_cardinality=\\"60\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"155\\"><TableScan table_name=\\"reason\\" exact_cardinality=\\"35\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"157\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142857\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"66539\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"48475\\" /><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /></Join></Join></Join></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"1920800\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "86.sql",
    "queryText": "select   \\n    sum(ws_net_paid) as total_sum\\n   ,i_category\\n   ,i_class\\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(i_category)+grouping(i_class),\\n \\tcase when grouping(i_class) = 0 then i_category end \\n \\torder by sum(ws_net_paid) desc) as rank_within_parent\\n from\\n    web_sales\\n   ,date_dim       d1\\n   ,item\\n where\\n    d1.d_month_seq between 1191 and 1191+11\\n and d1.d_date_sk = ws_sold_date_sk\\n and i_item_sk  = ws_item_sk\\n group by rollup(i_category,i_class)\\n order by\\n   lochierarchy desc,\\n   case when lochierarchy = 0 then i_category end,\\n   rank_within_parent\\n limit 100;",
    "benchmarkResult": {
      "total": 9.854999999999999
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Window exact_cardinality=\\"139\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"139\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143325\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"18000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"143325\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "87.sql",
    "queryText": "select count(*) \\nfrom ((select distinct c_last_name, c_first_name, d_date\\n       from store_sales, date_dim, customer\\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n         and store_sales.ss_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n       except\\n      (select distinct c_last_name, c_first_name, d_date\\n       from catalog_sales, date_dim, customer\\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n       except\\n      (select distinct c_last_name, c_first_name, d_date\\n       from web_sales, date_dim, customer\\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n) cool_cust\\n;",
    "benchmarkResult": {
      "total": 60.720000000000006
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"47311\\"><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"47311\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"11857\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142783\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"142801\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"47372\\"><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"47372\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"31748\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"287115\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"287824\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"47695\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"541478\\"><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"554596\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"366\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join></GroupBy></Join></GroupBy></GroupBy></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "88.sql",
    "queryText": "select  *\\nfrom\\n (select count(*) h8_30_to_9\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk   \\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 8\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \\n     and store.s_store_name = 'ese') s1,\\n (select count(*) h9_to_9_30 \\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk \\n     and time_dim.t_hour = 9 \\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s2,\\n (select count(*) h9_30_to_10 \\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 9\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s3,\\n (select count(*) h10_to_10_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 10 \\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s4,\\n (select count(*) h10_30_to_11\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 10 \\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s5,\\n (select count(*) h11_to_11_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk \\n     and time_dim.t_hour = 11\\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s6,\\n (select count(*) h11_30_to_12\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 11\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s7,\\n (select count(*) h12_to_12_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 12\\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s8\\n;",
    "benchmarkResult": {
      "total": 20.631
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1376\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"9009\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"53895\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2634\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"18079\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"112046\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></CrossProduct><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2502\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17837\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"109475\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4144\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"27516\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"166212\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></CrossProduct></CrossProduct><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3886\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"27218\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"165289\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2287\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15097\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"94867\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2702\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"15413\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"96639\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"2515\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1080\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"17936\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"108250\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></CrossProduct></CrossProduct></CrossProduct></CrossProduct></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "89.sql",
    "queryText": "select  *\\nfrom(\\nselect i_category, i_class, i_brand,\\n       s_store_name, s_company_name,\\n       d_moy,\\n       sum(ss_sales_price) sum_sales,\\n       avg(sum(ss_sales_price)) over\\n         (partition by i_category, i_brand, s_store_name, s_company_name)\\n         avg_monthly_sales\\nfrom item, store_sales, date_dim, store\\nwhere ss_item_sk = i_item_sk and\\n      ss_sold_date_sk = d_date_sk and\\n      ss_store_sk = s_store_sk and\\n      d_year in (2002) and\\n        ((i_category in ('Children','Home','Shoes') and\\n          i_class in ('school-uniforms','decor','athletic')\\n         )\\n      or (i_category in ('Men','Music','Jewelry') and\\n          i_class in ('shirts','rock','jewelry boxes') \\n        ))\\ngroup by i_category, i_class, i_brand,\\n         s_store_name, s_company_name, d_moy) tmp1\\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\\norder by sum_sales - avg_monthly_sales, s_store_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 20.884
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"100\\"><Sort exact_cardinality=\\"100\\"><Select exact_cardinality=\\"1709\\"><Window exact_cardinality=\\"1840\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"1840\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"61563\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"12\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"63014\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"325329\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"2041\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "90.sql",
    "queryText": "select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\\n from ( select count(*) amc\\n       from web_sales, household_demographics , time_dim, web_page\\n       where ws_sold_time_sk = time_dim.t_time_sk\\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\\n         and ws_web_page_sk = web_page.wp_web_page_sk\\n         and time_dim.t_hour between 10 and 10+1\\n         and household_demographics.hd_dep_count = 7\\n         and web_page.wp_char_count between 5000 and 5200) at,\\n      ( select count(*) pmc\\n       from web_sales, household_demographics , time_dim, web_page\\n       where ws_sold_time_sk = time_dim.t_time_sk\\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\\n         and ws_web_page_sk = web_page.wp_web_page_sk\\n         and time_dim.t_hour between 20 and 20+1\\n         and household_demographics.hd_dep_count = 7\\n         and web_page.wp_char_count between 5000 and 5200) pt\\n order by am_pm_ratio\\n limit 100;",
    "benchmarkResult": {
      "total": 2.363
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><CrossProduct exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"131\\"><TableScan table_name=\\"web_page\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6549\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"7200\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"73216\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"720\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></GroupBy><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"205\\"><TableScan table_name=\\"web_page\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"9020\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"7200\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"73216\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"720\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join></Join></GroupBy></CrossProduct></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "91.sql",
    "queryText": "select  \\n        cc_call_center_id Call_Center,\\n        cc_name Call_Center_Name,\\n        cc_manager Manager,\\n        sum(cr_net_loss) Returns_Loss\\nfrom\\n        call_center,\\n        catalog_returns,\\n        date_dim,\\n        customer,\\n        customer_address,\\n        customer_demographics,\\n        household_demographics\\nwhere\\n        cr_call_center_sk       = cc_call_center_sk\\nand     cr_returned_date_sk     = d_date_sk\\nand     cr_returning_customer_sk= c_customer_sk\\nand     cd_demo_sk              = c_current_cdemo_sk\\nand     hd_demo_sk              = c_current_hdemo_sk\\nand     ca_address_sk           = c_current_addr_sk\\nand     d_year                  = 2000 \\nand     d_moy                   = 12\\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\\nand     hd_buy_potential like '501-1000%'\\nand     ca_gmt_offset           = -7\\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\\norder by sum(cr_net_loss) desc;",
    "benchmarkResult": {
      "total": 13.899
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"2\\"><Sort exact_cardinality=\\"2\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"2\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"4\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"134\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"102\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"1810\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"16053\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"1200\\" /><TableScan table_name=\\"customer\\" exact_cardinality=\\"100000\\" /></Join><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"5449\\" /></Join><TableScan table_name=\\"customer_demographics\\" exact_cardinality=\\"109760\\" /></Join><TableScan table_name=\\"catalog_returns\\" exact_cardinality=\\"144067\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /></Join><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "92.sql",
    "queryText": "select  \\n   sum(ws_ext_discount_amt)  as \\"Excess Discount Amount\\" \\nfrom \\n    web_sales \\n   ,item \\n   ,date_dim\\nwhere\\ni_manufact_id = 790\\nand i_item_sk = ws_item_sk \\nand d_date between '2002-03-17' and \\n        (cast('2002-03-17' as date) + interval '90 days')\\nand d_date_sk = ws_sold_date_sk \\nand ws_ext_discount_amt  \\n     > ( \\n         SELECT \\n            1.3 * avg(ws_ext_discount_amt) \\n         FROM \\n            web_sales \\n           ,date_dim\\n         WHERE \\n              ws_item_sk = i_item_sk \\n          and d_date between '2002-03-17' and\\n                             (cast('2002-03-17' as date) + interval '90 days')\\n          and d_date_sk = ws_sold_date_sk \\n      ) \\norder by sum(ws_ext_discount_amt)\\nlimit 100;",
    "benchmarkResult": {
      "total": 3.848
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"single\\" method=\\"hash\\" exact_cardinality=\\"1\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"8105\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"20040\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></GroupBy><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"3\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"50\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"2\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"91\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "93.sql",
    "queryText": "select  ss_customer_sk\\n            ,sum(act_sales) sumsales\\n      from (select ss_item_sk\\n                  ,ss_ticket_number\\n                  ,ss_customer_sk\\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\\n                                                            else (ss_quantity*ss_sales_price) end act_sales\\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\\n                                                               and sr_ticket_number = ss_ticket_number)\\n                ,reason\\n            where sr_reason_sk = r_reason_sk\\n              and r_reason_desc = 'reason 47') t\\n      group by ss_customer_sk\\n      order by sumsales, ss_customer_sk\\nlimit 100;",
    "benchmarkResult": {
      "total": 14.463999999999999
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"0\\"><Sort exact_cardinality=\\"0\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"reason\\" exact_cardinality=\\"0\\" /><Join type=\\"rightouter\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"store_returns\\" exact_cardinality=\\"287514\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"0\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "94.sql",
    "queryText": "select  \\n   count(distinct ws_order_number) as \\"order count\\"\\n  ,sum(ws_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(ws_net_profit) as \\"total net profit\\"\\nfrom\\n   web_sales ws1\\n  ,date_dim\\n  ,customer_address\\n  ,web_site\\nwhere\\n    d_date between '2002-2-01' and \\n           (cast('2002-2-01' as date) + interval '60 days')\\nand ws1.ws_ship_date_sk = d_date_sk\\nand ws1.ws_ship_addr_sk = ca_address_sk\\nand ca_state = 'IA'\\nand ws1.ws_web_site_sk = web_site_sk\\nand web_company_name = 'pri'\\nand exists (select *\\n            from web_sales ws2\\n            where ws1.ws_order_number = ws2.ws_order_number\\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\\nand not exists(select *\\n               from web_returns wr1\\n               where ws1.ws_order_number = wr1.wr_order_number)\\norder by count(distinct ws_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 20.421000000000003
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"rightanti\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719205\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"web_site\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"1555\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "95.sql",
    "queryText": "with ws_wh as\\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\\n from web_sales ws1,web_sales ws2\\n where ws1.ws_order_number = ws2.ws_order_number\\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\\n select  \\n   count(distinct ws_order_number) as \\"order count\\"\\n  ,sum(ws_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(ws_net_profit) as \\"total net profit\\"\\nfrom\\n   web_sales ws1\\n  ,date_dim\\n  ,customer_address\\n  ,web_site\\nwhere\\n    d_date between '1999-2-01' and \\n           (cast('1999-2-01' as date) + interval '60 days')\\nand ws1.ws_ship_date_sk = d_date_sk\\nand ws1.ws_ship_addr_sk = ca_address_sk\\nand ca_state = 'OR'\\nand ws1.ws_web_site_sk = web_site_sk\\nand web_company_name = 'pri'\\nand ws1.ws_order_number in (select ws_order_number\\n                            from ws_wh)\\nand ws1.ws_order_number in (select wr_order_number\\n                            from web_returns,ws_wh\\n                            where wr_order_number = ws_wh.ws_order_number)\\norder by count(distinct ws_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 238.089
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8677946\\"><TableScan table_name=\\"web_returns\\" exact_cardinality=\\"71763\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6644004\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join></Join><Join type=\\"rightsemi\\" method=\\"hash\\" exact_cardinality=\\"0\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"6644004\\"><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"719384\\" /></Join><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"web_site\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"0\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"0\\"><TableScan table_name=\\"customer_address\\" exact_cardinality=\\"572\\" /><TableScan table_name=\\"web_sales\\" exact_cardinality=\\"0\\" /></Join></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "96.sql",
    "queryText": "select  count(*) \\nfrom store_sales\\n    ,household_demographics \\n    ,time_dim, store\\nwhere ss_sold_time_sk = time_dim.t_time_sk   \\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \\n    and ss_store_sk = s_store_sk\\n    and time_dim.t_hour = 16\\n    and time_dim.t_minute >= 30\\n    and household_demographics.hd_dep_count = 0\\n    and store.s_store_name = 'ese'\\norder by count(*)\\nlimit 100;",
    "benchmarkResult": {
      "total": 3.665
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"951\\"><TableScan table_name=\\"store\\" exact_cardinality=\\"1\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"5418\\"><TableScan table_name=\\"household_demographics\\" exact_cardinality=\\"720\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"55509\\"><TableScan table_name=\\"time_dim\\" exact_cardinality=\\"1800\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "97.sql",
    "queryText": "with ssci as (\\nselect ss_customer_sk customer_sk\\n      ,ss_item_sk item_sk\\nfrom store_sales,date_dim\\nwhere ss_sold_date_sk = d_date_sk\\n  and d_month_seq between 1204 and 1204 + 11\\ngroup by ss_customer_sk\\n        ,ss_item_sk),\\ncsci as(\\n select cs_bill_customer_sk customer_sk\\n      ,cs_item_sk item_sk\\nfrom catalog_sales,date_dim\\nwhere cs_sold_date_sk = d_date_sk\\n  and d_month_seq between 1204 and 1204 + 11\\ngroup by cs_bill_customer_sk\\n        ,cs_item_sk)\\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\\n                               and ssci.item_sk = csci.item_sk)\\nlimit 100;",
    "benchmarkResult": {
      "total": 46.673
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"1\\"><Sort exact_cardinality=\\"1\\"><GroupBy exact_cardinality=\\"1\\"><Join type=\\"fullouter\\" method=\\"hash\\" exact_cardinality=\\"829498\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"285788\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285839\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy><GroupBy method=\\"hash\\" exact_cardinality=\\"543861\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"549559\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "98.sql",
    "queryText": "select i_item_id\\n      ,i_item_desc \\n      ,i_category \\n      ,i_class \\n      ,i_current_price\\n      ,sum(ss_ext_sales_price) as itemrevenue \\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\\n          (partition by i_class) as revenueratio\\nfrom\\t\\n\\tstore_sales\\n    \\t,item \\n    \\t,date_dim\\nwhere \\n\\tss_item_sk = i_item_sk \\n  \\tand i_category in ('Books', 'Home', 'Music')\\n  \\tand ss_sold_date_sk = d_date_sk\\n\\tand d_date between cast('1998-02-22' as date) \\n\\t\\t\\t\\tand (cast('1998-02-22' as date) + interval '30 days')\\ngroup by \\n\\ti_item_id\\n        ,i_item_desc \\n        ,i_category\\n        ,i_class\\n        ,i_current_price\\norder by \\n\\ti_category\\n        ,i_class\\n        ,i_item_id\\n        ,i_item_desc\\n        ,revenueratio;",
    "benchmarkResult": {
      "total": 26.525
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"2554\\"><Sort exact_cardinality=\\"2554\\"><Window exact_cardinality=\\"2554\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"2554\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"8125\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"31\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"867165\\"><TableScan table_name=\\"item\\" exact_cardinality=\\"5400\\" /><TableScan table_name=\\"store_sales\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "duck",
    "dataset": "tpcdsSf1",
    "query": "99.sql",
    "queryText": "select  \\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,cc_name\\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   catalog_sales\\n  ,warehouse\\n  ,ship_mode\\n  ,call_center\\n  ,date_dim\\nwhere\\n    d_month_seq between 1179 and 1179 + 11\\nand cs_ship_date_sk   = d_date_sk\\nand cs_warehouse_sk   = w_warehouse_sk\\nand cs_ship_mode_sk   = sm_ship_mode_sk\\nand cs_call_center_sk = cc_call_center_sk\\ngroup by\\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,cc_name\\norder by substr(w_warehouse_name,1,20)\\n        ,sm_type\\n        ,cc_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 44.3
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" exact_cardinality=\\"90\\"><Sort exact_cardinality=\\"90\\"><GroupBy method=\\"hash\\" exact_cardinality=\\"90\\"><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"284589\\"><TableScan table_name=\\"call_center\\" exact_cardinality=\\"6\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"284771\\"><TableScan table_name=\\"ship_mode\\" exact_cardinality=\\"20\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285132\\"><TableScan table_name=\\"warehouse\\" exact_cardinality=\\"5\\" /><Join type=\\"inner\\" method=\\"hash\\" exact_cardinality=\\"285838\\"><TableScan table_name=\\"date_dim\\" exact_cardinality=\\"365\\" /><TableScan table_name=\\"catalog_sales\\" exact_cardinality=\\"1441548\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "1.sql",
    "queryText": "with customer_total_return as\\n(select sr_customer_sk as ctr_customer_sk\\n,sr_store_sk as ctr_store_sk\\n,sum(SR_FEE) as ctr_total_return\\nfrom store_returns\\n,date_dim\\nwhere sr_returned_date_sk = d_date_sk\\nand d_year =2000\\ngroup by sr_customer_sk\\n,sr_store_sk)\\n select  c_customer_id\\nfrom customer_total_return ctr1\\n,store\\n,customer\\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\nfrom customer_total_return ctr2\\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\\nand s_store_sk = ctr1.ctr_store_sk\\nand s_state = 'SD'\\nand ctr1.ctr_customer_sk = c_customer_sk\\norder by c_customer_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.27992,
      "compilation": 2.4702,
      "execution": 4.8097199999999996,
      "scale": 460564.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3234\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3107\\" exact_cardinality=\\"0\\"><Select operator_id=\\"4\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><GroupBy operator_id=\\"5\\" mode=\\"regular\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"51366\\" exact_cardinality=\\"49939\\"><GroupBy operator_id=\\"7\\" mode=\\"regular\\" estimated_cardinality=\\"51366\\" exact_cardinality=\\"49939\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"57073\\" exact_cardinality=\\"54814\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"366\\" /><TableScan operator_id=\\"10\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"270948\\" exact_cardinality=\\"272426\\" /></Join></GroupBy></PipelineBreakerScan></GroupBy></Select><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4265\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"13\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><Select operator_id=\\"14\\" estimated_cardinality=\\"51182\\" exact_cardinality=\\"49749\\"><PipelineBreakerScan operator_id=\\"15\\" scanned_id=\\"7\\" estimated_cardinality=\\"51366\\" exact_cardinality=\\"49939\\" /></Select></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "2.sql",
    "queryText": "with wscs as\\n (select sold_date_sk\\n        ,sales_price\\n  from  (select ws_sold_date_sk sold_date_sk\\n              ,ws_ext_sales_price sales_price\\n        from web_sales) x\\n        union all\\n        select cs_sold_date_sk sold_date_sk\\n              ,cs_ext_sales_price sales_price\\n        from catalog_sales),\\n wswscs as \\n (select d_week_seq,\\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\\n from wscs\\n     ,date_dim\\n where d_date_sk = sold_date_sk\\n group by d_week_seq)\\n select d_week_seq1\\n       ,round(sun_sales1/sun_sales2,2)\\n       ,round(mon_sales1/mon_sales2,2)\\n       ,round(tue_sales1/tue_sales2,2)\\n       ,round(wed_sales1/wed_sales2,2)\\n       ,round(thu_sales1/thu_sales2,2)\\n       ,round(fri_sales1/fri_sales2,2)\\n       ,round(sat_sales1/sat_sales2,2)\\n from\\n (select wswscs.d_week_seq d_week_seq1\\n        ,sun_sales sun_sales1\\n        ,mon_sales mon_sales1\\n        ,tue_sales tue_sales1\\n        ,wed_sales wed_sales1\\n        ,thu_sales thu_sales1\\n        ,fri_sales fri_sales1\\n        ,sat_sales sat_sales1\\n  from wswscs,date_dim\\n  where date_dim.d_week_seq = wswscs.d_week_seq and\\n        d_year = 1998) y,\\n (select wswscs.d_week_seq d_week_seq2\\n        ,sun_sales sun_sales2\\n        ,mon_sales mon_sales2\\n        ,tue_sales tue_sales2\\n        ,wed_sales wed_sales2\\n        ,thu_sales thu_sales2\\n        ,fri_sales fri_sales2\\n        ,sat_sales sat_sales2\\n  from wswscs\\n      ,date_dim\\n  where date_dim.d_week_seq = wswscs.d_week_seq and\\n        d_year = 1998+1) z\\n where d_week_seq1=d_week_seq2-53\\n order by d_week_seq1;",
    "benchmarkResult": {
      "total": 22.16655,
      "compilation": 3.04435,
      "execution": 19.1222,
      "scale": 2380080.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"2513\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"2513\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"2513\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"60\\" exact_cardinality=\\"361\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"72\\" exact_cardinality=\\"365\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"365\\" /><PipelineBreakerScan operator_id=\\"7\\" scanned_id=\\"8\\" estimated_cardinality=\\"9191\\" exact_cardinality=\\"263\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"9191\\" exact_cardinality=\\"263\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2474854\\" exact_cardinality=\\"2153563\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /><SetOperation operator_id=\\"11\\" type=\\"unionall\\" estimated_cardinality=\\"2148966\\" exact_cardinality=\\"2153563\\"><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /><TableScan operator_id=\\"13\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></SetOperation></Join></GroupBy></PipelineBreakerScan></Join><PipelineBreakerScan operator_id=\\"14\\" scanned_id=\\"8\\" estimated_cardinality=\\"9191\\" exact_cardinality=\\"263\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "3.sql",
    "queryText": "select  dt.d_year \\n       ,item.i_brand_id brand_id \\n       ,item.i_brand brand\\n       ,sum(ss_sales_price) sum_agg\\n from  date_dim dt \\n      ,store_sales\\n      ,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n   and store_sales.ss_item_sk = item.i_item_sk\\n   and item.i_manufact_id = 816\\n   and dt.d_moy=11\\n group by dt.d_year\\n      ,item.i_brand\\n      ,item.i_brand_id\\n order by dt.d_year\\n         ,sum_agg desc\\n         ,brand_id\\n limit 100;",
    "benchmarkResult": {
      "total": 6.01268,
      "compilation": 1.93528,
      "execution": 4.0774,
      "scale": 2971454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"31\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"31\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"138\\" exact_cardinality=\\"31\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"154\\" exact_cardinality=\\"287\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1954\\" exact_cardinality=\\"1908\\"><TableScan operator_id=\\"5\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"11\\" /><TableScan operator_id=\\"6\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2745385\\" /></Join><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"5421\\" exact_cardinality=\\"6000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "4.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\\n       ,'c' sale_type\\n from customer\\n     ,catalog_sales\\n     ,date_dim\\n where c_customer_sk = cs_bill_customer_sk\\n   and cs_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\nunion all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag\\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n         )\\n  select  \\n                  t_s_secyear.customer_id\\n                 ,t_s_secyear.customer_first_name\\n                 ,t_s_secyear.customer_last_name\\n                 ,t_s_secyear.customer_birth_country\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_c_firstyear\\n     ,year_total t_c_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n   and t_s_firstyear.sale_type = 's'\\n   and t_c_firstyear.sale_type = 'c'\\n   and t_w_firstyear.sale_type = 'w'\\n   and t_s_secyear.sale_type = 's'\\n   and t_c_secyear.sale_type = 'c'\\n   and t_w_secyear.sale_type = 'w'\\n   and t_s_firstyear.dyear =  1999\\n   and t_s_secyear.dyear = 1999+1\\n   and t_c_firstyear.dyear =  1999\\n   and t_c_secyear.dyear =  1999+1\\n   and t_w_firstyear.dyear = 1999\\n   and t_w_secyear.dyear = 1999+1\\n   and t_s_firstyear.year_total > 0\\n   and t_c_firstyear.year_total > 0\\n   and t_w_firstyear.year_total > 0\\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\\n order by t_s_secyear.customer_id\\n         ,t_s_secyear.customer_first_name\\n         ,t_s_secyear.customer_last_name\\n         ,t_s_secyear.customer_birth_country\\nlimit 100;",
    "benchmarkResult": {
      "total": 102.0644,
      "compilation": 5.158399999999999,
      "execution": 96.906,
      "scale": 5560484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"4\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"4\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"4\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"13\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"748\\" exact_cardinality=\\"121\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1922\\" exact_cardinality=\\"1087\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15679\\" exact_cardinality=\\"4064\\"><Select operator_id=\\"7\\" estimated_cardinality=\\"127888\\" exact_cardinality=\\"11077\\"><PipelineBreakerScan operator_id=\\"8\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\"><Temp operator_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\"><SetOperation operator_id=\\"10\\" type=\\"unionall\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\"><Select operator_id=\\"11\\" estimated_cardinality=\\"218350\\" exact_cardinality=\\"75960\\"><GroupBy operator_id=\\"12\\" mode=\\"regular\\" estimated_cardinality=\\"776737\\" exact_cardinality=\\"75960\\"><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"863041\\" exact_cardinality=\\"1072028\\"><TableScan operator_id=\\"14\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"829047\\" exact_cardinality=\\"1072028\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"731\\" /><TableScan operator_id=\\"17\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></Join></GroupBy></Select><Select operator_id=\\"23\\" estimated_cardinality=\\"51023\\" exact_cardinality=\\"22230\\"><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"181503\\" exact_cardinality=\\"22409\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"201670\\" exact_cardinality=\\"285006\\"><TableScan operator_id=\\"26\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"193726\\" exact_cardinality=\\"285006\\"><TableScan operator_id=\\"28\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"731\\" /><TableScan operator_id=\\"29\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join></Join></GroupBy></Select><Select operator_id=\\"30\\" estimated_cardinality=\\"106234\\" exact_cardinality=\\"53780\\"><GroupBy operator_id=\\"31\\" mode=\\"regular\\" estimated_cardinality=\\"377905\\" exact_cardinality=\\"54828\\"><Join operator_id=\\"32\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"419894\\" exact_cardinality=\\"571871\\"><TableScan operator_id=\\"33\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"34\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"403355\\" exact_cardinality=\\"571871\\"><TableScan operator_id=\\"35\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"731\\" /><TableScan operator_id=\\"36\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join></GroupBy></Select></SetOperation></Temp></PipelineBreakerScan></Select><Select operator_id=\\"22\\" estimated_cardinality=\\"127888\\" exact_cardinality=\\"37708\\"><PipelineBreakerScan operator_id=\\"37\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\" /></Select></Join><Select operator_id=\\"20\\" estimated_cardinality=\\"127888\\" exact_cardinality=\\"26331\\"><PipelineBreakerScan operator_id=\\"38\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\" /></Select></Join><Select operator_id=\\"18\\" estimated_cardinality=\\"405705\\" exact_cardinality=\\"11153\\"><PipelineBreakerScan operator_id=\\"39\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\" /></Select></Join><Select operator_id=\\"19\\" estimated_cardinality=\\"405705\\" exact_cardinality=\\"27449\\"><PipelineBreakerScan operator_id=\\"40\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\" /></Select></Join><Select operator_id=\\"21\\" estimated_cardinality=\\"405705\\" exact_cardinality=\\"38252\\"><PipelineBreakerScan operator_id=\\"41\\" scanned_id=\\"9\\" estimated_cardinality=\\"375607\\" exact_cardinality=\\"151970\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "5.sql",
    "queryText": "with ssr as\\n (select s_store_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  ss_store_sk as store_sk,\\n            ss_sold_date_sk  as date_sk,\\n            ss_ext_sales_price as sales_price,\\n            ss_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from store_sales\\n    union all\\n    select sr_store_sk as store_sk,\\n           sr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           sr_return_amt as return_amt,\\n           sr_net_loss as net_loss\\n    from store_returns\\n   ) salesreturns,\\n     date_dim,\\n     store\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date) \\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and store_sk = s_store_sk\\n group by s_store_id)\\n ,\\n csr as\\n (select cp_catalog_page_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  cs_catalog_page_sk as page_sk,\\n            cs_sold_date_sk  as date_sk,\\n            cs_ext_sales_price as sales_price,\\n            cs_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from catalog_sales\\n    union all\\n    select cr_catalog_page_sk as page_sk,\\n           cr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           cr_return_amount as return_amt,\\n           cr_net_loss as net_loss\\n    from catalog_returns\\n   ) salesreturns,\\n     date_dim,\\n     catalog_page\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date)\\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and page_sk = cp_catalog_page_sk\\n group by cp_catalog_page_id)\\n ,\\n wsr as\\n (select web_site_id,\\n        sum(sales_price) as sales,\\n        sum(profit) as profit,\\n        sum(return_amt) as returns,\\n        sum(net_loss) as profit_loss\\n from\\n  ( select  ws_web_site_sk as wsr_web_site_sk,\\n            ws_sold_date_sk  as date_sk,\\n            ws_ext_sales_price as sales_price,\\n            ws_net_profit as profit,\\n            cast(0 as decimal(7,2)) as return_amt,\\n            cast(0 as decimal(7,2)) as net_loss\\n    from web_sales\\n    union all\\n    select ws_web_site_sk as wsr_web_site_sk,\\n           wr_returned_date_sk as date_sk,\\n           cast(0 as decimal(7,2)) as sales_price,\\n           cast(0 as decimal(7,2)) as profit,\\n           wr_return_amt as return_amt,\\n           wr_net_loss as net_loss\\n    from web_returns left outer join web_sales on\\n         ( wr_item_sk = ws_item_sk\\n           and wr_order_number = ws_order_number)\\n   ) salesreturns,\\n     date_dim,\\n     web_site\\n where date_sk = d_date_sk\\n       and d_date between cast('2000-08-19' as date)\\n                  and (cast('2000-08-19' as date) +  interval '14 days')\\n       and wsr_web_site_sk = web_site_sk\\n group by web_site_id)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , 'store' || s_store_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from   ssr\\n union all\\n select 'catalog channel' as channel\\n        , 'catalog_page' || cp_catalog_page_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from  csr\\n union all\\n select 'web channel' as channel\\n        , 'web_site' || web_site_id as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from   wsr\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 26.54652,
      "compilation": 6.12172,
      "execution": 20.4248,
      "scale": 6494972.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"929\\" exact_cardinality=\\"606\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"1032\\" exact_cardinality=\\"602\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1962\\" exact_cardinality=\\"30223\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2126\\" exact_cardinality=\\"30223\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"15\\" /><SetOperation operator_id=\\"9\\" type=\\"unionall\\" estimated_cardinality=\\"2965700.0\\" exact_cardinality=\\"2958113\\"><TableScan operator_id=\\"10\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"270948\\" exact_cardinality=\\"272426\\" /></SetOperation></Join></Join></GroupBy><GroupBy operator_id=\\"12\\" mode=\\"regular\\" estimated_cardinality=\\"15\\" exact_cardinality=\\"15\\"><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"458\\" exact_cardinality=\\"8395\\"><TableScan operator_id=\\"14\\" table_name=\\"web_site\\" table_size=\\"30\\" estimated_cardinality=\\"30\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"564\\" exact_cardinality=\\"8395\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"15\\" /><SetOperation operator_id=\\"17\\" type=\\"unionall\\" estimated_cardinality=\\"787013\\" exact_cardinality=\\"787735\\"><TableScan operator_id=\\"18\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719112\\" /><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"68332\\" exact_cardinality=\\"68623\\"><TableScan operator_id=\\"20\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"68399\\" exact_cardinality=\\"68636\\" /><TableScan operator_id=\\"21\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719198\\" /></Join></SetOperation></Join></Join></GroupBy><GroupBy operator_id=\\"22\\" mode=\\"regular\\" estimated_cardinality=\\"1012\\" exact_cardinality=\\"581\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1124\\" exact_cardinality=\\"15841\\"><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1124\\" exact_cardinality=\\"15841\\"><TableScan operator_id=\\"25\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"15\\" /><SetOperation operator_id=\\"26\\" type=\\"unionall\\" estimated_cardinality=\\"1568020.0\\" exact_cardinality=\\"1571951\\"><TableScan operator_id=\\"27\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430761\\" /><TableScan operator_id=\\"28\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"139142\\" exact_cardinality=\\"141190\\" /></SetOperation></Join><TableScan operator_id=\\"29\\" table_name=\\"catalog_page\\" table_size=\\"11718\\" estimated_cardinality=\\"11718\\" exact_cardinality=\\"11718\\" /></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "6.sql",
    "queryText": "select  a.ca_state state, count(*) cnt\\n from customer_address a\\n     ,customer c\\n     ,store_sales s\\n     ,date_dim d\\n     ,item i\\n where       a.ca_address_sk = c.c_current_addr_sk\\n \\tand c.c_customer_sk = s.ss_customer_sk\\n \\tand s.ss_sold_date_sk = d.d_date_sk\\n \\tand s.ss_item_sk = i.i_item_sk\\n \\tand d.d_month_seq = \\n \\t     (select distinct (d_month_seq)\\n \\t      from date_dim\\n               where d_year = 2002\\n \\t        and d_moy = 3 )\\n \\tand i.i_current_price > 1.2 * \\n             (select avg(j.i_current_price) \\n \\t     from item j \\n \\t     where j.i_category = i.i_category)\\n group by a.ca_state\\n having count(*) >= 10\\n order by cnt, a.ca_state \\n limit 100;",
    "benchmarkResult": {
      "total": 8.56607,
      "compilation": 2.4773199999999997,
      "execution": 6.08875,
      "scale": 3212503.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"44\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"44\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"44\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"50\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1198\\" exact_cardinality=\\"2707\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1198\\" exact_cardinality=\\"2707\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1151\\" exact_cardinality=\\"2707\\"><Select operator_id=\\"7\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"10\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"10\\"><TableScan operator_id=\\"9\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17964\\" exact_cardinality=\\"17957\\" /></GroupBy></Select><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1498\\" exact_cardinality=\\"25844\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1425\\" exact_cardinality=\\"25904\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"34\\" exact_cardinality=\\"31\\"><GroupBy operator_id=\\"14\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"31\\" /></GroupBy><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"17\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join><TableScan operator_id=\\"18\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"17955\\" /></Join></Join><TableScan operator_id=\\"19\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"20\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "7.sql",
    "queryText": "select  i_item_id, \\n        avg(ss_quantity) agg1,\\n        avg(ss_list_price) agg2,\\n        avg(ss_coupon_amt) agg3,\\n        avg(ss_sales_price) agg4 \\n from store_sales, customer_demographics, date_dim, item, promotion\\n where ss_sold_date_sk = d_date_sk and\\n       ss_item_sk = i_item_sk and\\n       ss_cdemo_sk = cd_demo_sk and\\n       ss_promo_sk = p_promo_sk and\\n       cd_gender = 'F' and \\n       cd_marital_status = 'W' and\\n       cd_education_status = 'College' and\\n       (p_channel_email = 'N' or p_channel_event = 'N') and\\n       d_year = 2001 \\n group by i_item_id\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 12.36455,
      "compilation": 2.15395,
      "execution": 10.2106,
      "scale": 4892554.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"5946\\" exact_cardinality=\\"4864\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6606\\" exact_cardinality=\\"7084\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6283\\" exact_cardinality=\\"7084\\"><TableScan operator_id=\\"5\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"299\\" exact_cardinality=\\"299\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7168\\" exact_cardinality=\\"7106\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"46973\\" exact_cardinality=\\"37938\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"33764\\" exact_cardinality=\\"27440\\" /><TableScan operator_id=\\"10\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2653108\\" /></Join></Join></Join><TableScan operator_id=\\"11\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "8.sql",
    "queryText": "select  s_store_name\\n      ,sum(ss_net_profit)\\n from store_sales\\n     ,date_dim\\n     ,store,\\n     (select ca_zip\\n     from (\\n      SELECT substr(ca_zip,1,5) ca_zip\\n      FROM customer_address\\n      WHERE substr(ca_zip,1,5) IN (\\n                          '47602','16704','35863','28577','83910','36201',\\n                          '58412','48162','28055','41419','80332',\\n                          '38607','77817','24891','16226','18410',\\n                          '21231','59345','13918','51089','20317',\\n                          '17167','54585','67881','78366','47770',\\n                          '18360','51717','73108','14440','21800',\\n                          '89338','45859','65501','34948','25973',\\n                          '73219','25333','17291','10374','18829',\\n                          '60736','82620','41351','52094','19326',\\n                          '25214','54207','40936','21814','79077',\\n                          '25178','75742','77454','30621','89193',\\n                          '27369','41232','48567','83041','71948',\\n                          '37119','68341','14073','16891','62878',\\n                          '49130','19833','24286','27700','40979',\\n                          '50412','81504','94835','84844','71954',\\n                          '39503','57649','18434','24987','12350',\\n                          '86379','27413','44529','98569','16515',\\n                          '27287','24255','21094','16005','56436',\\n                          '91110','68293','56455','54558','10298',\\n                          '83647','32754','27052','51766','19444',\\n                          '13869','45645','94791','57631','20712',\\n                          '37788','41807','46507','21727','71836',\\n                          '81070','50632','88086','63991','20244',\\n                          '31655','51782','29818','63792','68605',\\n                          '94898','36430','57025','20601','82080',\\n                          '33869','22728','35834','29086','92645',\\n                          '98584','98072','11652','78093','57553',\\n                          '43830','71144','53565','18700','90209',\\n                          '71256','38353','54364','28571','96560',\\n                          '57839','56355','50679','45266','84680',\\n                          '34306','34972','48530','30106','15371',\\n                          '92380','84247','92292','68852','13338',\\n                          '34594','82602','70073','98069','85066',\\n                          '47289','11686','98862','26217','47529',\\n                          '63294','51793','35926','24227','14196',\\n                          '24594','32489','99060','49472','43432',\\n                          '49211','14312','88137','47369','56877',\\n                          '20534','81755','15794','12318','21060',\\n                          '73134','41255','63073','81003','73873',\\n                          '66057','51184','51195','45676','92696',\\n                          '70450','90669','98338','25264','38919',\\n                          '59226','58581','60298','17895','19489',\\n                          '52301','80846','95464','68770','51634',\\n                          '19988','18367','18421','11618','67975',\\n                          '25494','41352','95430','15734','62585',\\n                          '97173','33773','10425','75675','53535',\\n                          '17879','41967','12197','67998','79658',\\n                          '59130','72592','14851','43933','68101',\\n                          '50636','25717','71286','24660','58058',\\n                          '72991','95042','15543','33122','69280',\\n                          '11912','59386','27642','65177','17672',\\n                          '33467','64592','36335','54010','18767',\\n                          '63193','42361','49254','33113','33159',\\n                          '36479','59080','11855','81963','31016',\\n                          '49140','29392','41836','32958','53163',\\n                          '13844','73146','23952','65148','93498',\\n                          '14530','46131','58454','13376','13378',\\n                          '83986','12320','17193','59852','46081',\\n                          '98533','52389','13086','68843','31013',\\n                          '13261','60560','13443','45533','83583',\\n                          '11489','58218','19753','22911','25115',\\n                          '86709','27156','32669','13123','51933',\\n                          '39214','41331','66943','14155','69998',\\n                          '49101','70070','35076','14242','73021',\\n                          '59494','15782','29752','37914','74686',\\n                          '83086','34473','15751','81084','49230',\\n                          '91894','60624','17819','28810','63180',\\n                          '56224','39459','55233','75752','43639',\\n                          '55349','86057','62361','50788','31830',\\n                          '58062','18218','85761','60083','45484',\\n                          '21204','90229','70041','41162','35390',\\n                          '16364','39500','68908','26689','52868',\\n                          '81335','40146','11340','61527','61794',\\n                          '71997','30415','59004','29450','58117',\\n                          '69952','33562','83833','27385','61860',\\n                          '96435','48333','23065','32961','84919',\\n                          '61997','99132','22815','56600','68730',\\n                          '48017','95694','32919','88217','27116',\\n                          '28239','58032','18884','16791','21343',\\n                          '97462','18569','75660','15475')\\n     intersect\\n      select ca_zip\\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\\n            FROM customer_address, customer\\n            WHERE ca_address_sk = c_current_addr_sk and\\n                  c_preferred_cust_flag='Y'\\n            group by ca_zip\\n            having count(*) > 10)A1)A2) V1\\n where ss_store_sk = s_store_sk\\n  and ss_sold_date_sk = d_date_sk\\n  and d_qoy = 2 and d_year = 1998\\n  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))\\n group by s_store_name\\n order by s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 10.314530000000001,
      "compilation": 3.9068,
      "execution": 6.407730000000001,
      "scale": 3153466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"117092\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"22\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"5\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><SetOperation operator_id=\\"6\\" type=\\"intersect\\" estimated_cardinality=\\"127\\" exact_cardinality=\\"5\\"><TableScan operator_id=\\"7\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"244\\" exact_cardinality=\\"300\\" /><Select operator_id=\\"8\\" estimated_cardinality=\\"2212\\" exact_cardinality=\\"961\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"3940\\" exact_cardinality=\\"3145\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"45464\\" exact_cardinality=\\"45993\\"><TableScan operator_id=\\"11\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"47265\\" exact_cardinality=\\"47428\\" /><TableScan operator_id=\\"12\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48095\\" exact_cardinality=\\"48461\\" /></Join></GroupBy></Select></SetOperation></Join><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"63156\\" exact_cardinality=\\"77230\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"91\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "9.sql",
    "queryText": "select case when (select count(*) \\n                  from store_sales \\n                  where ss_quantity between 1 and 20) > 157344\\n            then (select avg(ss_ext_discount_amt) \\n                  from store_sales \\n                  where ss_quantity between 1 and 20) \\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 1 and 20) end bucket1 ,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) > 34708\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) \\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 21 and 40) end bucket2,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60) > 253327\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 41 and 60) end bucket3,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80) > 272224\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 61 and 80) end bucket4,\\n       case when (select count(*)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100) > 428113\\n            then (select avg(ss_ext_discount_amt)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100)\\n            else (select avg(ss_net_profit)\\n                  from store_sales\\n                  where ss_quantity between 81 and 100) end bucket5\\nfrom reason\\nwhere r_reason_sk = 1\\n;",
    "benchmarkResult": {
      "total": 39.024739999999994,
      "compilation": 3.80674,
      "execution": 35.217999999999996,
      "scale": 43206061.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"3\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"4\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"531637\\" exact_cardinality=\\"550565\\" /></GroupBy><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"6\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"528824\\" exact_cardinality=\\"537402\\" /></GroupBy><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"9\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"10\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"565391\\" exact_cardinality=\\"536448\\" /></GroupBy><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"12\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"500695\\" exact_cardinality=\\"536582\\" /></GroupBy><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"15\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"16\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"559766\\" exact_cardinality=\\"537823\\" /></GroupBy><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"18\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"19\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"559766\\" exact_cardinality=\\"536689\\" /></GroupBy><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"21\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"22\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"523198\\" exact_cardinality=\\"537608\\" /></GroupBy><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"24\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"25\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"562578\\" exact_cardinality=\\"537100\\" /></GroupBy><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"27\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"28\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"568204\\" exact_cardinality=\\"550788\\" /></GroupBy><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"30\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"31\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"511946\\" exact_cardinality=\\"549650\\" /></GroupBy><Join operator_id=\\"32\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"33\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"34\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"565391\\" exact_cardinality=\\"536923\\" /></GroupBy><Join operator_id=\\"35\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"36\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"37\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"576643\\" exact_cardinality=\\"549402\\" /></GroupBy><Join operator_id=\\"38\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"39\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"40\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"506321\\" exact_cardinality=\\"536580\\" /></GroupBy><Join operator_id=\\"41\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"42\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"43\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"573830\\" exact_cardinality=\\"550003\\" /></GroupBy><GroupBy operator_id=\\"44\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"45\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"559766\\" exact_cardinality=\\"537735\\" /></GroupBy></Join></Join></Join></Join></Join></Join></Join></Join></Join></Join></Join></Join></Join></Join></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "10.sql",
    "queryText": "select  \\n  cd_gender,\\n  cd_marital_status,\\n  cd_education_status,\\n  count(*) cnt1,\\n  cd_purchase_estimate,\\n  count(*) cnt2,\\n  cd_credit_rating,\\n  count(*) cnt3,\\n  cd_dep_count,\\n  count(*) cnt4,\\n  cd_dep_employed_count,\\n  count(*) cnt5,\\n  cd_dep_college_count,\\n  count(*) cnt6\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  ca_county in ('Vermilion County','Park County','Dorchester County','Republic County','Hayes County') and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 2000 and\\n                d_moy between 4 and 4+3) and\\n   (exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 2000 and\\n                  d_moy between 4 ANd 4+3) or \\n    exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 2000 and\\n                  d_moy between 4 and 4+3))\\n group by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n order by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\nlimit 100;",
    "benchmarkResult": {
      "total": 10.55454,
      "compilation": 3.35087,
      "execution": 7.20367,
      "scale": 7331284.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"3\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"3\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"282\\" exact_cardinality=\\"3\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"313\\" exact_cardinality=\\"3\\"><Join operator_id=\\"5\\" type=\\"leftmark\\" method=\\"hash\\" estimated_cardinality=\\"391\\" exact_cardinality=\\"23\\"><Join operator_id=\\"6\\" type=\\"leftmark\\" method=\\"hash\\" estimated_cardinality=\\"391\\" exact_cardinality=\\"23\\"><Join operator_id=\\"7\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"391\\" exact_cardinality=\\"23\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"467\\" exact_cardinality=\\"294\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"244\\" exact_cardinality=\\"151\\" /><TableScan operator_id=\\"10\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"95703\\" exact_cardinality=\\"96562\\" /></Join><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"367824\\" exact_cardinality=\\"105845\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"122\\" /><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"238764\\" exact_cardinality=\\"55757\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"122\\" /><TableScan operator_id=\\"16\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"105200\\" exact_cardinality=\\"27494\\"><TableScan operator_id=\\"18\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"122\\" /><TableScan operator_id=\\"19\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></Join><TableScan operator_id=\\"20\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "11.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag \\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year \\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,c_preferred_cust_flag customer_preferred_cust_flag\\n       ,c_birth_country customer_birth_country\\n       ,c_login customer_login\\n       ,c_email_address customer_email_address\\n       ,d_year dyear\\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,c_preferred_cust_flag \\n         ,c_birth_country\\n         ,c_login\\n         ,c_email_address\\n         ,d_year\\n         )\\n  select  \\n                  t_s_secyear.customer_id\\n                 ,t_s_secyear.customer_first_name\\n                 ,t_s_secyear.customer_last_name\\n                 ,t_s_secyear.customer_login\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n         and t_s_firstyear.sale_type = 's'\\n         and t_w_firstyear.sale_type = 'w'\\n         and t_s_secyear.sale_type = 's'\\n         and t_w_secyear.sale_type = 'w'\\n         and t_s_firstyear.dyear = 2001\\n         and t_s_secyear.dyear = 2001+1\\n         and t_w_firstyear.dyear = 2001\\n         and t_w_secyear.dyear = 2001+1\\n         and t_s_firstyear.year_total > 0\\n         and t_w_firstyear.year_total > 0\\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\\n order by t_s_secyear.customer_id\\n         ,t_s_secyear.customer_first_name\\n         ,t_s_secyear.customer_last_name\\n         ,t_s_secyear.customer_login\\nlimit 100;",
    "benchmarkResult": {
      "total": 72.13118,
      "compilation": 3.5190799999999998,
      "execution": 68.6121,
      "scale": 3945887.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"88\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"88\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1639\\" exact_cardinality=\\"88\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"5436\\" exact_cardinality=\\"1659\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"134250\\" exact_cardinality=\\"4414\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"297712\\" exact_cardinality=\\"37923\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\"><SetOperation operator_id=\\"8\\" type=\\"unionall\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\"><Select operator_id=\\"9\\" estimated_cardinality=\\"384752\\" exact_cardinality=\\"76098\\"><GroupBy operator_id=\\"10\\" mode=\\"regular\\" estimated_cardinality=\\"1039400.0\\" exact_cardinality=\\"76098\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1154888\\" exact_cardinality=\\"1069861\\"><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1109399\\" exact_cardinality=\\"1069861\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"856\\" exact_cardinality=\\"730\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></Join></GroupBy></Select><Select operator_id=\\"19\\" estimated_cardinality=\\"93069\\" exact_cardinality=\\"22804\\"><GroupBy operator_id=\\"20\\" mode=\\"regular\\" estimated_cardinality=\\"265080\\" exact_cardinality=\\"22804\\"><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"294533\\" exact_cardinality=\\"289493\\"><TableScan operator_id=\\"22\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"282932\\" exact_cardinality=\\"289493\\"><TableScan operator_id=\\"24\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"856\\" exact_cardinality=\\"730\\" /><TableScan operator_id=\\"25\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join></Join></GroupBy></Select></SetOperation></Temp></PipelineBreakerScan></Select><Select operator_id=\\"17\\" estimated_cardinality=\\"297712\\" exact_cardinality=\\"11552\\"><PipelineBreakerScan operator_id=\\"26\\" scanned_id=\\"7\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\" /></Select></Join><Select operator_id=\\"18\\" estimated_cardinality=\\"543198\\" exact_cardinality=\\"38175\\"><PipelineBreakerScan operator_id=\\"27\\" scanned_id=\\"7\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\" /></Select></Join><Select operator_id=\\"16\\" estimated_cardinality=\\"543198\\" exact_cardinality=\\"11252\\"><PipelineBreakerScan operator_id=\\"28\\" scanned_id=\\"7\\" estimated_cardinality=\\"477821\\" exact_cardinality=\\"98902\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "12.sql",
    "queryText": "select  i_item_id\\n      ,i_item_desc \\n      ,i_category \\n      ,i_class \\n      ,i_current_price\\n      ,sum(ws_ext_sales_price) as itemrevenue \\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\\n          (partition by i_class) as revenueratio\\nfrom\\t\\n\\tweb_sales\\n    \\t,item \\n    \\t,date_dim\\nwhere \\n\\tws_item_sk = i_item_sk \\n  \\tand i_category in ('Men', 'Sports', 'Home')\\n  \\tand ws_sold_date_sk = d_date_sk\\n\\tand d_date between cast('2001-03-04' as date) \\n\\t\\t\\t\\tand (cast('2001-03-04' as date) + interval '30 days')\\ngroup by \\n\\ti_item_id\\n        ,i_item_desc \\n        ,i_category\\n        ,i_class\\n        ,i_current_price\\norder by \\n\\ti_category\\n        ,i_class\\n        ,i_item_id\\n        ,i_item_desc\\n        ,revenueratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.03495,
      "compilation": 2.25333,
      "execution": 4.78162,
      "scale": 810434.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"149\\" exact_cardinality=\\"1500\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"149\\" exact_cardinality=\\"1500\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"166\\" exact_cardinality=\\"2183\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"515\\" exact_cardinality=\\"7295\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"8\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join><TableScan operator_id=\\"9\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"5519\\" exact_cardinality=\\"5519\\" /></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "13.sql",
    "queryText": "select avg(ss_quantity)\\n       ,avg(ss_ext_sales_price)\\n       ,avg(ss_ext_wholesale_cost)\\n       ,sum(ss_ext_wholesale_cost)\\n from store_sales\\n     ,store\\n     ,customer_demographics\\n     ,household_demographics\\n     ,customer_address\\n     ,date_dim\\n where s_store_sk = ss_store_sk\\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\\n and((ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'W'\\n  and cd_education_status = 'Advanced Degree'\\n  and ss_sales_price between 100.00 and 150.00\\n  and hd_dep_count = 3   \\n     )or\\n     (ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'U'\\n  and cd_education_status = 'Primary'\\n  and ss_sales_price between 50.00 and 100.00   \\n  and hd_dep_count = 1\\n     ) or \\n     (ss_hdemo_sk=hd_demo_sk\\n  and cd_demo_sk = ss_cdemo_sk\\n  and cd_marital_status = 'S'\\n  and cd_education_status = '4 yr Degree'\\n  and ss_sales_price between 150.00 and 200.00 \\n  and hd_dep_count = 1  \\n     ))\\n and((ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('NE', 'IN', 'NC')\\n  and ss_net_profit between 100 and 200  \\n     ) or\\n     (ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('ID', 'GA', 'ME')\\n  and ss_net_profit between 150 and 300  \\n     ) or\\n     (ss_addr_sk = ca_address_sk\\n  and ca_country = 'United States'\\n  and ca_state in ('TN', 'AL', 'FL')\\n  and ss_net_profit between 50 and 250  \\n     ))\\n;",
    "benchmarkResult": {
      "total": 19.182270000000003,
      "compilation": 2.91137,
      "execution": 16.2709,
      "scale": 4931466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"11\\"><TableScan operator_id=\\"3\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"11\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"24\\" exact_cardinality=\\"199\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"157\\" exact_cardinality=\\"1527\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1126\\" exact_cardinality=\\"1640\\"><EarlyProbe operator_id=\\"9\\" source=\\"6\\" estimated_cardinality=\\"13569\\" exact_cardinality=\\"18523\\"><EarlyProbe operator_id=\\"10\\" source=\\"2\\" estimated_cardinality=\\"71735\\" exact_cardinality=\\"87105\\"><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"101264\\" exact_cardinality=\\"87105\\" /></EarlyProbe></EarlyProbe><TableScan operator_id=\\"12\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"159441\\" exact_cardinality=\\"159441\\" /></Join></Join><TableScan operator_id=\\"13\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"10449\\" exact_cardinality=\\"10449\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1357\\" exact_cardinality=\\"1357\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "14a.sql",
    "queryText": "with  cross_items as\\n (select i_item_sk ss_item_sk\\n from item,\\n (select iss.i_brand_id brand_id\\n     ,iss.i_class_id class_id\\n     ,iss.i_category_id category_id\\n from store_sales\\n     ,item iss\\n     ,date_dim d1\\n where ss_item_sk = iss.i_item_sk\\n   and ss_sold_date_sk = d1.d_date_sk\\n   and d1.d_year between 1998 AND 1998 + 2\\n intersect\\n select ics.i_brand_id\\n     ,ics.i_class_id\\n     ,ics.i_category_id\\n from catalog_sales\\n     ,item ics\\n     ,date_dim d2\\n where cs_item_sk = ics.i_item_sk\\n   and cs_sold_date_sk = d2.d_date_sk\\n   and d2.d_year between 1998 AND 1998 + 2\\n intersect\\n select iws.i_brand_id\\n     ,iws.i_class_id\\n     ,iws.i_category_id\\n from web_sales\\n     ,item iws\\n     ,date_dim d3\\n where ws_item_sk = iws.i_item_sk\\n   and ws_sold_date_sk = d3.d_date_sk\\n   and d3.d_year between 1998 AND 1998 + 2) x\\n where i_brand_id = brand_id\\n      and i_class_id = class_id\\n      and i_category_id = category_id\\n),\\n avg_sales as\\n (select avg(quantity*list_price) average_sales\\n  from (select ss_quantity quantity\\n             ,ss_list_price list_price\\n       from store_sales\\n           ,date_dim\\n       where ss_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select cs_quantity quantity\\n             ,cs_list_price list_price\\n       from catalog_sales\\n           ,date_dim\\n       where cs_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select ws_quantity quantity\\n             ,ws_list_price list_price\\n       from web_sales\\n           ,date_dim\\n       where ws_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2) x)\\n  select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)::integer\\n from(\\n       select 'store' channel, i_brand_id,i_class_id\\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\\n             , count(*) number_sales\\n       from store_sales\\n           ,item\\n           ,date_dim\\n       where ss_item_sk in (select ss_item_sk from cross_items)\\n         and ss_item_sk = i_item_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\\n       union all\\n       select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\\n       from catalog_sales\\n           ,item\\n           ,date_dim\\n       where cs_item_sk in (select ss_item_sk from cross_items)\\n         and cs_item_sk = i_item_sk\\n         and cs_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\\n       union all\\n       select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\\n       from web_sales\\n           ,item\\n           ,date_dim\\n       where ws_item_sk in (select ss_item_sk from cross_items)\\n         and ws_item_sk = i_item_sk\\n         and ws_sold_date_sk = d_date_sk\\n         and d_year = 1998+2\\n         and d_moy = 11\\n       group by i_brand_id,i_class_id,i_category_id\\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\\n ) y\\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\\n order by channel,i_brand_id,i_class_id,i_category_id\\n limit 100;",
    "benchmarkResult": {
      "total": 61.05702000000001,
      "compilation": 6.56372,
      "execution": 54.493300000000005,
      "scale": 15907450.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"9211\\" exact_cardinality=\\"14754\\"><SetOperation operator_id=\\"4\\" type=\\"unionall\\" estimated_cardinality=\\"10235\\" exact_cardinality=\\"6854\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"3522\\" exact_cardinality=\\"2447\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><PipelineBreakerScan operator_id=\\"9\\" scanned_id=\\"10\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"10\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><SetOperation operator_id=\\"11\\" type=\\"unionall\\" estimated_cardinality=\\"1966236\\" exact_cardinality=\\"2874036\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1105963\\" exact_cardinality=\\"1590222\\"><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2677875\\" exact_cardinality=\\"2652987\\" /></Join><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"290502\\" exact_cardinality=\\"428055\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"17\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719059\\" /></Join><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"569771\\" exact_cardinality=\\"855759\\"><TableScan operator_id=\\"19\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"20\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1429042\\" /></Join></SetOperation></GroupBy></PipelineBreakerScan></Select></Temp></PipelineBreakerScan><Select operator_id=\\"21\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2450\\"><GroupBy operator_id=\\"22\\" mode=\\"regular\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2450\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"58455\\" exact_cardinality=\\"88270\\"><TableScan operator_id=\\"24\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"25\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"55594\\" exact_cardinality=\\"88270\\"><PipelineBreakerScan operator_id=\\"26\\" scanned_id=\\"27\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><Temp operator_id=\\"27\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><Join operator_id=\\"28\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><SetOperation operator_id=\\"29\\" type=\\"intersect\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2498\\"><Join operator_id=\\"30\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"304243\\" exact_cardinality=\\"426333\\"><TableScan operator_id=\\"31\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"32\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"290502\\" exact_cardinality=\\"428139\\"><TableScan operator_id=\\"33\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"34\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></Join><Join operator_id=\\"35\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"582391\\" exact_cardinality=\\"855261\\"><TableScan operator_id=\\"36\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"37\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"556086\\" exact_cardinality=\\"858916\\"><TableScan operator_id=\\"38\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"39\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join><Join operator_id=\\"40\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1116940.0\\" exact_cardinality=\\"1641561\\"><TableScan operator_id=\\"41\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"42\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1066491\\" exact_cardinality=\\"1648598\\"><TableScan operator_id=\\"43\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"44\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></SetOperation><TableScan operator_id=\\"45\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /></Join></Temp></PipelineBreakerScan><Join operator_id=\\"46\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"65476\\" exact_cardinality=\\"88679\\"><TableScan operator_id=\\"47\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"48\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></Join></GroupBy></Select></Join><Join operator_id=\\"49\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"2782\\" exact_cardinality=\\"2023\\"><PipelineBreakerScan operator_id=\\"50\\" scanned_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><Select operator_id=\\"51\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2343\\"><GroupBy operator_id=\\"52\\" mode=\\"regular\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2343\\"><Join operator_id=\\"53\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"16520\\" exact_cardinality=\\"22312\\"><Join operator_id=\\"54\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"15712\\" exact_cardinality=\\"22312\\"><Join operator_id=\\"55\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18504\\" exact_cardinality=\\"22399\\"><TableScan operator_id=\\"56\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"57\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join><PipelineBreakerScan operator_id=\\"58\\" scanned_id=\\"27\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\" /></Join><TableScan operator_id=\\"59\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Select></Join><Join operator_id=\\"60\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2384\\"><PipelineBreakerScan operator_id=\\"61\\" scanned_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><Select operator_id=\\"62\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2440\\"><GroupBy operator_id=\\"63\\" mode=\\"regular\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2440\\"><Join operator_id=\\"64\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"83152\\" exact_cardinality=\\"46529\\"><PipelineBreakerScan operator_id=\\"65\\" scanned_id=\\"27\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\" /><Join operator_id=\\"66\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"43973\\" exact_cardinality=\\"46730\\"><TableScan operator_id=\\"67\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"68\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"41821\\" exact_cardinality=\\"46730\\"><TableScan operator_id=\\"69\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"70\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join></Join></GroupBy></Select></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "14b.sql",
    "queryText": "with  cross_items as\\n (select i_item_sk ss_item_sk\\n from item,\\n (select iss.i_brand_id brand_id\\n     ,iss.i_class_id class_id\\n     ,iss.i_category_id category_id\\n from store_sales\\n     ,item iss\\n     ,date_dim d1\\n where ss_item_sk = iss.i_item_sk\\n   and ss_sold_date_sk = d1.d_date_sk\\n   and d1.d_year between 1998 AND 1998 + 2\\n intersect\\n select ics.i_brand_id\\n     ,ics.i_class_id\\n     ,ics.i_category_id\\n from catalog_sales\\n     ,item ics\\n     ,date_dim d2\\n where cs_item_sk = ics.i_item_sk\\n   and cs_sold_date_sk = d2.d_date_sk\\n   and d2.d_year between 1998 AND 1998 + 2\\n intersect\\n select iws.i_brand_id\\n     ,iws.i_class_id\\n     ,iws.i_category_id\\n from web_sales\\n     ,item iws\\n     ,date_dim d3\\n where ws_item_sk = iws.i_item_sk\\n   and ws_sold_date_sk = d3.d_date_sk\\n   and d3.d_year between 1998 AND 1998 + 2) x\\n where i_brand_id = brand_id\\n      and i_class_id = class_id\\n      and i_category_id = category_id\\n),\\n avg_sales as\\n(select avg(quantity*list_price) average_sales\\n  from (select ss_quantity quantity\\n             ,ss_list_price list_price\\n       from store_sales\\n           ,date_dim\\n       where ss_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select cs_quantity quantity\\n             ,cs_list_price list_price\\n       from catalog_sales\\n           ,date_dim\\n       where cs_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2\\n       union all\\n       select ws_quantity quantity\\n             ,ws_list_price list_price\\n       from web_sales\\n           ,date_dim\\n       where ws_sold_date_sk = d_date_sk\\n         and d_year between 1998 and 1998 + 2) x)\\n  select  * from\\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\\n from store_sales \\n     ,item\\n     ,date_dim\\n where ss_item_sk in (select ss_item_sk from cross_items)\\n   and ss_item_sk = i_item_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_week_seq = (select d_week_seq\\n                     from date_dim\\n                     where d_year = 1998 + 1\\n                       and d_moy = 12\\n                       and d_dom = 20)\\n group by i_brand_id,i_class_id,i_category_id\\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\\n (select 'store' channel, i_brand_id,i_class_id\\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\\n from store_sales\\n     ,item\\n     ,date_dim\\n where ss_item_sk in (select ss_item_sk from cross_items)\\n   and ss_item_sk = i_item_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_week_seq = (select d_week_seq\\n                     from date_dim\\n                     where d_year = 1998\\n                       and d_moy = 12\\n                       and d_dom = 20)\\n group by i_brand_id,i_class_id,i_category_id\\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\\n where this_year.i_brand_id= last_year.i_brand_id\\n   and this_year.i_class_id = last_year.i_class_id\\n   and this_year.i_category_id = last_year.i_category_id\\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\\n limit 100;",
    "benchmarkResult": {
      "total": 56.07018,
      "compilation": 5.33308,
      "execution": 50.7371,
      "scale": 16681971.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"795\\"><PipelineBreakerScan operator_id=\\"3\\" scanned_id=\\"4\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Temp operator_id=\\"4\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><SetOperation operator_id=\\"10\\" type=\\"unionall\\" estimated_cardinality=\\"1913079\\" exact_cardinality=\\"2935653\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1066491\\" exact_cardinality=\\"1648598\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"290502\\" exact_cardinality=\\"428139\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"16\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"556086\\" exact_cardinality=\\"858916\\"><TableScan operator_id=\\"18\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"19\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></SetOperation></GroupBy></Select></Temp></PipelineBreakerScan></Select></Temp></PipelineBreakerScan><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"22\\" exact_cardinality=\\"812\\"><PipelineBreakerScan operator_id=\\"21\\" scanned_id=\\"4\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"44\\" exact_cardinality=\\"831\\"><Select operator_id=\\"23\\" estimated_cardinality=\\"279\\" exact_cardinality=\\"836\\"><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"279\\" exact_cardinality=\\"837\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"310\\" exact_cardinality=\\"21817\\"><Join operator_id=\\"26\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"296\\" exact_cardinality=\\"21817\\"><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"348\\" exact_cardinality=\\"21922\\"><Join operator_id=\\"28\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><TableScan operator_id=\\"30\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><TableScan operator_id=\\"31\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"32\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join><PipelineBreakerScan operator_id=\\"33\\" scanned_id=\\"34\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><Temp operator_id=\\"34\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><Join operator_id=\\"35\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\"><SetOperation operator_id=\\"36\\" type=\\"intersect\\" estimated_cardinality=\\"3931\\" exact_cardinality=\\"2498\\"><Join operator_id=\\"37\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"304243\\" exact_cardinality=\\"426333\\"><TableScan operator_id=\\"38\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"39\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"290502\\" exact_cardinality=\\"428139\\"><TableScan operator_id=\\"40\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"41\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></Join><Join operator_id=\\"42\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"582391\\" exact_cardinality=\\"855261\\"><TableScan operator_id=\\"43\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"44\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"556086\\" exact_cardinality=\\"858916\\"><TableScan operator_id=\\"45\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"46\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join><Join operator_id=\\"47\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1116940.0\\" exact_cardinality=\\"1641561\\"><TableScan operator_id=\\"48\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /><Join operator_id=\\"49\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1066491\\" exact_cardinality=\\"1648598\\"><TableScan operator_id=\\"50\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"784\\" exact_cardinality=\\"1096\\" /><TableScan operator_id=\\"51\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></SetOperation><TableScan operator_id=\\"52\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /></Join></Temp></PipelineBreakerScan></Join><TableScan operator_id=\\"53\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17929\\" /></Join></GroupBy></Select><Select operator_id=\\"54\\" estimated_cardinality=\\"108\\" exact_cardinality=\\"831\\"><GroupBy operator_id=\\"55\\" mode=\\"regular\\" estimated_cardinality=\\"108\\" exact_cardinality=\\"831\\"><Join operator_id=\\"56\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"120\\" exact_cardinality=\\"20724\\"><Join operator_id=\\"57\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"296\\" exact_cardinality=\\"20736\\"><Join operator_id=\\"58\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"349\\" exact_cardinality=\\"20822\\"><Join operator_id=\\"59\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><TableScan operator_id=\\"61\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><TableScan operator_id=\\"62\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"63\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join><PipelineBreakerScan operator_id=\\"64\\" scanned_id=\\"34\\" estimated_cardinality=\\"32372\\" exact_cardinality=\\"14626\\" /></Join><EarlyProbe operator_id=\\"65\\" source=\\"22\\" estimated_cardinality=\\"6955\\" exact_cardinality=\\"11564\\"><TableScan operator_id=\\"66\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17929\\" exact_cardinality=\\"17931\\" /></EarlyProbe></Join></GroupBy></Select></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "15.sql",
    "queryText": "select  ca_zip\\n       ,sum(cs_sales_price)\\n from catalog_sales\\n     ,customer\\n     ,customer_address\\n     ,date_dim\\n where cs_bill_customer_sk = c_customer_sk\\n \\tand c_current_addr_sk = ca_address_sk \\n \\tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\\n                                   '85392', '85460', '80348', '81792')\\n \\t      or ca_state in ('CA','WA','GA')\\n \\t      or cs_sales_price > 500)\\n \\tand cs_sold_date_sk = d_date_sk\\n \\tand d_qoy = 1 and d_year = 2000\\n group by ca_zip\\n order by ca_zip\\n limit 100;",
    "benchmarkResult": {
      "total": 8.17618,
      "compilation": 1.68585,
      "execution": 6.49033,
      "scale": 1664598.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"3940\\" exact_cardinality=\\"192\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"57050\\" exact_cardinality=\\"3305\\"><TableScan operator_id=\\"4\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"57050\\" exact_cardinality=\\"42004\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"54803\\" exact_cardinality=\\"42004\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"91\\" /><TableScan operator_id=\\"8\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join><TableScan operator_id=\\"9\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "16.sql",
    "queryText": "select  \\n   count(distinct cs_order_number) as \\"order count\\"\\n  ,sum(cs_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(cs_net_profit) as \\"total net profit\\"\\nfrom\\n   catalog_sales cs1\\n  ,date_dim\\n  ,customer_address\\n  ,call_center\\nwhere\\n    d_date between '2002-2-01' and \\n           (cast('2002-2-01' as date) + interval '60 days')\\nand cs1.cs_ship_date_sk = d_date_sk\\nand cs1.cs_ship_addr_sk = ca_address_sk\\nand ca_state = 'WA'\\nand cs1.cs_call_center_sk = cc_call_center_sk\\nand cc_county in ('Ziebach County','Walker County','Williamson County','Walker County',\\n                  'Ziebach County'\\n)\\nand exists (select *\\n            from catalog_sales cs2\\n            where cs1.cs_order_number = cs2.cs_order_number\\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\\nand not exists(select *\\n               from catalog_returns cr1\\n               where cs1.cs_order_number = cr1.cr_order_number)\\norder by count(distinct cs_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 8.3967,
      "compilation": 2.74195,
      "execution": 5.65475,
      "scale": 3150219.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"783\\" exact_cardinality=\\"250\\"><TableScan operator_id=\\"3\\" table_name=\\"call_center\\" table_size=\\"6\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\" /><Join operator_id=\\"4\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"783\\" exact_cardinality=\\"250\\"><Join operator_id=\\"5\\" type=\\"leftanti\\" method=\\"hash\\" estimated_cardinality=\\"866\\" exact_cardinality=\\"252\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1637\\" exact_cardinality=\\"695\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"61\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12930\\" exact_cardinality=\\"18246\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"634\\" exact_cardinality=\\"631\\" /><EarlyProbe operator_id=\\"10\\" source=\\"2\\" estimated_cardinality=\\"1019753\\" exact_cardinality=\\"1428996\\"><TableScan operator_id=\\"11\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1428996\\" /></EarlyProbe></Join></Join><TableScan operator_id=\\"12\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1441548\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "17.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,s_state\\n       ,count(ss_quantity) as store_sales_quantitycount\\n       ,avg(ss_quantity) as store_sales_quantityave\\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\\n       ,count(sr_return_quantity) as store_returns_quantitycount\\n       ,avg(sr_return_quantity) as store_returns_quantityave\\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\\n from store_sales\\n     ,store_returns\\n     ,catalog_sales\\n     ,date_dim d1\\n     ,date_dim d2\\n     ,date_dim d3\\n     ,store\\n     ,item\\n where d1.d_quarter_name = '2000Q1'\\n   and d1.d_date_sk = ss_sold_date_sk\\n   and i_item_sk = ss_item_sk\\n   and s_store_sk = ss_store_sk\\n   and ss_customer_sk = sr_customer_sk\\n   and ss_item_sk = sr_item_sk\\n   and ss_ticket_number = sr_ticket_number\\n   and sr_returned_date_sk = d2.d_date_sk\\n   and d2.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\\n   and sr_customer_sk = cs_bill_customer_sk\\n   and sr_item_sk = cs_item_sk\\n   and cs_sold_date_sk = d3.d_date_sk\\n   and d3.d_quarter_name in ('2000Q1','2000Q2','2000Q3')\\n group by i_item_id\\n         ,i_item_desc\\n         ,s_state\\n order by i_item_id\\n         ,i_item_desc\\n         ,s_state\\nlimit 100;",
    "benchmarkResult": {
      "total": 33.64049,
      "compilation": 3.64859,
      "execution": 29.991899999999998,
      "scale": 4846626.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"1\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"13601\\" exact_cardinality=\\"1\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15112\\" exact_cardinality=\\"1\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1223\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"274\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6301\\" exact_cardinality=\\"7\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"887\\" exact_cardinality=\\"6143\\"><TableScan operator_id=\\"9\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"887\\" exact_cardinality=\\"6143\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"91\\" /><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"19289\\" exact_cardinality=\\"29171\\"><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"41583\\" exact_cardinality=\\"39958\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"269263\\" exact_cardinality=\\"272517\\" /></Join><TableScan operator_id=\\"16\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2672249\\" /></Join></Join></Join><TableScan operator_id=\\"17\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join><TableScan operator_id=\\"18\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "18.sql",
    "queryText": "select  i_item_id,\\n        ca_country,\\n        ca_state, \\n        ca_county,\\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\\n from catalog_sales, customer_demographics cd1, \\n      customer_demographics cd2, customer, customer_address, date_dim, item\\n where cs_sold_date_sk = d_date_sk and\\n       cs_item_sk = i_item_sk and\\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\\n       cs_bill_customer_sk = c_customer_sk and\\n       cd1.cd_gender = 'M' and \\n       cd1.cd_education_status = '4 yr Degree' and\\n       c_current_cdemo_sk = cd2.cd_demo_sk and\\n       c_current_addr_sk = ca_address_sk and\\n       c_birth_month in (6,8,3,11,9,10) and\\n       d_year = 2001 and\\n       ca_state in ('AR','TN','KS'\\n                   ,'TX','SD','NY','IN')\\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\\n order by ca_country,\\n        ca_state, \\n        ca_county,\\n\\ti_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 25.75003,
      "compilation": 3.31403,
      "execution": 22.436,
      "scale": 5524198.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"1468\\" exact_cardinality=\\"7140\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1632\\" exact_cardinality=\\"1913\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1552\\" exact_cardinality=\\"1913\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1506\\" exact_cardinality=\\"1913\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"8405\\" exact_cardinality=\\"11154\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"10552\\" exact_cardinality=\\"10910\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"11279\\" exact_cardinality=\\"11576\\" /><TableScan operator_id=\\"10\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"46777\\" exact_cardinality=\\"47605\\" /></Join><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"76519\\" exact_cardinality=\\"101956\\"><TableScan operator_id=\\"12\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"103167\\" exact_cardinality=\\"137200\\" /><TableScan operator_id=\\"13\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1424654\\" exact_cardinality=\\"1429095\\" /></Join></Join></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "19.sql",
    "queryText": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\\n \\tsum(ss_ext_sales_price) ext_price\\n from date_dim, store_sales, item,customer,customer_address,store\\n where d_date_sk = ss_sold_date_sk\\n   and ss_item_sk = i_item_sk\\n   and i_manager_id=13\\n   and d_moy=12\\n   and d_year=2000\\n   and ss_customer_sk = c_customer_sk \\n   and c_current_addr_sk = ca_address_sk\\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \\n   and ss_store_sk = s_store_sk \\n group by i_brand\\n      ,i_brand_id\\n      ,i_manufact_id\\n      ,i_manufact\\n order by ext_price desc\\n         ,i_brand\\n         ,i_brand_id\\n         ,i_manufact_id\\n         ,i_manufact\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 8.776019999999999,
      "compilation": 2.10893,
      "execution": 6.66709,
      "scale": 3121466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"492\\" exact_cardinality=\\"181\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2420\\" exact_cardinality=\\"1710\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2516\\" exact_cardinality=\\"1760\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2417\\" exact_cardinality=\\"1760\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2417\\" exact_cardinality=\\"1760\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"76800\\" exact_cardinality=\\"49359\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"492\\" exact_cardinality=\\"339\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2653054\\" /></Join></Join></Join><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48095\\" exact_cardinality=\\"48461\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "20.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc \\n       ,i_category \\n       ,i_class \\n       ,i_current_price\\n       ,sum(cs_ext_sales_price) as itemrevenue \\n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\\n           (partition by i_class) as revenueratio\\n from\\tcatalog_sales\\n     ,item \\n     ,date_dim\\n where cs_item_sk = i_item_sk \\n   and i_category in ('Children', 'Men', 'Sports')\\n   and cs_sold_date_sk = d_date_sk\\n and d_date between cast('1999-05-24' as date) \\n \\t\\t\\t\\tand (cast('1999-05-24' as date) + interval '30 days')\\n group by i_item_id\\n         ,i_item_desc \\n         ,i_category\\n         ,i_class\\n         ,i_current_price\\n order by i_category\\n         ,i_class\\n         ,i_item_id\\n         ,i_item_desc\\n         ,revenueratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 8.84943,
      "compilation": 2.7438100000000003,
      "execution": 6.10562,
      "scale": 1532598.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"5361\\" exact_cardinality=\\"2116\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"5361\\" exact_cardinality=\\"2116\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15699\\" exact_cardinality=\\"4204\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"5361\\" exact_cardinality=\\"5380\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50130\\" exact_cardinality=\\"14159\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"9\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "21.sql",
    "queryText": "select  *\\n from(select w_warehouse_name\\n            ,i_item_id\\n            ,sum(case when (cast(d_date as date) < cast ('2002-05-26' as date))\\n\\t                then inv_quantity_on_hand \\n                      else 0 end) as inv_before\\n            ,sum(case when (cast(d_date as date) >= cast ('2002-05-26' as date))\\n                      then inv_quantity_on_hand \\n                      else 0 end) as inv_after\\n   from inventory\\n       ,warehouse\\n       ,item\\n       ,date_dim\\n   where i_current_price between 0.99 and 1.49\\n     and i_item_sk          = inv_item_sk\\n     and inv_warehouse_sk   = w_warehouse_sk\\n     and inv_date_sk    = d_date_sk\\n     and d_date between (cast ('2002-05-26' as date) - interval '30 days')\\n                    and (cast ('2002-05-26' as date) + interval '30 days')\\n   group by w_warehouse_name, i_item_id) x\\n where (case when inv_before > 0 \\n             then inv_after / inv_before \\n             else null\\n             end) between 2.0/3.0 and 3.0/2.0\\n order by w_warehouse_name\\n         ,i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 15.450249999999999,
      "compilation": 1.9726499999999998,
      "execution": 13.477599999999999,
      "scale": 11836055.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"100\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1220\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"455\\" exact_cardinality=\\"2840\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"506\\" exact_cardinality=\\"22720\\"><TableScan operator_id=\\"5\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"527\\" exact_cardinality=\\"22720\\"><TableScan operator_id=\\"7\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1072\\" exact_cardinality=\\"1104\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"8419\\" exact_cardinality=\\"360000\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><TableScan operator_id=\\"10\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"11745000.0\\" exact_cardinality=\\"11745000.0\\" /></Join></Join></Join></GroupBy></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "22.sql",
    "queryText": "select  i_product_name\\n             ,i_brand\\n             ,i_class\\n             ,i_category\\n             ,avg(inv_quantity_on_hand::bigint) qoh\\n       from inventory\\n           ,date_dim\\n           ,item\\n       where inv_date_sk=d_date_sk\\n              and inv_item_sk=i_item_sk\\n              and d_month_seq between 1219 and 1219 + 11\\n       group by rollup(i_product_name\\n                       ,i_brand\\n                       ,i_class\\n                       ,i_category)\\norder by qoh, i_product_name, i_brand, i_class, i_category\\nlimit 100;",
    "benchmarkResult": {
      "total": 155.98213,
      "compilation": 2.74813,
      "execution": 153.234,
      "scale": 11836050.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"47968\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3269535\\" exact_cardinality=\\"2340000.0\\"><TableScan operator_id=\\"4\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3109545\\" exact_cardinality=\\"2340000.0\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"7\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"11745000.0\\" exact_cardinality=\\"11745000.0\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "23a.sql",
    "queryText": "with frequent_ss_items as \\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\\n  from store_sales\\n      ,date_dim \\n      ,item\\n  where ss_sold_date_sk = d_date_sk\\n    and ss_item_sk = i_item_sk \\n    and d_year in (1999,1999+1,1999+2,1999+3)\\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\\n  having count(*) >4),\\n max_store_sales as\\n (select max(csales) tpcds_cmax \\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\\n        from store_sales\\n            ,customer\\n            ,date_dim \\n        where ss_customer_sk = c_customer_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year in (1999,1999+1,1999+2,1999+3) \\n        group by c_customer_sk) x),\\n best_ss_customer as\\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\\n  from store_sales\\n      ,customer\\n  where ss_customer_sk = c_customer_sk\\n  group by c_customer_sk\\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\\n  *\\nfrom\\n max_store_sales))\\n  select  sum(sales)\\n from (select cs_quantity*cs_list_price sales\\n       from catalog_sales\\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and cs_sold_date_sk = d_date_sk \\n         and cs_item_sk in (select item_sk from frequent_ss_items)\\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n      union all\\n      select ws_quantity*ws_list_price sales\\n       from web_sales \\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and ws_sold_date_sk = d_date_sk \\n         and ws_item_sk in (select item_sk from frequent_ss_items)\\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) y\\n limit 100;",
    "benchmarkResult": {
      "total": 84.34211,
      "compilation": 3.44571,
      "execution": 80.8964,
      "scale": 11312341.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><SetOperation operator_id=\\"2\\" type=\\"unionall\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Temp operator_id=\\"6\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupJoin operator_id=\\"10\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"85116\\"><TableScan operator_id=\\"11\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1939560.0\\" exact_cardinality=\\"2141889\\"><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1355\\" exact_cardinality=\\"1461\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></GroupJoin></GroupBy></Select><Select operator_id=\\"15\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"90858\\"><GroupJoin operator_id=\\"16\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"90858\\"><TableScan operator_id=\\"17\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><TableScan operator_id=\\"18\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2765075\\" exact_cardinality=\\"2750652\\" /></GroupJoin></Select></Join></Temp></PipelineBreakerScan><Join operator_id=\\"19\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"1487\\" exact_cardinality=\\"5840\\"><PipelineBreakerScan operator_id=\\"20\\" scanned_id=\\"21\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><Temp operator_id=\\"21\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><Select operator_id=\\"22\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><GroupBy operator_id=\\"23\\" mode=\\"regular\\" estimated_cardinality=\\"1804588\\" exact_cardinality=\\"1975696\\"><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2005097\\" exact_cardinality=\\"2193642\\"><TableScan operator_id=\\"25\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1906981\\" exact_cardinality=\\"2193642\\"><TableScan operator_id=\\"27\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1355\\" exact_cardinality=\\"1461\\" /><TableScan operator_id=\\"28\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Select></Temp></PipelineBreakerScan><TableScan operator_id=\\"29\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1429042\\" /></Join></Join><TableScan operator_id=\\"30\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"49\\" /></Join><Join operator_id=\\"31\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"32\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"33\\" scanned_id=\\"6\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\" /><Join operator_id=\\"34\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"749\\" exact_cardinality=\\"2946\\"><PipelineBreakerScan operator_id=\\"35\\" scanned_id=\\"21\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\" /><TableScan operator_id=\\"36\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719059\\" /></Join></Join><TableScan operator_id=\\"37\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"49\\" /></Join></SetOperation></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "23b.sql",
    "queryText": "with frequent_ss_items as\\n (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\\n  from store_sales\\n      ,date_dim\\n      ,item\\n  where ss_sold_date_sk = d_date_sk\\n    and ss_item_sk = i_item_sk\\n    and d_year in (1999,1999 + 1,1999 + 2,1999 + 3)\\n  group by substr(i_item_desc,1,30),i_item_sk,d_date\\n  having count(*) >4),\\n max_store_sales as\\n (select max(csales) tpcds_cmax\\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\\n        from store_sales\\n            ,customer\\n            ,date_dim \\n        where ss_customer_sk = c_customer_sk\\n         and ss_sold_date_sk = d_date_sk\\n         and d_year in (1999,1999+1,1999+2,1999+3)\\n        group by c_customer_sk) x),\\n best_ss_customer as\\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\\n  from store_sales\\n      ,customer\\n  where ss_customer_sk = c_customer_sk\\n  group by c_customer_sk\\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\\n  *\\n from max_store_sales))\\n  select  c_last_name,c_first_name,sales\\n from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales\\n        from catalog_sales\\n            ,customer\\n            ,date_dim \\n        where d_year = 1999 \\n         and d_moy = 7 \\n         and cs_sold_date_sk = d_date_sk \\n         and cs_item_sk in (select item_sk from frequent_ss_items)\\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n         and cs_bill_customer_sk = c_customer_sk \\n       group by c_last_name,c_first_name\\n      union all\\n      select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales\\n       from web_sales\\n           ,customer\\n           ,date_dim \\n       where d_year = 1999 \\n         and d_moy = 7 \\n         and ws_sold_date_sk = d_date_sk \\n         and ws_item_sk in (select item_sk from frequent_ss_items)\\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\\n         and ws_bill_customer_sk = c_customer_sk\\n       group by c_last_name,c_first_name) y\\n     order by c_last_name,c_first_name,sales\\n  limit 100;",
    "benchmarkResult": {
      "total": 83.24234,
      "compilation": 3.99144,
      "execution": 79.2509,
      "scale": 11512341.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><SetOperation operator_id=\\"2\\" type=\\"unionall\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"7\\" scanned_id=\\"8\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Temp operator_id=\\"8\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\"><Select operator_id=\\"10\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"11\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupJoin operator_id=\\"12\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"85116\\"><TableScan operator_id=\\"13\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1939560.0\\" exact_cardinality=\\"2141889\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1355\\" exact_cardinality=\\"1461\\" /><TableScan operator_id=\\"16\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></GroupJoin></GroupBy></Select><Select operator_id=\\"17\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"90858\\"><GroupJoin operator_id=\\"18\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"84562\\" exact_cardinality=\\"90858\\"><TableScan operator_id=\\"19\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><TableScan operator_id=\\"20\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2765075\\" exact_cardinality=\\"2750652\\" /></GroupJoin></Select></Join></Temp></PipelineBreakerScan><Join operator_id=\\"21\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"1490\\" exact_cardinality=\\"5851\\"><PipelineBreakerScan operator_id=\\"22\\" scanned_id=\\"23\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><Temp operator_id=\\"23\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><Select operator_id=\\"24\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\"><GroupBy operator_id=\\"25\\" mode=\\"regular\\" estimated_cardinality=\\"1804588\\" exact_cardinality=\\"1975696\\"><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2005097\\" exact_cardinality=\\"2193642\\"><TableScan operator_id=\\"27\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"28\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1906981\\" exact_cardinality=\\"2193642\\"><TableScan operator_id=\\"29\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1355\\" exact_cardinality=\\"1461\\" /><TableScan operator_id=\\"30\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Select></Temp></PipelineBreakerScan><TableScan operator_id=\\"31\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join><TableScan operator_id=\\"32\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"49\\" /></Join><TableScan operator_id=\\"33\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></GroupBy><GroupBy operator_id=\\"34\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"35\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"36\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"37\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"38\\" scanned_id=\\"8\\" estimated_cardinality=\\"158\\" exact_cardinality=\\"14\\" /><Join operator_id=\\"39\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"749\\" exact_cardinality=\\"2946\\"><PipelineBreakerScan operator_id=\\"40\\" scanned_id=\\"23\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"65\\" /><TableScan operator_id=\\"41\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join></Join><TableScan operator_id=\\"42\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"49\\" /></Join><TableScan operator_id=\\"43\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></GroupBy></SetOperation></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "24a.sql",
    "queryText": "with ssales as\\n(select c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,ca_state\\n      ,s_state\\n      ,i_color\\n      ,i_current_price\\n      ,i_manager_id\\n      ,i_units\\n      ,i_size\\n      ,sum(ss_sales_price) netpaid\\nfrom store_sales\\n    ,store_returns\\n    ,store\\n    ,item\\n    ,customer\\n    ,customer_address\\nwhere ss_ticket_number = sr_ticket_number\\n  and ss_item_sk = sr_item_sk\\n  and ss_customer_sk = c_customer_sk\\n  and ss_item_sk = i_item_sk\\n  and ss_store_sk = s_store_sk\\n  and c_current_addr_sk = ca_address_sk\\n  and c_birth_country <> upper(ca_country)\\n  and s_zip = ca_zip\\nand s_market_id=9\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n        ,ca_state\\n        ,s_state\\n        ,i_color\\n        ,i_current_price\\n        ,i_manager_id\\n        ,i_units\\n        ,i_size)\\nselect c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,sum(netpaid) paid\\nfrom ssales\\nwhere i_color = 'chocolate'\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\\n                                 from ssales)\\norder by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n;",
    "benchmarkResult": {
      "total": 8.79117,
      "compilation": 3.0518899999999998,
      "execution": 5.73928,
      "scale": 3335919.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\"><GroupBy operator_id=\\"6\\" mode=\\"regular\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"32\\" exact_cardinality=\\"42\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"31\\" exact_cardinality=\\"42\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"310\\" exact_cardinality=\\"396\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"74\\"><TableScan operator_id=\\"11\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"33\\" exact_cardinality=\\"44\\" /><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"95898\\" exact_cardinality=\\"96561\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"466940\\" exact_cardinality=\\"447501\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></PipelineBreakerScan></GroupBy></Select><Select operator_id=\\"16\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"17\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Select operator_id=\\"18\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"19\\" scanned_id=\\"6\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\" /></Select></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "24b.sql",
    "queryText": "with ssales as\\n(select c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,ca_state\\n      ,s_state\\n      ,i_color\\n      ,i_current_price\\n      ,i_manager_id\\n      ,i_units\\n      ,i_size\\n      ,sum(ss_sales_price) netpaid\\nfrom store_sales\\n    ,store_returns\\n    ,store\\n    ,item\\n    ,customer\\n    ,customer_address\\nwhere ss_ticket_number = sr_ticket_number\\n  and ss_item_sk = sr_item_sk\\n  and ss_customer_sk = c_customer_sk\\n  and ss_item_sk = i_item_sk\\n  and ss_store_sk = s_store_sk\\n  and c_current_addr_sk = ca_address_sk\\n  and c_birth_country <> upper(ca_country)\\n  and s_zip = ca_zip\\n  and s_market_id = 9\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n        ,ca_state\\n        ,s_state\\n        ,i_color\\n        ,i_current_price\\n        ,i_manager_id\\n        ,i_units\\n        ,i_size)\\nselect c_last_name\\n      ,c_first_name\\n      ,s_store_name\\n      ,sum(netpaid) paid\\nfrom ssales\\nwhere i_color = 'lawn'\\ngroup by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\\n                           from ssales)\\norder by c_last_name\\n        ,c_first_name\\n        ,s_store_name\\n;",
    "benchmarkResult": {
      "total": 9.681529999999999,
      "compilation": 3.32848,
      "execution": 6.35305,
      "scale": 3335919.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\"><GroupBy operator_id=\\"6\\" mode=\\"regular\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"32\\" exact_cardinality=\\"42\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"31\\" exact_cardinality=\\"42\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"310\\" exact_cardinality=\\"396\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"74\\"><TableScan operator_id=\\"11\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"33\\" exact_cardinality=\\"44\\" /><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"95898\\" exact_cardinality=\\"96561\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"466940\\" exact_cardinality=\\"447501\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></PipelineBreakerScan></GroupBy></Select><Select operator_id=\\"16\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"17\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Select operator_id=\\"18\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"19\\" scanned_id=\\"6\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"42\\" /></Select></GroupBy></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "25.sql",
    "queryText": "select  \\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n ,stddev_samp(ss_net_profit) as store_sales_profit\\n ,stddev_samp(sr_net_loss) as store_returns_loss\\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\\n from\\n store_sales\\n ,store_returns\\n ,catalog_sales\\n ,date_dim d1\\n ,date_dim d2\\n ,date_dim d3\\n ,store\\n ,item\\n where\\n d1.d_moy = 4\\n and d1.d_year = 2002\\n and d1.d_date_sk = ss_sold_date_sk\\n and i_item_sk = ss_item_sk\\n and s_store_sk = ss_store_sk\\n and ss_customer_sk = sr_customer_sk\\n and ss_item_sk = sr_item_sk\\n and ss_ticket_number = sr_ticket_number\\n and sr_returned_date_sk = d2.d_date_sk\\n and d2.d_moy               between 4 and  10\\n and d2.d_year              = 2002\\n and sr_customer_sk = cs_bill_customer_sk\\n and sr_item_sk = cs_item_sk\\n and cs_sold_date_sk = d3.d_date_sk\\n and d3.d_moy               between 4 and  10 \\n and d3.d_year              = 2002\\n group by\\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n order by\\n i_item_id\\n ,i_item_desc\\n ,s_store_id\\n ,s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 29.510219999999997,
      "compilation": 2.7380199999999997,
      "execution": 26.772199999999998,
      "scale": 4846626.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"6735\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"7483\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"606\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"5\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"214\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3974\\" exact_cardinality=\\"2\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"559\\" exact_cardinality=\\"1793\\"><TableScan operator_id=\\"8\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"559\\" exact_cardinality=\\"1793\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"19198\\" exact_cardinality=\\"18561\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"41387\\" exact_cardinality=\\"25412\\"><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"214\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"269263\\" exact_cardinality=\\"272517\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2672249\\" /></Join></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join><TableScan operator_id=\\"17\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "26.sql",
    "queryText": "select  i_item_id, \\n        avg(cs_quantity) agg1,\\n        avg(cs_list_price) agg2,\\n        avg(cs_coupon_amt) agg3,\\n        avg(cs_sales_price) agg4 \\n from catalog_sales, customer_demographics, date_dim, item, promotion\\n where cs_sold_date_sk = d_date_sk and\\n       cs_item_sk = i_item_sk and\\n       cs_bill_cdemo_sk = cd_demo_sk and\\n       cs_promo_sk = p_promo_sk and\\n       cd_gender = 'M' and \\n       cd_marital_status = 'D' and\\n       cd_education_status = 'Secondary' and\\n       (p_channel_email = 'N' or p_channel_event = 'N') and\\n       d_year = 2001 \\n group by i_item_id\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 12.70096,
      "compilation": 2.6851599999999998,
      "execution": 10.0158,
      "scale": 3453698.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"4146\\" exact_cardinality=\\"3095\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4607\\" exact_cardinality=\\"3784\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4381\\" exact_cardinality=\\"3784\\"><TableScan operator_id=\\"5\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"299\\" exact_cardinality=\\"299\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4998\\" exact_cardinality=\\"3797\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"27852\\" exact_cardinality=\\"20641\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"37515\\" exact_cardinality=\\"27440\\" /><TableScan operator_id=\\"10\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1429023\\" /></Join></Join></Join><TableScan operator_id=\\"11\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "27.sql",
    "queryText": "select  i_item_id,\\n        s_state, grouping(s_state) g_state,\\n        avg(ss_quantity) agg1,\\n        avg(ss_list_price) agg2,\\n        avg(ss_coupon_amt) agg3,\\n        avg(ss_sales_price) agg4\\n from store_sales, customer_demographics, date_dim, store, item\\n where ss_sold_date_sk = d_date_sk and\\n       ss_item_sk = i_item_sk and\\n       ss_store_sk = s_store_sk and\\n       ss_cdemo_sk = cd_demo_sk and\\n       cd_gender = 'F' and\\n       cd_marital_status = 'M' and\\n       cd_education_status = 'Advanced Degree' and\\n       d_year = 1998 and\\n       s_state in ('TN','AL', 'SD', 'SD', 'SD', 'SD')\\n group by rollup (i_item_id, s_state)\\n order by i_item_id\\n         ,s_state\\n limit 100;",
    "benchmarkResult": {
      "total": 16.51367,
      "compilation": 3.39487,
      "execution": 13.1188,
      "scale": 4892266.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"4548\\" exact_cardinality=\\"9775\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"5054\\" exact_cardinality=\\"7100\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4806\\" exact_cardinality=\\"7100\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4806\\" exact_cardinality=\\"7100\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"41621\\" exact_cardinality=\\"37961\\"><TableScan operator_id=\\"10\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"30012\\" exact_cardinality=\\"27440\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2663811\\" exact_cardinality=\\"2652962\\" /></Join></Join></Join><TableScan operator_id=\\"12\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "28.sql",
    "queryText": "select  *\\nfrom (select avg(ss_list_price) B1_LP\\n            ,count(ss_list_price) B1_CNT\\n            ,count(distinct ss_list_price) B1_CNTD\\n      from store_sales\\n      where ss_quantity between 0 and 5\\n        and (ss_list_price between 32 and 32+10 \\n             or ss_coupon_amt between 4429 and 4429+1000\\n             or ss_wholesale_cost between 0 and 0+20)) B1,\\n     (select avg(ss_list_price) B2_LP\\n            ,count(ss_list_price) B2_CNT\\n            ,count(distinct ss_list_price) B2_CNTD\\n      from store_sales\\n      where ss_quantity between 6 and 10\\n        and (ss_list_price between 170 and 170+10\\n          or ss_coupon_amt between 4727 and 4727+1000\\n          or ss_wholesale_cost between 8 and 8+20)) B2,\\n     (select avg(ss_list_price) B3_LP\\n            ,count(ss_list_price) B3_CNT\\n            ,count(distinct ss_list_price) B3_CNTD\\n      from store_sales\\n      where ss_quantity between 11 and 15\\n        and (ss_list_price between 124 and 124+10\\n          or ss_coupon_amt between 9657 and 9657+1000\\n          or ss_wholesale_cost between 43 and 43+20)) B3,\\n     (select avg(ss_list_price) B4_LP\\n            ,count(ss_list_price) B4_CNT\\n            ,count(distinct ss_list_price) B4_CNTD\\n      from store_sales\\n      where ss_quantity between 16 and 20\\n        and (ss_list_price between 104 and 104+10\\n          or ss_coupon_amt between 17161 and 17161+1000\\n          or ss_wholesale_cost between 34 and 34+20)) B4,\\n     (select avg(ss_list_price) B5_LP\\n            ,count(ss_list_price) B5_CNT\\n            ,count(distinct ss_list_price) B5_CNTD\\n      from store_sales\\n      where ss_quantity between 21 and 25\\n        and (ss_list_price between 73 and 73+10\\n          or ss_coupon_amt between 17064 and 17064+1000\\n          or ss_wholesale_cost between 56 and 56+20)) B5,\\n     (select avg(ss_list_price) B6_LP\\n            ,count(ss_list_price) B6_CNT\\n            ,count(distinct ss_list_price) B6_CNTD\\n      from store_sales\\n      where ss_quantity between 26 and 30\\n        and (ss_list_price between 65 and 65+10\\n          or ss_coupon_amt between 10899 and 10899+1000\\n          or ss_wholesale_cost between 54 and 54+20)) B6\\nlimit 100;",
    "benchmarkResult": {
      "total": 35.555080000000004,
      "compilation": 3.89258,
      "execution": 31.6625,
      "scale": 17282425.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"1\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"2\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"3\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"39380\\" exact_cardinality=\\"32736\\" /></GroupBy><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"5\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"6\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"36567\\" exact_cardinality=\\"32627\\" /></GroupBy><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"8\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"9\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"39380\\" exact_cardinality=\\"35082\\" /></GroupBy><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"11\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"12\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"28128\\" exact_cardinality=\\"32921\\" /></GroupBy><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"14\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"30941\\" exact_cardinality=\\"34122\\" /></GroupBy><GroupBy operator_id=\\"16\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"17\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"30941\\" exact_cardinality=\\"28748\\" /></GroupBy></Join></Join></Join></Join></Join></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "29.sql",
    "queryText": "select   \\n     i_item_id\\n    ,i_item_desc\\n    ,s_store_id\\n    ,s_store_name\\n    ,stddev_samp(ss_quantity)        as store_sales_quantity\\n    ,stddev_samp(sr_return_quantity) as store_returns_quantity\\n    ,stddev_samp(cs_quantity)        as catalog_sales_quantity\\n from\\n    store_sales\\n   ,store_returns\\n   ,catalog_sales\\n   ,date_dim             d1\\n   ,date_dim             d2\\n   ,date_dim             d3\\n   ,store\\n   ,item\\n where\\n     d1.d_moy               = 4 \\n and d1.d_year              = 2000\\n and d1.d_date_sk           = ss_sold_date_sk\\n and i_item_sk              = ss_item_sk\\n and s_store_sk             = ss_store_sk\\n and ss_customer_sk         = sr_customer_sk\\n and ss_item_sk             = sr_item_sk\\n and ss_ticket_number       = sr_ticket_number\\n and sr_returned_date_sk    = d2.d_date_sk\\n and d2.d_moy               between 4 and  4 + 3 \\n and d2.d_year              = 2000\\n and sr_customer_sk         = cs_bill_customer_sk\\n and sr_item_sk             = cs_item_sk\\n and cs_sold_date_sk        = d3.d_date_sk     \\n and d3.d_year              in (2000,2000+1,2000+2)\\n group by\\n    i_item_id\\n   ,i_item_desc\\n   ,s_store_id\\n   ,s_store_name\\n order by\\n    i_item_id \\n   ,i_item_desc\\n   ,s_store_id\\n   ,s_store_name\\n limit 100;",
    "benchmarkResult": {
      "total": 20.557679999999998,
      "compilation": 2.9032799999999996,
      "execution": 17.6544,
      "scale": 4846626.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"37405\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"41562\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"4\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1284\\" exact_cardinality=\\"1096\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"60786\\" exact_cardinality=\\"1\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"728\\" exact_cardinality=\\"1116\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"693\\" exact_cardinality=\\"1116\\"><TableScan operator_id=\\"8\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"693\\" exact_cardinality=\\"1116\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"15283\\" exact_cardinality=\\"11269\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"32947\\" exact_cardinality=\\"15449\\"><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"122\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"269263\\" exact_cardinality=\\"272517\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2672249\\" /></Join></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><TableScan operator_id=\\"17\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "30.sql",
    "queryText": "with customer_total_return as\\n (select wr_returning_customer_sk as ctr_customer_sk\\n        ,ca_state as ctr_state, \\n \\tsum(wr_return_amt) as ctr_total_return\\n from web_returns\\n     ,date_dim\\n     ,customer_address\\n where wr_returned_date_sk = d_date_sk \\n   and d_year =2001\\n   and wr_returning_addr_sk = ca_address_sk \\n group by wr_returning_customer_sk\\n         ,ca_state)\\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\\n       ,c_last_review_date_sk,ctr_total_return\\n from customer_total_return ctr1\\n     ,customer_address\\n     ,customer\\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\n \\t\\t\\t  from customer_total_return ctr2 \\n                  \\t  where ctr1.ctr_state = ctr2.ctr_state)\\n       and ca_address_sk = c_current_addr_sk\\n       and ca_state = 'GA'\\n       and ctr1.ctr_customer_sk = c_customer_sk\\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\\n                  ,c_last_review_date_sk,ctr_total_return\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.5525,
      "compilation": 2.8391699999999997,
      "execution": 4.71333,
      "scale": 344813.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"361\\" exact_cardinality=\\"167\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"51\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"51\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"9821\\" exact_cardinality=\\"12723\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"10028\\" exact_cardinality=\\"13112\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"10028\\" exact_cardinality=\\"13112\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"10028\\" exact_cardinality=\\"13112\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"10028\\" exact_cardinality=\\"13117\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"11142\\" exact_cardinality=\\"13271\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"11142\\" exact_cardinality=\\"13271\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"13\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"66366\\" exact_cardinality=\\"66970\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select></Temp></PipelineBreakerScan></Select></GroupBy></Select><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"489\\" exact_cardinality=\\"633\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4686\\" exact_cardinality=\\"4955\\"><TableScan operator_id=\\"18\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"2343\\" exact_cardinality=\\"2446\\" /><TableScan operator_id=\\"19\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><Select operator_id=\\"15\\" estimated_cardinality=\\"10027\\" exact_cardinality=\\"13001\\"><PipelineBreakerScan operator_id=\\"20\\" scanned_id=\\"7\\" estimated_cardinality=\\"10028\\" exact_cardinality=\\"13112\\" /></Select></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "31.sql",
    "queryText": "with ss as\\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\\n from store_sales,date_dim,customer_address\\n where ss_sold_date_sk = d_date_sk\\n  and ss_addr_sk=ca_address_sk\\n group by ca_county,d_qoy, d_year),\\n ws as\\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\\n from web_sales,date_dim,customer_address\\n where ws_sold_date_sk = d_date_sk\\n  and ws_bill_addr_sk=ca_address_sk\\n group by ca_county,d_qoy, d_year)\\n select \\n        ss1.ca_county\\n       ,ss1.d_year\\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\\n from\\n        ss ss1\\n       ,ss ss2\\n       ,ss ss3\\n       ,ws ws1\\n       ,ws ws2\\n       ,ws ws3\\n where\\n    ss1.d_qoy = 1\\n    and ss1.d_year = 2000\\n    and ss1.ca_county = ss2.ca_county\\n    and ss2.d_qoy = 2\\n    and ss2.d_year = 2000\\n and ss2.ca_county = ss3.ca_county\\n    and ss3.d_qoy = 3\\n    and ss3.d_year = 2000\\n    and ss1.ca_county = ws1.ca_county\\n    and ws1.d_qoy = 1\\n    and ws1.d_year = 2000\\n    and ws1.ca_county = ws2.ca_county\\n    and ws2.d_qoy = 2\\n    and ws2.d_year = 2000\\n    and ws1.ca_county = ws3.ca_county\\n    and ws3.d_qoy = 3\\n    and ws3.d_year =2000\\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\\n order by store_q2_q3_increase;",
    "benchmarkResult": {
      "total": 16.73734,
      "compilation": 3.8032399999999997,
      "execution": 12.9341,
      "scale": 3845887.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"51\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"51\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"51\\"><Select operator_id=\\"4\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1808\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"5149\\"><GroupBy operator_id=\\"6\\" mode=\\"regular\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"5149\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"641714\\" exact_cardinality=\\"295234\\"><TableScan operator_id=\\"8\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48486\\" exact_cardinality=\\"48536\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"661751\\" exact_cardinality=\\"303821\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685273\\" /></Join></Join></GroupBy></PipelineBreakerScan></Select><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"181\\"><Select operator_id=\\"13\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1628\\"><EarlyProbe operator_id=\\"14\\" source=\\"3\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"5092\\"><PipelineBreakerScan operator_id=\\"15\\" scanned_id=\\"6\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"5149\\" /></EarlyProbe></Select><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"354\\"><Select operator_id=\\"17\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1503\\"><EarlyProbe operator_id=\\"18\\" source=\\"12\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"4759\\"><PipelineBreakerScan operator_id=\\"19\\" scanned_id=\\"6\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"5149\\" /></EarlyProbe></Select><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"389\\"><Select operator_id=\\"21\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"934\\"><PipelineBreakerScan operator_id=\\"22\\" scanned_id=\\"23\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"3135\\"><GroupBy operator_id=\\"23\\" mode=\\"regular\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"3135\\"><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"128109\\" exact_cardinality=\\"77787\\"><TableScan operator_id=\\"25\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48486\\" exact_cardinality=\\"48536\\" /><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"132110\\" exact_cardinality=\\"80071\\"><TableScan operator_id=\\"27\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"28\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719118\\" /></Join></Join></GroupBy></PipelineBreakerScan></Select><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"668\\"><Select operator_id=\\"30\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1260\\"><PipelineBreakerScan operator_id=\\"31\\" scanned_id=\\"23\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"3135\\" /></Select><Select operator_id=\\"32\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"941\\"><PipelineBreakerScan operator_id=\\"33\\" scanned_id=\\"23\\" estimated_cardinality=\\"3631\\" exact_cardinality=\\"3135\\" /></Select></Join></Join></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "32.sql",
    "queryText": "select  sum(cs_ext_discount_amt)  as \\"excess discount amount\\" \\nfrom \\n   catalog_sales \\n   ,item \\n   ,date_dim\\nwhere\\ni_manufact_id = 994\\nand i_item_sk = cs_item_sk \\nand d_date between '2001-03-14' and \\n        (cast('2001-03-14' as date) + interval '90 days')\\nand d_date_sk = cs_sold_date_sk \\nand cs_ext_discount_amt  \\n     > ( \\n         select \\n            1.3 * avg(cs_ext_discount_amt) \\n         from \\n            catalog_sales \\n           ,date_dim\\n         where \\n              cs_item_sk = i_item_sk \\n          and d_date between '2001-03-14' and\\n                             (cast('2001-03-14' as date) + interval '90 days')\\n          and d_date_sk = cs_sold_date_sk \\n      ) \\nlimit 100;",
    "benchmarkResult": {
      "total": 5.44881,
      "compilation": 2.09726,
      "execution": 3.35155,
      "scale": 3047195.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><TableScan operator_id=\\"3\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"91\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"92\\" exact_cardinality=\\"152\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"17\\" exact_cardinality=\\"3\\" /><Select operator_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"7\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"91\\" /><EarlyProbe operator_id=\\"11\\" source=\\"5\\" estimated_cardinality=\\"1420\\" exact_cardinality=\\"353\\"><TableScan operator_id=\\"12\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></EarlyProbe></Join></GroupBy></Select></Join><TableScan operator_id=\\"13\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1427470.0\\" exact_cardinality=\\"1427470.0\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "33.sql",
    "queryText": "with ss as (\\n select\\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_manufact_id),\\n cs as (\\n select\\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id               in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_manufact_id),\\n ws as (\\n select\\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_manufact_id               in (select\\n  i_manufact_id\\nfrom\\n item\\nwhere i_category in ('Jewelry'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2000\\n and     d_moy                   = 6\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6\\n group by i_manufact_id)\\n  select  i_manufact_id ,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_manufact_id\\n order by total_sales\\nlimit 100;",
    "benchmarkResult": {
      "total": 15.27205,
      "compilation": 3.31895,
      "execution": 11.9531,
      "scale": 5446484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"2351\\" exact_cardinality=\\"721\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"2613\\" exact_cardinality=\\"2043\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"871\\" exact_cardinality=\\"719\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"105541\\" exact_cardinality=\\"9886\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"16413\\" exact_cardinality=\\"15522\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"16413\\" exact_cardinality=\\"15522\\"><Join operator_id=\\"8\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"16413\\" exact_cardinality=\\"15522\\"><TableScan operator_id=\\"9\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1705\\" exact_cardinality=\\"1740\\" /><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></Temp></PipelineBreakerScan><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"110085\\" exact_cardinality=\\"11482\\"><TableScan operator_id=\\"12\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"262771\\" exact_cardinality=\\"26012\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685273\\" /></Join></Join></Join></GroupBy><GroupBy operator_id=\\"16\\" mode=\\"regular\\" estimated_cardinality=\\"871\\" exact_cardinality=\\"630\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"20974\\" exact_cardinality=\\"2441\\"><PipelineBreakerScan operator_id=\\"18\\" scanned_id=\\"7\\" estimated_cardinality=\\"16413\\" exact_cardinality=\\"15522\\" /><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"21877\\" exact_cardinality=\\"2820\\"><TableScan operator_id=\\"20\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"52221\\" exact_cardinality=\\"6423\\"><TableScan operator_id=\\"22\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"23\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719118\\" /></Join></Join></Join></GroupBy><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"871\\" exact_cardinality=\\"694\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"49230\\" exact_cardinality=\\"5249\\"><PipelineBreakerScan operator_id=\\"26\\" scanned_id=\\"7\\" estimated_cardinality=\\"16413\\" exact_cardinality=\\"15522\\" /><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"51350\\" exact_cardinality=\\"6049\\"><TableScan operator_id=\\"28\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"122570\\" exact_cardinality=\\"13727\\"><TableScan operator_id=\\"30\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"31\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1424654\\" exact_cardinality=\\"1430852\\" /></Join></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "34.sql",
    "queryText": "select c_last_name\\n       ,c_first_name\\n       ,c_salutation\\n       ,c_preferred_cust_flag\\n       ,ss_ticket_number\\n       ,cnt from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,count(*) cnt\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\\n    and (household_demographics.hd_buy_potential = '>10000' or\\n         household_demographics.hd_buy_potential = '0-500')\\n    and household_demographics.hd_vehicle_count > 0\\n    and (case when household_demographics.hd_vehicle_count > 0 \\n\\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \\n\\telse null \\n\\tend)  > 1.2\\n    and date_dim.d_year in (2000,2000+1,2000+2)\\n    and store.s_county in ('Ziebach County','Williamson County','Walker County','Ziebach County',\\n                           'Ziebach County','Ziebach County','Ziebach County','Ziebach County')\\n    group by ss_ticket_number,ss_customer_sk) dn,customer\\n    where ss_customer_sk = c_customer_sk\\n      and cnt between 15 and 20\\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number;",
    "benchmarkResult": {
      "total": 10.14265,
      "compilation": 2.74584,
      "execution": 7.39681,
      "scale": 3060666.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"353\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"353\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"353\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"353\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"73893\\" exact_cardinality=\\"3735\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"82103\\" exact_cardinality=\\"40866\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"82103\\" exact_cardinality=\\"40866\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"252\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"312161\\" exact_cardinality=\\"294323\\"><TableScan operator_id=\\"10\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"815\\" exact_cardinality=\\"800\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2655372\\" exact_cardinality=\\"2636740.0\\" /></Join></Join></Join></GroupBy></Select><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "35.sql",
    "queryText": "select   \\n  ca_state,\\n  cd_gender,\\n  cd_marital_status,\\n  cd_dep_count,\\n  count(*) cnt1,\\n  sum(cd_dep_count),\\n  min(cd_dep_count),\\n  stddev_samp(cd_dep_count),\\n  cd_dep_employed_count,\\n  count(*) cnt2,\\n  sum(cd_dep_employed_count),\\n  min(cd_dep_employed_count),\\n  stddev_samp(cd_dep_employed_count),\\n  cd_dep_college_count,\\n  count(*) cnt3,\\n  sum(cd_dep_college_count),\\n  min(cd_dep_college_count),\\n  stddev_samp(cd_dep_college_count)\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 1999 and\\n                d_qoy < 4) and\\n   (exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 1999 and\\n                  d_qoy < 4) or \\n    exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 1999 and\\n                  d_qoy < 4))\\n group by ca_state,\\n          cd_gender,\\n          cd_marital_status,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n order by ca_state,\\n          cd_gender,\\n          cd_marital_status,\\n          cd_dep_count,\\n          cd_dep_employed_count,\\n          cd_dep_college_count\\n limit 100;",
    "benchmarkResult": {
      "total": 24.90803,
      "compilation": 3.1790299999999996,
      "execution": 21.729,
      "scale": 7331284.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"241\\" exact_cardinality=\\"4741\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"25715\\" exact_cardinality=\\"4846\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"25715\\" exact_cardinality=\\"4846\\"><Join operator_id=\\"6\\" type=\\"rightmark\\" method=\\"hash\\" estimated_cardinality=\\"57577\\" exact_cardinality=\\"22601\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50130\\" exact_cardinality=\\"159334\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"9\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join><Join operator_id=\\"10\\" type=\\"rightmark\\" method=\\"hash\\" estimated_cardinality=\\"57577\\" exact_cardinality=\\"22601\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"27701\\" exact_cardinality=\\"79635\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"13\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join><Join operator_id=\\"14\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"57577\\" exact_cardinality=\\"22601\\"><TableScan operator_id=\\"15\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"95703\\" exact_cardinality=\\"96562\\" /><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"100963\\" exact_cardinality=\\"305898\\"><TableScan operator_id=\\"17\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"274\\" /><TableScan operator_id=\\"18\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></Join></Join><TableScan operator_id=\\"19\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join><TableScan operator_id=\\"20\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "36.sql",
    "queryText": "select  \\n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\\n   ,i_category\\n   ,i_class\\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(i_category)+grouping(i_class),\\n \\tcase when grouping(i_class) = 0 then i_category end \\n \\torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\\n from\\n    store_sales\\n   ,date_dim       d1\\n   ,item\\n   ,store\\n where\\n    d1.d_year = 1998 \\n and d1.d_date_sk = ss_sold_date_sk\\n and i_item_sk  = ss_item_sk \\n and s_store_sk  = ss_store_sk\\n and s_state in ('TN','AL','SD','AL',\\n                 'SD','SD','SD','SD')\\n group by rollup(i_category,i_class)\\n order by\\n   lochierarchy desc\\n  ,case when lochierarchy = 0 then i_category end\\n  ,rank_within_parent\\n  limit 100;",
    "benchmarkResult": {
      "total": 16.402810000000002,
      "compilation": 2.88851,
      "execution": 13.5143,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"119\\" exact_cardinality=\\"136\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"119\\" exact_cardinality=\\"136\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"382757\\" exact_cardinality=\\"537716\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"364027\\" exact_cardinality=\\"537716\\"><TableScan operator_id=\\"8\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"364027\\" exact_cardinality=\\"537716\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "37.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,i_current_price\\n from item, inventory, date_dim, catalog_sales\\n where i_current_price between 58 and 58 + 30\\n and inv_item_sk = i_item_sk\\n and d_date_sk=inv_date_sk\\n and d_date between cast('2002-02-18' as date) and (cast('2002-02-18' as date) +  interval '60 days')\\n and i_manufact_id in (832,757,736,999)\\n and inv_quantity_on_hand between 100 and 500\\n and cs_item_sk = i_item_sk\\n group by i_item_id,i_item_desc,i_current_price\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 12.58589,
      "compilation": 2.25279,
      "execution": 10.3331,
      "scale": 13277598.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"37476\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"445\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"5\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"61\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3507\\" exact_cardinality=\\"388\\"><TableScan operator_id=\\"7\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"2\\" /><TableScan operator_id=\\"8\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"4656708\\" exact_cardinality=\\"4469511\\" /></Join></Join><TableScan operator_id=\\"9\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1441548\\" exact_cardinality=\\"1441548\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "38.sql",
    "queryText": "select  count(*) from (\\n    select distinct c_last_name, c_first_name, d_date\\n    from store_sales, date_dim, customer\\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n      and store_sales.ss_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n  intersect\\n    select distinct c_last_name, c_first_name, d_date\\n    from catalog_sales, date_dim, customer\\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n  intersect\\n    select distinct c_last_name, c_first_name, d_date\\n    from web_sales, date_dim, customer\\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\\n      and d_month_seq between 1179 and 1179 + 11\\n) hot_cust\\nlimit 100;",
    "benchmarkResult": {
      "total": 28.69057,
      "compilation": 2.47747,
      "execution": 26.2131,
      "scale": 5560484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><SetOperation operator_id=\\"2\\" type=\\"intersect\\" estimated_cardinality=\\"84272\\" exact_cardinality=\\"115\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"93635\\" exact_cardinality=\\"144292\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"89947\\" exact_cardinality=\\"144292\\"><TableScan operator_id=\\"5\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"6\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join><TableScan operator_id=\\"7\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"159280\\" exact_cardinality=\\"285120\\"><TableScan operator_id=\\"9\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"153006\\" exact_cardinality=\\"285120\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"12\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"335914\\" exact_cardinality=\\"543189\\"><TableScan operator_id=\\"14\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"322683\\" exact_cardinality=\\"543189\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"17\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></Join></SetOperation></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "39a.sql",
    "queryText": "with inv as\\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\\n      from inventory\\n          ,item\\n          ,warehouse\\n          ,date_dim\\n      where inv_item_sk = i_item_sk\\n        and inv_warehouse_sk = w_warehouse_sk\\n        and inv_date_sk = d_date_sk\\n        and d_year =1998\\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\\n where case mean when 0 then 0 else stdev/mean end > 1)\\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\\nfrom inv inv1,inv inv2\\nwhere inv1.i_item_sk = inv2.i_item_sk\\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\\n  and inv1.d_moy=4\\n  and inv2.d_moy=4+1\\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\\n        ,inv2.d_moy,inv2.mean, inv2.cov\\n;",
    "benchmarkResult": {
      "total": 32.30727,
      "compilation": 2.5935699999999997,
      "execution": 29.7137,
      "scale": 11836055.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"146\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"146\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"146\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1325\\" exact_cardinality=\\"3193\\"><PipelineBreakerScan operator_id=\\"4\\" scanned_id=\\"5\\" estimated_cardinality=\\"71370\\" exact_cardinality=\\"5353\\"><Temp operator_id=\\"5\\" estimated_cardinality=\\"71370\\" exact_cardinality=\\"5353\\"><Select operator_id=\\"7\\" estimated_cardinality=\\"71370\\" exact_cardinality=\\"5353\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"142739\\" exact_cardinality=\\"90000\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"281593\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"267814\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"12\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"279175\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><TableScan operator_id=\\"15\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"11745000.0\\" exact_cardinality=\\"11745000.0\\" /></Join></Join></Join></GroupBy></Select></Temp></PipelineBreakerScan></Select><Select operator_id=\\"16\\" estimated_cardinality=\\"1369\\" exact_cardinality=\\"2160\\"><PipelineBreakerScan operator_id=\\"17\\" scanned_id=\\"5\\" estimated_cardinality=\\"71370\\" exact_cardinality=\\"5353\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "39b.sql",
    "queryText": "with inv as\\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\\n      from inventory\\n          ,item\\n          ,warehouse\\n          ,date_dim\\n      where inv_item_sk = i_item_sk\\n        and inv_warehouse_sk = w_warehouse_sk\\n        and inv_date_sk = d_date_sk\\n        and d_year =1998\\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\\n where case mean when 0 then 0 else stdev/mean end > 1)\\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\\nfrom inv inv1,inv inv2\\nwhere inv1.i_item_sk = inv2.i_item_sk\\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\\n  and inv1.d_moy=4\\n  and inv2.d_moy=4+1\\n  and inv1.cov > 1.5\\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\\n        ,inv2.d_moy,inv2.mean, inv2.cov\\n;",
    "benchmarkResult": {
      "total": 28.916969999999996,
      "compilation": 2.55877,
      "execution": 26.358199999999997,
      "scale": 11836055.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"47\\" exact_cardinality=\\"7\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"47\\" exact_cardinality=\\"7\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"47\\" exact_cardinality=\\"7\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1007\\" exact_cardinality=\\"56\\"><PipelineBreakerScan operator_id=\\"4\\" scanned_id=\\"5\\" estimated_cardinality=\\"1829\\" exact_cardinality=\\"3249\\"><Temp operator_id=\\"5\\" estimated_cardinality=\\"1829\\" exact_cardinality=\\"3249\\"><Select operator_id=\\"6\\" estimated_cardinality=\\"1829\\" exact_cardinality=\\"3249\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"71370\\" exact_cardinality=\\"5353\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"142739\\" exact_cardinality=\\"90000\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"281593\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"11\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"267814\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"13\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"279175\\" exact_cardinality=\\"405000\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><TableScan operator_id=\\"16\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"11745000.0\\" exact_cardinality=\\"11745000.0\\" /></Join></Join></Join></GroupBy></Select></Select></Temp></PipelineBreakerScan></Select><Select operator_id=\\"17\\" estimated_cardinality=\\"1325\\" exact_cardinality=\\"3193\\"><PipelineBreakerScan operator_id=\\"18\\" scanned_id=\\"5\\" estimated_cardinality=\\"1829\\" exact_cardinality=\\"3249\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "40.sql",
    "queryText": "select  \\n   w_state\\n  ,i_item_id\\n  ,sum(case when (cast(d_date as date) < cast ('1999-04-25' as date)) \\n \\t\\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\\n  ,sum(case when (cast(d_date as date) >= cast ('1999-04-25' as date)) \\n \\t\\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\\n from\\n   catalog_sales left outer join catalog_returns on\\n       (cs_order_number = cr_order_number \\n        and cs_item_sk = cr_item_sk)\\n  ,warehouse \\n  ,item\\n  ,date_dim\\n where\\n     i_current_price between 0.99 and 1.49\\n and i_item_sk          = cs_item_sk\\n and cs_warehouse_sk    = w_warehouse_sk \\n and cs_sold_date_sk    = d_date_sk\\n and d_date between (cast ('1999-04-25' as date) - interval '30 days')\\n                and (cast ('1999-04-25' as date) + interval '30 days') \\n group by\\n    w_state,i_item_id\\n order by w_state,i_item_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.1849,
      "compilation": 2.52975,
      "execution": 4.65515,
      "scale": 1676670.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"58\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"58\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"58\\" exact_cardinality=\\"523\\"><Join operator_id=\\"3\\" type=\\"leftouter\\" method=\\"indexnl\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"1712\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"1712\\"><TableScan operator_id=\\"5\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"1712\\"><TableScan operator_id=\\"7\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1072\\" exact_cardinality=\\"1104\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1022\\" exact_cardinality=\\"27760\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><TableScan operator_id=\\"10\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1430791\\" /></Join></Join></Join><TableScan operator_id=\\"11\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "41.sql",
    "queryText": "select  distinct(i_product_name)\\n from item i1\\n where i_manufact_id between 739 and 739+40 \\n   and (select count(*) as item_cnt\\n        from item\\n        where (i_manufact = i1.i_manufact and\\n        ((i_category = 'Women' and \\n        (i_color = 'mint' or i_color = 'almond') and \\n        (i_units = 'Dozen' or i_units = 'Carton') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ) or\\n        (i_category = 'Women' and\\n        (i_color = 'lime' or i_color = 'dodger') and\\n        (i_units = 'Pallet' or i_units = 'Ounce') and\\n        (i_size = 'economy' or i_size = 'medium')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'salmon' or i_color = 'navy') and\\n        (i_units = 'Bunch' or i_units = 'Oz') and\\n        (i_size = 'N/A' or i_size = 'small')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'antique' or i_color = 'white') and\\n        (i_units = 'Unknown' or i_units = 'Tbl') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ))) or\\n       (i_manufact = i1.i_manufact and\\n        ((i_category = 'Women' and \\n        (i_color = 'dim' or i_color = 'chiffon') and \\n        (i_units = 'Box' or i_units = 'N/A') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        ) or\\n        (i_category = 'Women' and\\n        (i_color = 'lemon' or i_color = 'rosy') and\\n        (i_units = 'Tsp' or i_units = 'Dram') and\\n        (i_size = 'economy' or i_size = 'medium')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'deep' or i_color = 'smoke') and\\n        (i_units = 'Gram' or i_units = 'Pound') and\\n        (i_size = 'N/A' or i_size = 'small')\\n        ) or\\n        (i_category = 'Men' and\\n        (i_color = 'metallic' or i_color = 'olive') and\\n        (i_units = 'Lb' or i_units = 'Case') and\\n        (i_size = 'large' or i_size = 'extra large')\\n        )))) > 0\\n order by i_product_name\\n limit 100;",
    "benchmarkResult": {
      "total": 4.184670000000001,
      "compilation": 2.2504500000000003,
      "execution": 1.93422,
      "scale": 36001.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"7\\" mode=\\"regular\\" estimated_cardinality=\\"95\\" exact_cardinality=\\"68\\" /><TableScan operator_id=\\"3\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"105\\" exact_cardinality=\\"239\\" /><Select operator_id=\\"4\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupJoin operator_id=\\"5\\" type=\\"static\\" method=\\"eagerright\\" estimated_cardinality=\\"95\\" exact_cardinality=\\"68\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"95\\" exact_cardinality=\\"68\\" /><TableScan operator_id=\\"8\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"2\\" /></GroupJoin></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "42.sql",
    "queryText": "select  dt.d_year\\n \\t,item.i_category_id\\n \\t,item.i_category\\n \\t,sum(ss_ext_sales_price)\\n from \\tdate_dim dt\\n \\t,store_sales\\n \\t,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n \\tand store_sales.ss_item_sk = item.i_item_sk\\n \\tand item.i_manager_id = 1  \\t\\n \\tand dt.d_moy=12\\n \\tand dt.d_year=1999\\n group by \\tdt.d_year\\n \\t\\t,item.i_category_id\\n \\t\\t,item.i_category\\n order by       sum(ss_ext_sales_price) desc,dt.d_year\\n \\t\\t,item.i_category_id\\n \\t\\t,item.i_category\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 6.639760000000001,
      "compilation": 1.8693600000000001,
      "execution": 4.7704,
      "scale": 2971454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"10\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"10\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"10\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1368\\" exact_cardinality=\\"1636\\"><TableScan operator_id=\\"4\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"53403\\" exact_cardinality=\\"47792\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"321\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "43.sql",
    "queryText": "select  s_store_name, s_store_id,\\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\\n from date_dim, store_sales, store\\n where d_date_sk = ss_sold_date_sk and\\n       s_store_sk = ss_store_sk and\\n       s_gmt_offset = -6 and\\n       d_year = 2000 \\n group by s_store_name, s_store_id\\n order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales\\n limit 100;",
    "benchmarkResult": {
      "total": 5.5708400000000005,
      "compilation": 2.11317,
      "execution": 3.45767,
      "scale": 2953454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"54097\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"4\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"366\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"224563\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"6\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"7\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><TableScan operator_id=\\"8\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "44.sql",
    "queryText": "select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\\nfrom(select *\\n     from (select item_sk,rank() over (order by rank_col asc) rnk\\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \\n                 from store_sales ss1\\n                 where ss_store_sk = 29\\n                 group by ss_item_sk\\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\\n                                                  from store_sales\\n                                                  where ss_store_sk = 29\\n                                                    and ss_cdemo_sk is null\\n                                                  group by ss_store_sk))V1)V11\\n     where rnk  < 11) asceding,\\n    (select *\\n     from (select item_sk,rank() over (order by rank_col desc) rnk\\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\\n                 from store_sales ss1\\n                 where ss_store_sk = 29\\n                 group by ss_item_sk\\n                 having avg(ss_net_profit) > 0.9*(select avg(ss_net_profit) rank_col\\n                                                  from store_sales\\n                                                  where ss_store_sk = 29\\n                                                    and ss_cdemo_sk is null\\n                                                  group by ss_store_sk))V2)V21\\n     where rnk  < 11) descending,\\nitem i1,\\nitem i2\\nwhere asceding.rnk = descending.rnk \\n  and i1.i_item_sk=asceding.item_sk\\n  and i2.i_item_sk=descending.item_sk\\norder by asceding.rnk\\nlimit 100;",
    "benchmarkResult": {
      "total": 6.1548099999999994,
      "compilation": 2.5469999999999997,
      "execution": 3.6078099999999997,
      "scale": 5796809.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"25743\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"507\\" exact_cardinality=\\"0\\"><Select operator_id=\\"4\\" estimated_cardinality=\\"483\\" exact_cardinality=\\"0\\"><Window operator_id=\\"5\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\"><Select operator_id=\\"9\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"10\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"1015\\" exact_cardinality=\\"0\\" /></GroupBy></Select><Select operator_id=\\"12\\" estimated_cardinality=\\"1754\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"13\\" mode=\\"regular\\" estimated_cardinality=\\"1755\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"1950\\" exact_cardinality=\\"0\\" /></GroupBy></Select></Join></Temp></PipelineBreakerScan></Window></Select><TableScan operator_id=\\"15\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"507\\" exact_cardinality=\\"0\\"><Select operator_id=\\"17\\" estimated_cardinality=\\"483\\" exact_cardinality=\\"0\\"><Window operator_id=\\"18\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\"><PipelineBreakerScan operator_id=\\"19\\" scanned_id=\\"7\\" estimated_cardinality=\\"965\\" exact_cardinality=\\"0\\" /></Window></Select><TableScan operator_id=\\"20\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "45.sql",
    "queryText": "select  ca_zip, ca_city, sum(ws_sales_price)\\n from web_sales, customer, customer_address, date_dim, item\\n where ws_bill_customer_sk = c_customer_sk\\n \\tand c_current_addr_sk = ca_address_sk \\n \\tand ws_item_sk = i_item_sk \\n \\tand ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\\n \\t      or \\n \\t      i_item_id in (select i_item_id\\n                             from item\\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\\n                             )\\n \\t    )\\n \\tand ws_sold_date_sk = d_date_sk\\n \\tand d_qoy = 2 and d_year = 2001\\n group by ca_zip, ca_city\\n order by ca_zip, ca_city\\n limit 100;",
    "benchmarkResult": {
      "total": 7.419460000000001,
      "compilation": 2.7475300000000002,
      "execution": 4.671930000000001,
      "scale": 978434.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"19\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"19\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"9512\\" exact_cardinality=\\"19\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"14153\\" exact_cardinality=\\"19\\"><Join operator_id=\\"4\\" type=\\"rightmark\\" method=\\"hash\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\"><TableScan operator_id=\\"5\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"10\\" /><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"13460\\" exact_cardinality=\\"21362\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"13460\\" exact_cardinality=\\"21362\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12930\\" exact_cardinality=\\"21362\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"91\\" /><EarlyProbe operator_id=\\"11\\" source=\\"3\\" estimated_cardinality=\\"503494\\" exact_cardinality=\\"719119\\"><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></EarlyProbe></Join><TableScan operator_id=\\"13\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "46.sql",
    "queryText": "select  c_last_name\\n       ,c_first_name\\n       ,ca_city\\n       ,bought_city\\n       ,ss_ticket_number\\n       ,amt,profit \\n from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,ca_city bought_city\\n          ,sum(ss_coupon_amt) amt\\n          ,sum(ss_net_profit) profit\\n    from store_sales,date_dim,store,household_demographics,customer_address \\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\\n    and (household_demographics.hd_dep_count = 8 or\\n         household_demographics.hd_vehicle_count= 4)\\n    and date_dim.d_dow in (6,0)\\n    and date_dim.d_year in (1999,1999+1,1999+2) \\n    and store.s_city in ('Five Points','Riverside','Fairview','Midway','Pleasant Hill') \\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\\n    where ss_customer_sk = c_customer_sk\\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\\n      and current_addr.ca_city <> bought_city\\n  order by c_last_name\\n          ,c_first_name\\n          ,ca_city\\n          ,bought_city\\n          ,ss_ticket_number\\n  limit 100;",
    "benchmarkResult": {
      "total": 23.359569999999998,
      "compilation": 2.97497,
      "execution": 20.3846,
      "scale": 3160666.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"100214\\" exact_cardinality=\\"9580\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"96484\\" exact_cardinality=\\"96940\\"><TableScan operator_id=\\"4\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48242\\" exact_cardinality=\\"48481\\" /><TableScan operator_id=\\"5\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><GroupBy operator_id=\\"6\\" mode=\\"regular\\" estimated_cardinality=\\"99774\\" exact_cardinality=\\"9651\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"110860\\" exact_cardinality=\\"105971\\"><TableScan operator_id=\\"8\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"110860\\" exact_cardinality=\\"105971\\"><TableScan operator_id=\\"10\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48242\\" exact_cardinality=\\"48481\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"114900\\" exact_cardinality=\\"109162\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"314\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"449388\\" exact_cardinality=\\"639653\\"><TableScan operator_id=\\"14\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1771\\" exact_cardinality=\\"1800\\" /><EarlyProbe operator_id=\\"15\\" source=\\"2\\" estimated_cardinality=\\"1809810.0\\" exact_cardinality=\\"2550022\\"><TableScan operator_id=\\"16\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2646933\\" exact_cardinality=\\"2628655\\" /></EarlyProbe></Join></Join></Join></Join></GroupBy></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "47.sql",
    "queryText": "with v1 as(\\n select i_category, i_brand,\\n        s_store_name, s_company_name,\\n        d_year, d_moy,\\n        sum(ss_sales_price) sum_sales,\\n        avg(sum(ss_sales_price)) over\\n          (partition by i_category, i_brand,\\n                     s_store_name, s_company_name, d_year)\\n          avg_monthly_sales,\\n        rank() over\\n          (partition by i_category, i_brand,\\n                     s_store_name, s_company_name\\n           order by d_year, d_moy) rn\\n from item, store_sales, date_dim, store\\n where ss_item_sk = i_item_sk and\\n       ss_sold_date_sk = d_date_sk and\\n       ss_store_sk = s_store_sk and\\n       (\\n         d_year = 2001 or\\n         ( d_year = 2001-1 and d_moy =12) or\\n         ( d_year = 2001+1 and d_moy =1)\\n       )\\n group by i_category, i_brand,\\n          s_store_name, s_company_name,\\n          d_year, d_moy),\\n v2 as(\\n select v1.s_store_name, v1.s_company_name\\n        ,v1.d_year\\n        ,v1.avg_monthly_sales\\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\\n from v1, v1 v1_lag, v1 v1_lead\\n where v1.i_category = v1_lag.i_category and\\n       v1.i_category = v1_lead.i_category and\\n       v1.i_brand = v1_lag.i_brand and\\n       v1.i_brand = v1_lead.i_brand and\\n       v1.s_store_name = v1_lag.s_store_name and\\n       v1.s_store_name = v1_lead.s_store_name and\\n       v1.s_company_name = v1_lag.s_company_name and\\n       v1.s_company_name = v1_lead.s_company_name and\\n       v1.rn = v1_lag.rn + 1 and\\n       v1.rn = v1_lead.rn - 1)\\n  select  *\\n from v2\\n where  d_year = 2001 and    \\n        avg_monthly_sales > 0 and\\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\n order by sum_sales - avg_monthly_sales, 3\\n limit 100;",
    "benchmarkResult": {
      "total": 90.98985,
      "compilation": 5.063350000000001,
      "execution": 85.9265,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18\\" exact_cardinality=\\"35512\\"><PipelineBreakerScan operator_id=\\"3\\" scanned_id=\\"4\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><Temp operator_id=\\"4\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\"><Window operator_id=\\"9\\" estimated_cardinality=\\"350924\\" exact_cardinality=\\"50384\\"><GroupBy operator_id=\\"10\\" mode=\\"regular\\" estimated_cardinality=\\"350924\\" exact_cardinality=\\"50384\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"579372\\" exact_cardinality=\\"656497\\"><TableScan operator_id=\\"12\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"551021\\" exact_cardinality=\\"656497\\"><TableScan operator_id=\\"14\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"551021\\" exact_cardinality=\\"656497\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"427\\" /><TableScan operator_id=\\"17\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Select></Temp></PipelineBreakerScan></Select></Temp></PipelineBreakerScan><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1848\\" exact_cardinality=\\"35519\\"><Select operator_id=\\"18\\" estimated_cardinality=\\"1360\\" exact_cardinality=\\"35789\\"><EarlyProbe operator_id=\\"20\\" source=\\"2\\" estimated_cardinality=\\"1990\\" exact_cardinality=\\"44037\\"><PipelineBreakerScan operator_id=\\"21\\" scanned_id=\\"7\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\" /></EarlyProbe></Select><PipelineBreakerScan operator_id=\\"22\\" scanned_id=\\"4\\" estimated_cardinality=\\"2508\\" exact_cardinality=\\"49446\\" /></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "48.sql",
    "queryText": "select sum (ss_quantity)\\n from store_sales, store, customer_demographics, customer_address, date_dim\\n where s_store_sk = ss_store_sk\\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\\n and  \\n (\\n  (\\n   cd_demo_sk = ss_cdemo_sk\\n   and \\n   cd_marital_status = 'W'\\n   and \\n   cd_education_status = 'Unknown'\\n   and \\n   ss_sales_price between 100.00 and 150.00  \\n   )\\n or\\n  (\\n  cd_demo_sk = ss_cdemo_sk\\n   and \\n   cd_marital_status = 'S'\\n   and \\n   cd_education_status = 'Primary'\\n   and \\n   ss_sales_price between 50.00 and 100.00   \\n  )\\n or \\n (\\n  cd_demo_sk = ss_cdemo_sk\\n  and \\n   cd_marital_status = 'D'\\n   and \\n   cd_education_status = '4 yr Degree'\\n   and \\n   ss_sales_price between 150.00 and 200.00  \\n )\\n )\\n and\\n (\\n  (\\n  ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('WA', 'NC', 'SD')\\n  and ss_net_profit between 0 and 2000  \\n  )\\n or\\n  (ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('WI', 'TN', 'MN')\\n  and ss_net_profit between 150 and 3000 \\n  )\\n or\\n  (ss_addr_sk = ca_address_sk\\n  and\\n  ca_country = 'United States'\\n  and\\n  ca_state in ('IL', 'OH', 'NE')\\n  and ss_net_profit between 50 and 25000 \\n  )\\n )\\n;",
    "benchmarkResult": {
      "total": 23.10269,
      "compilation": 2.21319,
      "execution": 20.889499999999998,
      "scale": 4924266.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"112\\" exact_cardinality=\\"441\\"><TableScan operator_id=\\"3\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"112\\" exact_cardinality=\\"441\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"688\\" exact_cardinality=\\"2348\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"14335\\" exact_cardinality=\\"83993\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"365\\" /><EarlyProbe operator_id=\\"8\\" source=\\"2\\" estimated_cardinality=\\"352696\\" exact_cardinality=\\"422604\\"><TableScan operator_id=\\"9\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"497882\\" exact_cardinality=\\"422604\\" /></EarlyProbe></Join><TableScan operator_id=\\"10\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"144435\\" exact_cardinality=\\"144435\\" /></Join><TableScan operator_id=\\"11\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"10986\\" exact_cardinality=\\"10986\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "49.sql",
    "queryText": "select  channel, item, return_ratio, return_rank, currency_rank from\\n (select\\n 'web' as channel\\n ,web.item\\n ,web.return_ratio\\n ,web.return_rank\\n ,web.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect ws.ws_item_sk as item\\n \\t\\t,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\t web_sales ws left outer join web_returns wr \\n \\t\\t\\ton (ws.ws_order_number = wr.wr_order_number and \\n \\t\\t\\tws.ws_item_sk = wr.wr_item_sk)\\n                 ,date_dim\\n \\t\\twhere \\n \\t\\t\\twr.wr_return_amt > 10000 \\n \\t\\t\\tand ws.ws_net_profit > 1\\n                         and ws.ws_net_paid > 0\\n                         and ws.ws_quantity > 0\\n                         and ws_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n \\t\\tgroup by ws.ws_item_sk\\n \\t) in_web\\n ) web\\n where \\n (\\n web.return_rank <= 10\\n or\\n web.currency_rank <= 10\\n )\\n union\\n select \\n 'catalog' as channel\\n ,catalog.item\\n ,catalog.return_ratio\\n ,catalog.return_rank\\n ,catalog.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect \\n \\t\\tcs.cs_item_sk as item\\n \\t\\t,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/\\n \\t\\tcast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\tcatalog_sales cs left outer join catalog_returns cr\\n \\t\\t\\ton (cs.cs_order_number = cr.cr_order_number and \\n \\t\\t\\tcs.cs_item_sk = cr.cr_item_sk)\\n                ,date_dim\\n \\t\\twhere \\n \\t\\t\\tcr.cr_return_amount > 10000 \\n \\t\\t\\tand cs.cs_net_profit > 1\\n                         and cs.cs_net_paid > 0\\n                         and cs.cs_quantity > 0\\n                         and cs_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n                 group by cs.cs_item_sk\\n \\t) in_cat\\n ) catalog\\n where \\n (\\n catalog.return_rank <= 10\\n or\\n catalog.currency_rank <=10\\n )\\n union\\n select \\n 'store' as channel\\n ,store.item\\n ,store.return_ratio\\n ,store.return_rank\\n ,store.currency_rank\\n from (\\n \\tselect \\n \\t item\\n \\t,return_ratio\\n \\t,currency_ratio\\n \\t,rank() over (order by return_ratio) as return_rank\\n \\t,rank() over (order by currency_ratio) as currency_rank\\n \\tfrom\\n \\t(\\tselect sts.ss_item_sk as item\\n \\t\\t,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio\\n \\t\\t,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio\\n \\t\\tfrom \\n \\t\\tstore_sales sts left outer join store_returns sr\\n \\t\\t\\ton (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)\\n                ,date_dim\\n \\t\\twhere \\n \\t\\t\\tsr.sr_return_amt > 10000 \\n \\t\\t\\tand sts.ss_net_profit > 1\\n                         and sts.ss_net_paid > 0 \\n                         and sts.ss_quantity > 0\\n                         and ss_sold_date_sk = d_date_sk\\n                         and d_year = 2002\\n                         and d_moy = 11\\n \\t\\tgroup by sts.ss_item_sk\\n \\t) in_store\\n ) store\\n where  (\\n store.return_rank <= 10\\n or \\n store.currency_rank <= 10\\n )\\n ) x\\n order by 1,4,5,2\\n limit 100;",
    "benchmarkResult": {
      "total": 22.24746,
      "compilation": 4.57806,
      "execution": 17.6694,
      "scale": 5763828.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"33\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"33\\"><SetOperation operator_id=\\"2\\" type=\\"union\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"33\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"10\\"><Window operator_id=\\"4\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"20\\"><GroupBy operator_id=\\"6\\" mode=\\"regular\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"20\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"20\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"184\\" exact_cardinality=\\"571\\"><TableScan operator_id=\\"10\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"490\\" exact_cardinality=\\"632\\" /><TableScan operator_id=\\"11\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"269769\\" exact_cardinality=\\"269769\\" /></Join></Join></GroupBy></Window></Select><Select operator_id=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"11\\"><Window operator_id=\\"13\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"16\\"><GroupBy operator_id=\\"15\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"16\\"><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"16\\"><TableScan operator_id=\\"17\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"52\\" exact_cardinality=\\"387\\"><TableScan operator_id=\\"19\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"195\\" exact_cardinality=\\"507\\" /><TableScan operator_id=\\"20\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"767920\\" exact_cardinality=\\"767920\\" /></Join></Join></GroupBy></Window></Select><Select operator_id=\\"21\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"12\\"><Window operator_id=\\"22\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"30\\"><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"30\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"30\\"><TableScan operator_id=\\"26\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"1082\\"><TableScan operator_id=\\"28\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"562\\" exact_cardinality=\\"1217\\" /><TableScan operator_id=\\"29\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"549027\\" exact_cardinality=\\"549027\\" /></Join></Join></GroupBy></Window></Select></SetOperation></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "50.sql",
    "queryText": "select  \\n   s_store_name\\n  ,s_company_id\\n  ,s_street_number\\n  ,s_street_name\\n  ,s_street_type\\n  ,s_suite_number\\n  ,s_city\\n  ,s_county\\n  ,s_state\\n  ,s_zip\\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   store_sales\\n  ,store_returns\\n  ,store\\n  ,date_dim d1\\n  ,date_dim d2\\nwhere\\n    d2.d_year = 1999\\nand d2.d_moy  = 9\\nand ss_ticket_number = sr_ticket_number\\nand ss_item_sk = sr_item_sk\\nand ss_sold_date_sk   = d1.d_date_sk\\nand sr_returned_date_sk   = d2.d_date_sk\\nand ss_customer_sk = sr_customer_sk\\nand ss_store_sk = s_store_sk\\ngroup by\\n   s_store_name\\n  ,s_company_id\\n  ,s_street_number\\n  ,s_street_name\\n  ,s_street_type\\n  ,s_suite_number\\n  ,s_city\\n  ,s_county\\n  ,s_state\\n  ,s_zip\\norder by s_store_name\\n        ,s_company_id\\n        ,s_street_number\\n        ,s_street_name\\n        ,s_street_type\\n        ,s_suite_number\\n        ,s_city\\n        ,s_county\\n        ,s_state\\n        ,s_zip\\nlimit 100;",
    "benchmarkResult": {
      "total": 18.049650000000003,
      "compilation": 4.593050000000001,
      "execution": 13.456600000000002,
      "scale": 3314029.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"6\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"6\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"6\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3312\\" exact_cardinality=\\"2342\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3127\\" exact_cardinality=\\"2342\\"><TableScan operator_id=\\"5\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3127\\" exact_cardinality=\\"2342\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6742\\" exact_cardinality=\\"3244\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><TableScan operator_id=\\"9\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"269263\\" exact_cardinality=\\"272517\\" /></Join><TableScan operator_id=\\"10\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2672249\\" exact_cardinality=\\"2672249\\" /></Join></Join><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "51.sql",
    "queryText": "WITH web_v1 as (\\nselect\\n  ws_item_sk item_sk, d_date,\\n  sum(sum(ws_sales_price))\\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\\nfrom web_sales\\n    ,date_dim\\nwhere ws_sold_date_sk=d_date_sk\\n  and d_month_seq between 1221 and 1221+11\\n  and ws_item_sk is not NULL\\ngroup by ws_item_sk, d_date),\\nstore_v1 as (\\nselect\\n  ss_item_sk item_sk, d_date,\\n  sum(sum(ss_sales_price))\\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\\nfrom store_sales\\n    ,date_dim\\nwhere ss_sold_date_sk=d_date_sk\\n  and d_month_seq between 1221 and 1221+11\\n  and ss_item_sk is not NULL\\ngroup by ss_item_sk, d_date)\\n select  *\\nfrom (select item_sk\\n     ,d_date\\n     ,web_sales\\n     ,store_sales\\n     ,max(web_sales)\\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\\n     ,max(store_sales)\\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\\n                 ,web.cume_sales web_sales\\n                 ,store.cume_sales store_sales\\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\\n                                                          and web.d_date = store.d_date)\\n          )x )y\\nwhere web_cumulative > store_cumulative\\norder by item_sk\\n        ,d_date\\nlimit 100;",
    "benchmarkResult": {
      "total": 165.19958999999997,
      "compilation": 3.87559,
      "execution": 161.32399999999998,
      "scale": 3745887.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"1690466\\" exact_cardinality=\\"30614\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"3406437\\" exact_cardinality=\\"605497\\"><Join operator_id=\\"5\\" type=\\"fullouter\\" method=\\"hash\\" estimated_cardinality=\\"3406437\\" exact_cardinality=\\"605497\\"><Window operator_id=\\"6\\" estimated_cardinality=\\"178455\\" exact_cardinality=\\"139166\\"><GroupBy operator_id=\\"7\\" mode=\\"regular\\" estimated_cardinality=\\"178455\\" exact_cardinality=\\"139166\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"198284\\" exact_cardinality=\\"143385\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"10\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></GroupBy></Window><Window operator_id=\\"11\\" estimated_cardinality=\\"796838\\" exact_cardinality=\\"492886\\"><GroupBy operator_id=\\"12\\" mode=\\"regular\\" estimated_cardinality=\\"796838\\" exact_cardinality=\\"492886\\"><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"885375\\" exact_cardinality=\\"547037\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></GroupBy></Window></Join></Window></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "52.sql",
    "queryText": "select  dt.d_year\\n \\t,item.i_brand_id brand_id\\n \\t,item.i_brand brand\\n \\t,sum(ss_ext_sales_price) ext_price\\n from date_dim dt\\n     ,store_sales\\n     ,item\\n where dt.d_date_sk = store_sales.ss_sold_date_sk\\n    and store_sales.ss_item_sk = item.i_item_sk\\n    and item.i_manager_id = 1\\n    and dt.d_moy=12\\n    and dt.d_year=1998\\n group by dt.d_year\\n \\t,item.i_brand\\n \\t,item.i_brand_id\\n order by dt.d_year\\n \\t,ext_price desc\\n \\t,brand_id\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 7.910050000000001,
      "compilation": 1.98662,
      "execution": 5.923430000000001,
      "scale": 2971454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"104\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1543\\" exact_cardinality=\\"1606\\"><TableScan operator_id=\\"4\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"53403\\" exact_cardinality=\\"47792\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"321\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "53.sql",
    "queryText": "select  * from \\n(select i_manufact_id,\\nsum(ss_sales_price) sum_sales,\\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\\nfrom item, store_sales, date_dim, store\\nwhere ss_item_sk = i_item_sk and\\nss_sold_date_sk = d_date_sk and\\nss_store_sk = s_store_sk and\\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\\n((i_category in ('Books','Children','Electronics') and\\ni_class in ('personal','portable','reference','self-help') and\\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\\n\\t\\t'exportiunivamalg #9','scholaramalgamalg #9'))\\nor(i_category in ('Women','Music','Men') and\\ni_class in ('accessories','classical','fragrances','pants') and\\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\\n\\t\\t'importoamalg #1')))\\ngroup by i_manufact_id, d_qoy ) tmp1\\nwhere case when avg_quarterly_sales > 0 \\n\\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \\n\\telse null end > 0.1\\norder by avg_quarterly_sales,\\n\\t sum_sales,\\n\\t i_manufact_id\\nlimit 100;",
    "benchmarkResult": {
      "total": 9.04733,
      "compilation": 2.6388000000000003,
      "execution": 6.40853,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"14\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"14\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"900\\" exact_cardinality=\\"14\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"1800\\" exact_cardinality=\\"16\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1800\\" exact_cardinality=\\"16\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"23798\\" exact_cardinality=\\"228\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"23798\\" exact_cardinality=\\"228\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"143874\\" exact_cardinality=\\"112017\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"914\\" exact_cardinality=\\"934\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "54.sql",
    "queryText": "with my_customers as (\\n select distinct c_customer_sk\\n        , c_current_addr_sk\\n from   \\n        ( select cs_sold_date_sk sold_date_sk,\\n                 cs_bill_customer_sk customer_sk,\\n                 cs_item_sk item_sk\\n          from   catalog_sales\\n          union all\\n          select ws_sold_date_sk sold_date_sk,\\n                 ws_bill_customer_sk customer_sk,\\n                 ws_item_sk item_sk\\n          from   web_sales\\n         ) cs_or_ws_sales,\\n         item,\\n         date_dim,\\n         customer\\n where   sold_date_sk = d_date_sk\\n         and item_sk = i_item_sk\\n         and i_category = 'Men'\\n         and i_class = 'shirts'\\n         and c_customer_sk = cs_or_ws_sales.customer_sk\\n         and d_moy = 7\\n         and d_year = 2000\\n )\\n , my_revenue as (\\n select c_customer_sk,\\n        sum(ss_ext_sales_price) as revenue\\n from   my_customers,\\n        store_sales,\\n        customer_address,\\n        store,\\n        date_dim\\n where  c_current_addr_sk = ca_address_sk\\n        and ca_county = s_county\\n        and ca_state = s_state\\n        and ss_sold_date_sk = d_date_sk\\n        and c_customer_sk = ss_customer_sk\\n        and d_month_seq between (select distinct d_month_seq+1\\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\\n                           and  (select distinct d_month_seq+3\\n                                 from   date_dim where d_year = 2000 and d_moy = 7)\\n group by c_customer_sk\\n )\\n , segments as\\n (select cast((revenue/50) as int) as segment\\n  from   my_revenue\\n )\\n  select  segment, count(*) as num_customers, segment*50 as segment_base\\n from segments\\n group by segment\\n order by segment, num_customers\\n limit 100;",
    "benchmarkResult": {
      "total": 10.84544,
      "compilation": 3.25109,
      "execution": 7.5943499999999995,
      "scale": 5501545.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"0\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"33\\" exact_cardinality=\\"0\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"125\\" exact_cardinality=\\"0\\"><Join operator_id=\\"7\\" type=\\"rightouter\\" method=\\"bnl\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /></GroupBy><Join operator_id=\\"11\\" type=\\"rightouter\\" method=\\"bnl\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"13\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /></GroupBy><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"0\\"><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"166\\" exact_cardinality=\\"216\\"><TableScan operator_id=\\"17\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><TableScan operator_id=\\"18\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"47607\\" exact_cardinality=\\"47746\\" /></Join><GroupJoin operator_id=\\"19\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"1158\\" exact_cardinality=\\"525\\"><TableScan operator_id=\\"20\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1317\\" exact_cardinality=\\"614\\"><TableScan operator_id=\\"22\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"527\\" exact_cardinality=\\"492\\" /><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"52351\\" exact_cardinality=\\"20645\\"><TableScan operator_id=\\"24\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><SetOperation operator_id=\\"25\\" type=\\"unionall\\" estimated_cardinality=\\"2147559\\" exact_cardinality=\\"2150058\\"><TableScan operator_id=\\"26\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /><TableScan operator_id=\\"27\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></SetOperation></Join></Join></GroupJoin></Join></Join></Join><TableScan operator_id=\\"28\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join><TableScan operator_id=\\"29\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></GroupBy></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "55.sql",
    "queryText": "select  i_brand_id brand_id, i_brand brand,\\n \\tsum(ss_ext_sales_price) ext_price\\n from date_dim, store_sales, item\\n where d_date_sk = ss_sold_date_sk\\n \\tand ss_item_sk = i_item_sk\\n \\tand i_manager_id=1\\n \\tand d_moy=11\\n \\tand d_year=2002\\n group by i_brand, i_brand_id\\n order by ext_price desc, i_brand_id\\nlimit 100 ;",
    "benchmarkResult": {
      "total": 8.05028,
      "compilation": 1.93497,
      "execution": 6.11531,
      "scale": 2971454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"127\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1513\\" exact_cardinality=\\"1653\\"><TableScan operator_id=\\"4\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"53403\\" exact_cardinality=\\"47792\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"321\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "56.sql",
    "queryText": "with ss as (\\n select i_item_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where i_item_id in (select\\n     i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_item_id),\\n cs as (\\n select i_item_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6 \\n group by i_item_id),\\n ws as (\\n select i_item_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom item\\nwhere i_color in ('bisque','royal','light'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 1\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -6\\n group by i_item_id)\\n  select  i_item_id ,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_item_id\\n order by total_sales,\\n          i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 14.450960000000002,
      "compilation": 3.46756,
      "execution": 10.983400000000001,
      "scale": 5446484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"3651\\" exact_cardinality=\\"508\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"4057\\" exact_cardinality=\\"847\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"432\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12472\\" exact_cardinality=\\"823\\"><TableScan operator_id=\\"6\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"29770\\" exact_cardinality=\\"1846\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"212862\\" exact_cardinality=\\"163129\\"><PipelineBreakerScan operator_id=\\"10\\" scanned_id=\\"11\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"1246\\"><Temp operator_id=\\"11\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"1246\\"><Join operator_id=\\"12\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"1246\\"><TableScan operator_id=\\"13\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"650\\" exact_cardinality=\\"561\\" /><TableScan operator_id=\\"14\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></Temp></PipelineBreakerScan><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685273\\" /></Join></Join></Join></GroupBy><GroupBy operator_id=\\"16\\" mode=\\"regular\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"152\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2557\\" exact_cardinality=\\"177\\"><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6103\\" exact_cardinality=\\"409\\"><TableScan operator_id=\\"19\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"56770\\" exact_cardinality=\\"43527\\"><PipelineBreakerScan operator_id=\\"21\\" scanned_id=\\"11\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"1246\\" /><TableScan operator_id=\\"22\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719118\\" /></Join></Join><TableScan operator_id=\\"23\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /></Join></GroupBy><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"263\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6299\\" exact_cardinality=\\"357\\"><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15036\\" exact_cardinality=\\"876\\"><TableScan operator_id=\\"27\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"28\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"112535\\" exact_cardinality=\\"87233\\"><PipelineBreakerScan operator_id=\\"29\\" scanned_id=\\"11\\" estimated_cardinality=\\"1352\\" exact_cardinality=\\"1246\\" /><TableScan operator_id=\\"30\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1424654\\" exact_cardinality=\\"1430852\\" /></Join></Join><TableScan operator_id=\\"31\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"20947\\" exact_cardinality=\\"21901\\" /></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "57.sql",
    "queryText": "with v1 as(\\n select i_category, i_brand,\\n        cc_name,\\n        d_year, d_moy,\\n        sum(cs_sales_price) sum_sales,\\n        avg(sum(cs_sales_price)) over\\n          (partition by i_category, i_brand,\\n                     cc_name, d_year)\\n          avg_monthly_sales,\\n        rank() over\\n          (partition by i_category, i_brand,\\n                     cc_name\\n           order by d_year, d_moy) rn\\n from item, catalog_sales, date_dim, call_center\\n where cs_item_sk = i_item_sk and\\n       cs_sold_date_sk = d_date_sk and\\n       cc_call_center_sk= cs_call_center_sk and\\n       (\\n         d_year = 1999 or\\n         ( d_year = 1999-1 and d_moy =12) or\\n         ( d_year = 1999+1 and d_moy =1)\\n       )\\n group by i_category, i_brand,\\n          cc_name , d_year, d_moy),\\n v2 as(\\n select v1.i_category, v1.i_brand\\n        ,v1.d_year\\n        ,v1.avg_monthly_sales\\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\\n from v1, v1 v1_lag, v1 v1_lead\\n where v1.i_category = v1_lag.i_category and\\n       v1.i_category = v1_lead.i_category and\\n       v1.i_brand = v1_lag.i_brand and\\n       v1.i_brand = v1_lead.i_brand and\\n       v1. cc_name = v1_lag. cc_name and\\n       v1. cc_name = v1_lead. cc_name and\\n       v1.rn = v1_lag.rn + 1 and\\n       v1.rn = v1_lead.rn - 1)\\n  select  *\\n from v2\\n where  d_year = 1999 and\\n        avg_monthly_sales > 0 and\\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\n order by sum_sales - avg_monthly_sales, 3\\n limit 100;",
    "benchmarkResult": {
      "total": 54.408249999999995,
      "compilation": 4.12805,
      "execution": 50.280199999999994,
      "scale": 1532604.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3010527\\" exact_cardinality=\\"24615\\"><PipelineBreakerScan operator_id=\\"3\\" scanned_id=\\"4\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><Temp operator_id=\\"4\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\"><Window operator_id=\\"9\\" estimated_cardinality=\\"47438\\" exact_cardinality=\\"32775\\"><GroupBy operator_id=\\"10\\" mode=\\"regular\\" estimated_cardinality=\\"47438\\" exact_cardinality=\\"32775\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"52709\\" exact_cardinality=\\"348067\\"><TableScan operator_id=\\"12\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50130\\" exact_cardinality=\\"348067\\"><TableScan operator_id=\\"14\\" table_name=\\"call_center\\" table_size=\\"6\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50130\\" exact_cardinality=\\"348067\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"427\\" /><TableScan operator_id=\\"17\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1430799\\" /></Join></Join></Join></GroupBy></Window></Select></Temp></PipelineBreakerScan></Select></Temp></PipelineBreakerScan><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"274767\\" exact_cardinality=\\"25017\\"><Select operator_id=\\"18\\" estimated_cardinality=\\"16132\\" exact_cardinality=\\"25049\\"><PipelineBreakerScan operator_id=\\"20\\" scanned_id=\\"7\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\" /></Select><PipelineBreakerScan operator_id=\\"21\\" scanned_id=\\"4\\" estimated_cardinality=\\"30511\\" exact_cardinality=\\"32184\\" /></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "58.sql",
    "queryText": "with ss_items as\\n (select i_item_id item_id\\n        ,sum(ss_ext_sales_price) ss_item_rev \\n from store_sales\\n     ,item\\n     ,date_dim\\n where ss_item_sk = i_item_sk\\n   and d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq = (select d_week_seq \\n                                      from date_dim\\n                                      where d_date = '1998-06-23'))\\n   and ss_sold_date_sk   = d_date_sk\\n group by i_item_id),\\n cs_items as\\n (select i_item_id item_id\\n        ,sum(cs_ext_sales_price) cs_item_rev\\n  from catalog_sales\\n      ,item\\n      ,date_dim\\n where cs_item_sk = i_item_sk\\n  and  d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq = (select d_week_seq \\n                                      from date_dim\\n                                      where d_date = '1998-06-23'))\\n  and  cs_sold_date_sk = d_date_sk\\n group by i_item_id),\\n ws_items as\\n (select i_item_id item_id\\n        ,sum(ws_ext_sales_price) ws_item_rev\\n  from web_sales\\n      ,item\\n      ,date_dim\\n where ws_item_sk = i_item_sk\\n  and  d_date in (select d_date\\n                  from date_dim\\n                  where d_week_seq =(select d_week_seq \\n                                     from date_dim\\n                                     where d_date = '1998-06-23'))\\n  and ws_sold_date_sk   = d_date_sk\\n group by i_item_id)\\n  select  ss_items.item_id\\n       ,ss_item_rev\\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\\n       ,cs_item_rev\\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\\n       ,ws_item_rev\\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\\n from ss_items,cs_items,ws_items\\n where ss_items.item_id=cs_items.item_id\\n   and ss_items.item_id=ws_items.item_id \\n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\\n order by item_id\\n         ,ss_item_rev\\n limit 100;",
    "benchmarkResult": {
      "total": 12.972539999999999,
      "compilation": 3.4384099999999997,
      "execution": 9.53413,
      "scale": 5314484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"213\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"284\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"66\\" exact_cardinality=\\"898\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"31\\" exact_cardinality=\\"448\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"83\\" exact_cardinality=\\"1604\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"92\\" exact_cardinality=\\"1688\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"88\\" exact_cardinality=\\"1688\\"><PipelineBreakerScan operator_id=\\"11\\" scanned_id=\\"12\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><Temp operator_id=\\"12\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><Join operator_id=\\"13\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /><TableScan operator_id=\\"17\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"18\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></Temp></PipelineBreakerScan><TableScan operator_id=\\"19\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join><TableScan operator_id=\\"20\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy><GroupBy operator_id=\\"21\\" mode=\\"regular\\" estimated_cardinality=\\"61\\" exact_cardinality=\\"485\\"><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"68\\" exact_cardinality=\\"582\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"175\\" exact_cardinality=\\"3168\\"><PipelineBreakerScan operator_id=\\"24\\" scanned_id=\\"12\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\" /><TableScan operator_id=\\"25\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join><EarlyProbe operator_id=\\"26\\" source=\\"7\\" estimated_cardinality=\\"6627\\" exact_cardinality=\\"3487\\"><TableScan operator_id=\\"27\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></EarlyProbe></Join></GroupBy></Join><TableScan operator_id=\\"28\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"335\\" exact_cardinality=\\"5819\\"><PipelineBreakerScan operator_id=\\"30\\" scanned_id=\\"12\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"7\\" /><TableScan operator_id=\\"31\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join></GroupBy></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "59.sql",
    "queryText": "with wss as \\n (select d_week_seq,\\n        ss_store_sk,\\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\\n from store_sales,date_dim\\n where d_date_sk = ss_sold_date_sk\\n group by d_week_seq,ss_store_sk\\n )\\n  select  s_store_name1,s_store_id1,d_week_seq1\\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\\n from\\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\\n        ,s_store_id s_store_id1,sun_sales sun_sales1\\n        ,mon_sales mon_sales1,tue_sales tue_sales1\\n        ,wed_sales wed_sales1,thu_sales thu_sales1\\n        ,fri_sales fri_sales1,sat_sales sat_sales1\\n  from wss,store,date_dim d\\n  where d.d_week_seq = wss.d_week_seq and\\n        ss_store_sk = s_store_sk and \\n        d_month_seq between 1211 and 1211 + 11) y,\\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\\n        ,s_store_id s_store_id2,sun_sales sun_sales2\\n        ,mon_sales mon_sales2,tue_sales tue_sales2\\n        ,wed_sales wed_sales2,thu_sales thu_sales2\\n        ,fri_sales fri_sales2,sat_sales sat_sales2\\n  from wss,store,date_dim d\\n  where d.d_week_seq = wss.d_week_seq and\\n        ss_store_sk = s_store_sk and \\n        d_month_seq between 1211+ 12 and 1211 + 23) x\\n where s_store_id1=s_store_id2\\n   and d_week_seq1=d_week_seq2-52\\n order by s_store_name1,s_store_id1,d_week_seq1\\nlimit 100;",
    "benchmarkResult": {
      "total": 30.15266,
      "compilation": 2.75326,
      "execution": 27.3994,
      "scale": 3099576.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"175\\" exact_cardinality=\\"15186\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"28\\"><TableScan operator_id=\\"5\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /></Join><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"175\\" exact_cardinality=\\"124019\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"804\\" exact_cardinality=\\"2555\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><PipelineBreakerScan operator_id=\\"10\\" scanned_id=\\"11\\" estimated_cardinality=\\"34101\\" exact_cardinality=\\"1834\\"><GroupBy operator_id=\\"11\\" mode=\\"regular\\" estimated_cardinality=\\"34101\\" exact_cardinality=\\"1834\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3161719\\" exact_cardinality=\\"2750311\\"><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></GroupBy></PipelineBreakerScan></Join><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2409\\" exact_cardinality=\\"2555\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"642\\" exact_cardinality=\\"365\\" /><PipelineBreakerScan operator_id=\\"17\\" scanned_id=\\"11\\" estimated_cardinality=\\"34101\\" exact_cardinality=\\"1834\\" /></Join></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "60.sql",
    "queryText": "with ss as (\\n select\\n          i_item_id,sum(ss_ext_sales_price) total_sales\\n from\\n \\tstore_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     ss_item_sk              = i_item_sk\\n and     ss_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     ss_addr_sk              = ca_address_sk\\n and     ca_gmt_offset           = -5 \\n group by i_item_id),\\n cs as (\\n select\\n          i_item_id,sum(cs_ext_sales_price) total_sales\\n from\\n \\tcatalog_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     cs_item_sk              = i_item_sk\\n and     cs_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     cs_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -5 \\n group by i_item_id),\\n ws as (\\n select\\n          i_item_id,sum(ws_ext_sales_price) total_sales\\n from\\n \\tweb_sales,\\n \\tdate_dim,\\n         customer_address,\\n         item\\n where\\n         i_item_id               in (select\\n  i_item_id\\nfrom\\n item\\nwhere i_category in ('Shoes'))\\n and     ws_item_sk              = i_item_sk\\n and     ws_sold_date_sk         = d_date_sk\\n and     d_year                  = 2001\\n and     d_moy                   = 10\\n and     ws_bill_addr_sk         = ca_address_sk\\n and     ca_gmt_offset           = -5\\n group by i_item_id)\\n  select   \\n  i_item_id\\n,sum(total_sales) total_sales\\n from  (select * from ss \\n        union all\\n        select * from cs \\n        union all\\n        select * from ws) tmp1\\n group by i_item_id\\n order by i_item_id\\n      ,total_sales\\n limit 100;",
    "benchmarkResult": {
      "total": 14.9443,
      "compilation": 3.4473,
      "execution": 11.497,
      "scale": 5446484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"6908\\" exact_cardinality=\\"1680\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"7676\\" exact_cardinality=\\"3584\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"1561\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6271\\" exact_cardinality=\\"4224\\"><TableScan operator_id=\\"6\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"18212\\" exact_cardinality=\\"18246\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"17216\\" exact_cardinality=\\"11558\\"><PipelineBreakerScan operator_id=\\"8\\" scanned_id=\\"9\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"3918\\"><Temp operator_id=\\"9\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"3918\\"><Join operator_id=\\"10\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"3918\\"><TableScan operator_id=\\"11\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1792\\" exact_cardinality=\\"1835\\" /><TableScan operator_id=\\"12\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></Temp></PipelineBreakerScan><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"84528\\" exact_cardinality=\\"60547\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685273\\" /></Join></Join></Join></GroupBy><GroupBy operator_id=\\"16\\" mode=\\"regular\\" estimated_cardinality=\\"1232\\" exact_cardinality=\\"824\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1369\\" exact_cardinality=\\"1135\\"><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3759\\" exact_cardinality=\\"3074\\"><PipelineBreakerScan operator_id=\\"19\\" scanned_id=\\"9\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"3918\\" /><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18456\\" exact_cardinality=\\"15959\\"><TableScan operator_id=\\"21\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"22\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719118\\" /></Join></Join><TableScan operator_id=\\"23\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"18212\\" exact_cardinality=\\"18246\\" /></Join></GroupBy><GroupBy operator_id=\\"24\\" mode=\\"regular\\" estimated_cardinality=\\"2957\\" exact_cardinality=\\"1199\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3285\\" exact_cardinality=\\"2197\\"><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"9020\\" exact_cardinality=\\"6114\\"><PipelineBreakerScan operator_id=\\"27\\" scanned_id=\\"9\\" estimated_cardinality=\\"3487\\" exact_cardinality=\\"3918\\" /><Join operator_id=\\"28\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"44285\\" exact_cardinality=\\"32032\\"><TableScan operator_id=\\"29\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"30\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1424654\\" exact_cardinality=\\"1430852\\" /></Join></Join><TableScan operator_id=\\"31\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"18212\\" exact_cardinality=\\"18246\\" /></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "61.sql",
    "queryText": "select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100\\nfrom\\n  (select sum(ss_ext_sales_price) promotions\\n   from  store_sales\\n        ,store\\n        ,promotion\\n        ,date_dim\\n        ,customer\\n        ,customer_address \\n        ,item\\n   where ss_sold_date_sk = d_date_sk\\n   and   ss_store_sk = s_store_sk\\n   and   ss_promo_sk = p_promo_sk\\n   and   ss_customer_sk= c_customer_sk\\n   and   ca_address_sk = c_current_addr_sk\\n   and   ss_item_sk = i_item_sk \\n   and   ca_gmt_offset = -7\\n   and   i_category = 'Books'\\n   and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')\\n   and   s_gmt_offset = -7\\n   and   d_year = 2001\\n   and   d_moy  = 12) promotional_sales,\\n  (select sum(ss_ext_sales_price) total\\n   from  store_sales\\n        ,store\\n        ,date_dim\\n        ,customer\\n        ,customer_address\\n        ,item\\n   where ss_sold_date_sk = d_date_sk\\n   and   ss_store_sk = s_store_sk\\n   and   ss_customer_sk= c_customer_sk\\n   and   ca_address_sk = c_current_addr_sk\\n   and   ss_item_sk = i_item_sk\\n   and   ca_gmt_offset = -7\\n   and   i_category = 'Books'\\n   and   s_gmt_offset = -7\\n   and   d_year = 2001\\n   and   d_moy  = 12) all_sales\\norder by promotions, total\\nlimit 100;",
    "benchmarkResult": {
      "total": 9.80979,
      "compilation": 3.0686,
      "execution": 6.7411900000000005,
      "scale": 6243207.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"3\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"38\\" exact_cardinality=\\"0\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"342\\" exact_cardinality=\\"0\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"328\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"7\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"157\\" exact_cardinality=\\"158\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"713\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"9\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1669\\" exact_cardinality=\\"1733\\" /><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7318\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"11\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"12\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"87816\\" exact_cardinality=\\"89078\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2649746\\" exact_cardinality=\\"2628753\\" /></Join></Join></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"17\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"5566\\" exact_cardinality=\\"5566\\" /></Join></GroupBy><GroupBy operator_id=\\"18\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"81\\" exact_cardinality=\\"0\\"><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"727\\" exact_cardinality=\\"0\\"><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"698\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"22\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1669\\" exact_cardinality=\\"1733\\" /><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7161\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"24\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"25\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"85934\\" exact_cardinality=\\"89381\\"><TableScan operator_id=\\"27\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"28\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2660998\\" exact_cardinality=\\"2636826\\" /></Join></Join></Join><TableScan operator_id=\\"29\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"30\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"5566\\" exact_cardinality=\\"5566\\" /></Join></GroupBy></Join></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "62.sql",
    "queryText": "select  \\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,web_name\\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 30) and \\n                 (ws_ship_date_sk - ws_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 60) and \\n                 (ws_ship_date_sk - ws_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk > 90) and\\n                 (ws_ship_date_sk - ws_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   web_sales\\n  ,warehouse\\n  ,ship_mode\\n  ,web_site\\n  ,date_dim\\nwhere\\n    d_month_seq between 1213 and 1213 + 11\\nand ws_ship_date_sk   = d_date_sk\\nand ws_warehouse_sk   = w_warehouse_sk\\nand ws_ship_mode_sk   = sm_ship_mode_sk\\nand ws_web_site_sk    = web_site_sk\\ngroup by\\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,web_name\\norder by substr(w_warehouse_name,1,20)\\n        ,sm_type\\n       ,web_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 8.56137,
      "compilation": 2.49987,
      "execution": 6.0615,
      "scale": 792489.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"21\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"21\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"21\\" exact_cardinality=\\"150\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"55574\\" exact_cardinality=\\"145964\\"><TableScan operator_id=\\"4\\" table_name=\\"web_site\\" table_size=\\"30\\" estimated_cardinality=\\"30\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50454\\" exact_cardinality=\\"145964\\"><TableScan operator_id=\\"6\\" table_name=\\"ship_mode\\" table_size=\\"20\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"20\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50454\\" exact_cardinality=\\"145964\\"><TableScan operator_id=\\"8\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50454\\" exact_cardinality=\\"145964\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"11\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719053\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "63.sql",
    "queryText": "select  * \\nfrom (select i_manager_id\\n             ,sum(ss_sales_price) sum_sales\\n             ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales\\n      from item\\n          ,store_sales\\n          ,date_dim\\n          ,store\\n      where ss_item_sk = i_item_sk\\n        and ss_sold_date_sk = d_date_sk\\n        and ss_store_sk = s_store_sk\\n        and d_month_seq in (1217,1217+1,1217+2,1217+3,1217+4,1217+5,1217+6,1217+7,1217+8,1217+9,1217+10,1217+11)\\n        and ((    i_category in ('Books','Children','Electronics')\\n              and i_class in ('personal','portable','reference','self-help')\\n              and i_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\\n\\t\\t                  'exportiunivamalg #9','scholaramalgamalg #9'))\\n           or(    i_category in ('Women','Music','Men')\\n              and i_class in ('accessories','classical','fragrances','pants')\\n              and i_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\\n\\t\\t                 'importoamalg #1')))\\ngroup by i_manager_id, d_moy) tmp1\\nwhere case when avg_monthly_sales > 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\\norder by i_manager_id\\n        ,avg_monthly_sales\\n        ,sum_sales\\nlimit 100;",
    "benchmarkResult": {
      "total": 10.3005,
      "compilation": 3.11363,
      "execution": 7.18687,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"329\\" exact_cardinality=\\"381\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"658\\" exact_cardinality=\\"450\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"658\\" exact_cardinality=\\"450\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"35577\\" exact_cardinality=\\"4733\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"35577\\" exact_cardinality=\\"4733\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"143874\\" exact_cardinality=\\"112017\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"914\\" exact_cardinality=\\"934\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "64.sql",
    "queryText": "with cs_ui as\\n (select cs_item_sk\\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\\n  from catalog_sales\\n      ,catalog_returns\\n  where cs_item_sk = cr_item_sk\\n    and cs_order_number = cr_order_number\\n  group by cs_item_sk\\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\\ncross_sales as\\n (select i_product_name product_name\\n     ,i_item_sk item_sk\\n     ,s_store_name store_name\\n     ,s_zip store_zip\\n     ,ad1.ca_street_number b_street_number\\n     ,ad1.ca_street_name b_street_name\\n     ,ad1.ca_city b_city\\n     ,ad1.ca_zip b_zip\\n     ,ad2.ca_street_number c_street_number\\n     ,ad2.ca_street_name c_street_name\\n     ,ad2.ca_city c_city\\n     ,ad2.ca_zip c_zip\\n     ,d1.d_year as syear\\n     ,d2.d_year as fsyear\\n     ,d3.d_year s2year\\n     ,count(*) cnt\\n     ,sum(ss_wholesale_cost) s1\\n     ,sum(ss_list_price) s2\\n     ,sum(ss_coupon_amt) s3\\n  FROM   store_sales\\n        ,store_returns\\n        ,cs_ui\\n        ,date_dim d1\\n        ,date_dim d2\\n        ,date_dim d3\\n        ,store\\n        ,customer\\n        ,customer_demographics cd1\\n        ,customer_demographics cd2\\n        ,promotion\\n        ,household_demographics hd1\\n        ,household_demographics hd2\\n        ,customer_address ad1\\n        ,customer_address ad2\\n        ,income_band ib1\\n        ,income_band ib2\\n        ,item\\n  WHERE  ss_store_sk = s_store_sk AND\\n         ss_sold_date_sk = d1.d_date_sk AND\\n         ss_customer_sk = c_customer_sk AND\\n         ss_cdemo_sk= cd1.cd_demo_sk AND\\n         ss_hdemo_sk = hd1.hd_demo_sk AND\\n         ss_addr_sk = ad1.ca_address_sk and\\n         ss_item_sk = i_item_sk and\\n         ss_item_sk = sr_item_sk and\\n         ss_ticket_number = sr_ticket_number and\\n         ss_item_sk = cs_ui.cs_item_sk and\\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\\n         c_current_addr_sk = ad2.ca_address_sk and\\n         c_first_sales_date_sk = d2.d_date_sk and\\n         c_first_shipto_date_sk = d3.d_date_sk and\\n         ss_promo_sk = p_promo_sk and\\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\\n         cd1.cd_marital_status <> cd2.cd_marital_status and\\n         i_color in ('blue','dodger','navy','almond','khaki','tan') and\\n         i_current_price between 29 and 29 + 10 and\\n         i_current_price between 29 + 1 and 29 + 15\\ngroup by i_product_name\\n       ,i_item_sk\\n       ,s_store_name\\n       ,s_zip\\n       ,ad1.ca_street_number\\n       ,ad1.ca_street_name\\n       ,ad1.ca_city\\n       ,ad1.ca_zip\\n       ,ad2.ca_street_number\\n       ,ad2.ca_street_name\\n       ,ad2.ca_city\\n       ,ad2.ca_zip\\n       ,d1.d_year\\n       ,d2.d_year\\n       ,d3.d_year\\n)\\nselect cs1.product_name\\n     ,cs1.store_name\\n     ,cs1.store_zip\\n     ,cs1.b_street_number\\n     ,cs1.b_street_name\\n     ,cs1.b_city\\n     ,cs1.b_zip\\n     ,cs1.c_street_number\\n     ,cs1.c_street_name\\n     ,cs1.c_city\\n     ,cs1.c_zip\\n     ,cs1.syear\\n     ,cs1.cnt\\n     ,cs1.s1 as s11\\n     ,cs1.s2 as s21\\n     ,cs1.s3 as s31\\n     ,cs2.s1 as s12\\n     ,cs2.s2 as s22\\n     ,cs2.s3 as s32\\n     ,cs2.syear\\n     ,cs2.cnt\\nfrom cross_sales cs1,cross_sales cs2\\nwhere cs1.item_sk=cs2.item_sk and\\n     cs1.syear = 2001 and\\n     cs2.syear = 2001 + 1 and\\n     cs2.cnt <= cs1.cnt and\\n     cs1.store_name = cs2.store_name and\\n     cs1.store_zip = cs2.store_zip\\norder by cs1.product_name\\n       ,cs1.store_name\\n       ,cs2.cnt\\n       ,cs1.s1\\n       ,cs2.s1;",
    "benchmarkResult": {
      "total": 21.809630000000002,
      "compilation": 7.84913,
      "execution": 13.960500000000001,
      "scale": 9047033.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"44729\\" exact_cardinality=\\"5\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"44729\\" exact_cardinality=\\"5\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"44729\\" exact_cardinality=\\"5\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"1423\\" exact_cardinality=\\"28\\"><PipelineBreakerScan operator_id=\\"4\\" scanned_id=\\"5\\" estimated_cardinality=\\"3964\\" exact_cardinality=\\"39\\"><GroupBy operator_id=\\"5\\" mode=\\"regular\\" estimated_cardinality=\\"3964\\" exact_cardinality=\\"39\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4405\\" exact_cardinality=\\"39\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4160\\" exact_cardinality=\\"39\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3928\\" exact_cardinality=\\"39\\"><TableScan operator_id=\\"9\\" table_name=\\"income_band\\" table_size=\\"20\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"20\\" /><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3928\\" exact_cardinality=\\"39\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3891\\" exact_cardinality=\\"39\\"><TableScan operator_id=\\"12\\" table_name=\\"income_band\\" table_size=\\"20\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"20\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3891\\" exact_cardinality=\\"39\\"><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"39\\"><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"51\\"><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"51\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"51\\"><TableScan operator_id=\\"18\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"51\\"><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3855\\" exact_cardinality=\\"51\\"><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3995\\" exact_cardinality=\\"55\\"><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4543\\" exact_cardinality=\\"55\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"10772\\" exact_cardinality=\\"138\\"><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"99\\" exact_cardinality=\\"149\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"588\\" exact_cardinality=\\"186\\"><TableScan operator_id=\\"26\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"35\\" exact_cardinality=\\"12\\" /><TableScan operator_id=\\"27\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /></Join><Select operator_id=\\"28\\" estimated_cardinality=\\"2870\\" exact_cardinality=\\"9\\"><GroupBy operator_id=\\"29\\" mode=\\"regular\\" estimated_cardinality=\\"4377\\" exact_cardinality=\\"11\\"><Join operator_id=\\"30\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4863\\" exact_cardinality=\\"91\\"><TableScan operator_id=\\"31\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /><EarlyProbe operator_id=\\"32\\" source=\\"24\\" estimated_cardinality=\\"48659\\" exact_cardinality=\\"908\\"><TableScan operator_id=\\"33\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1441548\\" exact_cardinality=\\"1441548\\" /></EarlyProbe></Join></GroupBy></Select></Join><EarlyProbe operator_id=\\"34\\" source=\\"17\\" estimated_cardinality=\\"1871082\\" exact_cardinality=\\"2622614\\"><TableScan operator_id=\\"35\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2641307\\" exact_cardinality=\\"2622614\\" /></EarlyProbe></Join><TableScan operator_id=\\"36\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"856\\" exact_cardinality=\\"730\\" /></Join><TableScan operator_id=\\"37\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"300\\" exact_cardinality=\\"300\\" /></Join><TableScan operator_id=\\"38\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"92675\\" exact_cardinality=\\"93454\\" /></Join><TableScan operator_id=\\"39\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join></Join><TableScan operator_id=\\"40\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join><TableScan operator_id=\\"41\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join><TableScan operator_id=\\"42\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join><TableScan operator_id=\\"43\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"7200\\" exact_cardinality=\\"7200\\" /></Join></Join><TableScan operator_id=\\"44\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"7200\\" exact_cardinality=\\"7200\\" /></Join></Join><TableScan operator_id=\\"45\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"46\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></GroupBy></PipelineBreakerScan></Select><Select operator_id=\\"47\\" estimated_cardinality=\\"2406\\" exact_cardinality=\\"11\\"><PipelineBreakerScan operator_id=\\"48\\" scanned_id=\\"5\\" estimated_cardinality=\\"3964\\" exact_cardinality=\\"39\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "65.sql",
    "queryText": "select \\n\\ts_store_name,\\n\\ti_item_desc,\\n\\tsc.revenue,\\n\\ti_current_price,\\n\\ti_wholesale_cost,\\n\\ti_brand\\n from store, item,\\n     (select ss_store_sk, avg(revenue) as ave\\n \\tfrom\\n \\t    (select  ss_store_sk, ss_item_sk, \\n \\t\\t     sum(ss_sales_price) as revenue\\n \\t\\tfrom store_sales, date_dim\\n \\t\\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1206 and 1206+11\\n \\t\\tgroup by ss_store_sk, ss_item_sk) sa\\n \\tgroup by ss_store_sk) sb,\\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\\n \\tfrom store_sales, date_dim\\n \\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1206 and 1206+11\\n \\tgroup by ss_store_sk, ss_item_sk) sc\\n where sb.ss_store_sk = sc.ss_store_sk and \\n       sc.revenue <= 0.1 * sb.ave and\\n       s_store_sk = sc.ss_store_sk and\\n       i_item_sk = sc.ss_item_sk\\n order by s_store_name, i_item_desc\\nlimit 100;",
    "benchmarkResult": {
      "total": 31.1574,
      "compilation": 2.9265,
      "execution": 28.2309,
      "scale": 5924919.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"55014\\" exact_cardinality=\\"2754\\"><TableScan operator_id=\\"3\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"52322\\" exact_cardinality=\\"2754\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><Select operator_id=\\"6\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><GroupBy operator_id=\\"7\\" mode=\\"regular\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"84811\\" exact_cardinality=\\"70936\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"430460\\" exact_cardinality=\\"535795\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></GroupBy></GroupBy></Select><TableScan operator_id=\\"12\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /></Join><Select operator_id=\\"13\\" estimated_cardinality=\\"84709\\" exact_cardinality=\\"70897\\"><GroupBy operator_id=\\"14\\" mode=\\"regular\\" estimated_cardinality=\\"84811\\" exact_cardinality=\\"70936\\"><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"161317\\" exact_cardinality=\\"535795\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><EarlyProbe operator_id=\\"17\\" source=\\"4\\" estimated_cardinality=\\"1009869\\" exact_cardinality=\\"2685687\\"><EarlyProbe operator_id=\\"18\\" source=\\"2\\" estimated_cardinality=\\"1887890.0\\" exact_cardinality=\\"2685687\\"><TableScan operator_id=\\"19\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></EarlyProbe></EarlyProbe></Join></GroupBy></Select></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "66.sql",
    "queryText": "select   \\n         w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n        ,ship_carriers\\n        ,year\\n \\t,sum(jan_sales) as jan_sales\\n \\t,sum(feb_sales) as feb_sales\\n \\t,sum(mar_sales) as mar_sales\\n \\t,sum(apr_sales) as apr_sales\\n \\t,sum(may_sales) as may_sales\\n \\t,sum(jun_sales) as jun_sales\\n \\t,sum(jul_sales) as jul_sales\\n \\t,sum(aug_sales) as aug_sales\\n \\t,sum(sep_sales) as sep_sales\\n \\t,sum(oct_sales) as oct_sales\\n \\t,sum(nov_sales) as nov_sales\\n \\t,sum(dec_sales) as dec_sales\\n \\t,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot\\n \\t,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot\\n \\t,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot\\n \\t,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot\\n \\t,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot\\n \\t,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot\\n \\t,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot\\n \\t,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot\\n \\t,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot\\n \\t,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot\\n \\t,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot\\n \\t,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot\\n \\t,sum(jan_net) as jan_net\\n \\t,sum(feb_net) as feb_net\\n \\t,sum(mar_net) as mar_net\\n \\t,sum(apr_net) as apr_net\\n \\t,sum(may_net) as may_net\\n \\t,sum(jun_net) as jun_net\\n \\t,sum(jul_net) as jul_net\\n \\t,sum(aug_net) as aug_net\\n \\t,sum(sep_net) as sep_net\\n \\t,sum(oct_net) as oct_net\\n \\t,sum(nov_net) as nov_net\\n \\t,sum(dec_net) as dec_net\\n from (\\n     select \\n \\tw_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,'DHL' || ',' || 'TBS' as ship_carriers\\n       ,d_year as year\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jan_sales\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as feb_sales\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as mar_sales\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as apr_sales\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as may_sales\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jun_sales\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as jul_sales\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as aug_sales\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as sep_sales\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as oct_sales\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as nov_sales\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen ws_ext_sales_price* ws_quantity else 0 end) as dec_sales\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net\\n \\t,sum(case when d_moy = 2\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net\\n     from\\n          web_sales\\n         ,warehouse\\n         ,date_dim\\n         ,time_dim\\n \\t  ,ship_mode\\n     where\\n            ws_warehouse_sk =  w_warehouse_sk\\n        and ws_sold_date_sk = d_date_sk\\n        and ws_sold_time_sk = t_time_sk\\n \\tand ws_ship_mode_sk = sm_ship_mode_sk\\n        and d_year = 2002\\n \\tand t_time between 51277 and 51277+28800 \\n \\tand sm_carrier in ('DHL','TBS')\\n     group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n       ,d_year\\n union all\\n     select \\n \\tw_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,'DHL' || ',' || 'TBS' as ship_carriers\\n       ,d_year as year\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jan_sales\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as feb_sales\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as mar_sales\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as apr_sales\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as may_sales\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jun_sales\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as jul_sales\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as aug_sales\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as sep_sales\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as oct_sales\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as nov_sales\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen cs_ext_list_price* cs_quantity else 0 end) as dec_sales\\n \\t,sum(case when d_moy = 1 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net\\n \\t,sum(case when d_moy = 2 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net\\n \\t,sum(case when d_moy = 3 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net\\n \\t,sum(case when d_moy = 4 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net\\n \\t,sum(case when d_moy = 5 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net\\n \\t,sum(case when d_moy = 6 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net\\n \\t,sum(case when d_moy = 7 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net\\n \\t,sum(case when d_moy = 8 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net\\n \\t,sum(case when d_moy = 9 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net\\n \\t,sum(case when d_moy = 10 \\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net\\n \\t,sum(case when d_moy = 11\\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net\\n \\t,sum(case when d_moy = 12\\n \\t\\tthen cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net\\n     from\\n          catalog_sales\\n         ,warehouse\\n         ,date_dim\\n         ,time_dim\\n \\t ,ship_mode\\n     where\\n            cs_warehouse_sk =  w_warehouse_sk\\n        and cs_sold_date_sk = d_date_sk\\n        and cs_sold_time_sk = t_time_sk\\n \\tand cs_ship_mode_sk = sm_ship_mode_sk\\n        and d_year = 2002\\n \\tand t_time between 51277 AND 51277+28800 \\n \\tand sm_carrier in ('DHL','TBS')\\n     group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n       ,d_year\\n ) x\\n group by \\n        w_warehouse_name\\n \\t,w_warehouse_sq_ft\\n \\t,w_city\\n \\t,w_county\\n \\t,w_state\\n \\t,w_country\\n \\t,ship_carriers\\n       ,year\\n order by w_warehouse_name\\n limit 100;",
    "benchmarkResult": {
      "total": 16.60159,
      "compilation": 8.039950000000001,
      "execution": 8.56164,
      "scale": 2479841.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"5\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"5\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"9\\" exact_cardinality=\\"5\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"10\\" exact_cardinality=\\"10\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6245\\" exact_cardinality=\\"6397\\"><TableScan operator_id=\\"6\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6245\\" exact_cardinality=\\"6397\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"14169\\" exact_cardinality=\\"14197\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><EarlyProbe operator_id=\\"10\\" source=\\"5\\" estimated_cardinality=\\"55816\\" exact_cardinality=\\"72043\\"><TableScan operator_id=\\"11\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"77277\\" exact_cardinality=\\"72043\\" /></EarlyProbe></Join><TableScan operator_id=\\"12\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"28771\\" exact_cardinality=\\"28801\\" /></Join></Join></GroupBy><GroupBy operator_id=\\"13\\" mode=\\"regular\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\"><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18624\\" exact_cardinality=\\"12884\\"><TableScan operator_id=\\"15\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18624\\" exact_cardinality=\\"12884\\"><TableScan operator_id=\\"17\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"28771\\" exact_cardinality=\\"28801\\" /><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"39708\\" exact_cardinality=\\"28354\\"><TableScan operator_id=\\"19\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"20\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"128106\\" exact_cardinality=\\"143099\\" /></Join></Join></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "67.sql",
    "queryText": "select  *\\nfrom (select i_category\\n            ,i_class\\n            ,i_brand\\n            ,i_product_name\\n            ,d_year\\n            ,d_qoy\\n            ,d_moy\\n            ,s_store_id\\n            ,sumsales\\n            ,rank() over (partition by i_category order by sumsales desc) rk\\n      from (select i_category\\n                  ,i_class\\n                  ,i_brand\\n                  ,i_product_name\\n                  ,d_year\\n                  ,d_qoy\\n                  ,d_moy\\n                  ,s_store_id\\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\\n            from store_sales\\n                ,date_dim\\n                ,store\\n                ,item\\n       where  ss_sold_date_sk=d_date_sk\\n          and ss_item_sk=i_item_sk\\n          and ss_store_sk = s_store_sk\\n          and d_month_seq between 1178 and 1178+11\\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\\nwhere rk <= 100\\norder by i_category\\n        ,i_class\\n        ,i_brand\\n        ,i_product_name\\n        ,d_year\\n        ,d_qoy\\n        ,d_moy\\n        ,s_store_id\\n        ,sumsales\\n        ,rk\\nlimit 100;",
    "benchmarkResult": {
      "total": 218.52977,
      "compilation": 2.6047700000000003,
      "execution": 215.925,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"150080\\" exact_cardinality=\\"1100\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"300159\\" exact_cardinality=\\"525991\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"300159\\" exact_cardinality=\\"525991\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"333510\\" exact_cardinality=\\"544247\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"317191\\" exact_cardinality=\\"544247\\"><TableScan operator_id=\\"8\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"317191\\" exact_cardinality=\\"544247\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "68.sql",
    "queryText": "select  c_last_name\\n       ,c_first_name\\n       ,ca_city\\n       ,bought_city\\n       ,ss_ticket_number\\n       ,extended_price\\n       ,extended_tax\\n       ,list_price\\n from (select ss_ticket_number\\n             ,ss_customer_sk\\n             ,ca_city bought_city\\n             ,sum(ss_ext_sales_price) extended_price \\n             ,sum(ss_ext_list_price) list_price\\n             ,sum(ss_ext_tax) extended_tax \\n       from store_sales\\n           ,date_dim\\n           ,store\\n           ,household_demographics\\n           ,customer_address \\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n         and store_sales.ss_store_sk = store.s_store_sk  \\n        and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n        and store_sales.ss_addr_sk = customer_address.ca_address_sk\\n        and date_dim.d_dom between 1 and 2 \\n        and (household_demographics.hd_dep_count = 6 or\\n             household_demographics.hd_vehicle_count= 2)\\n        and date_dim.d_year in (2000,2000+1,2000+2)\\n        and store.s_city in ('Pleasant Hill','Oak Grove')\\n       group by ss_ticket_number\\n               ,ss_customer_sk\\n               ,ss_addr_sk,ca_city) dn\\n      ,customer\\n      ,customer_address current_addr\\n where ss_customer_sk = c_customer_sk\\n   and customer.c_current_addr_sk = current_addr.ca_address_sk\\n   and current_addr.ca_city <> bought_city\\n order by c_last_name\\n         ,ss_ticket_number\\n limit 100;",
    "benchmarkResult": {
      "total": 8.76911,
      "compilation": 3.24011,
      "execution": 5.529,
      "scale": 3160654.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1724\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1787\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1716\\" exact_cardinality=\\"0\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1907\\" exact_cardinality=\\"0\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1977\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"7\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1631\\" exact_cardinality=\\"1800\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7879\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"9\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"10\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"94553\\" exact_cardinality=\\"104164\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"72\\" /><TableScan operator_id=\\"13\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2646933\\" exact_cardinality=\\"2628655\\" /></Join></Join></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48242\\" exact_cardinality=\\"48481\\" /></Join></GroupBy><TableScan operator_id=\\"15\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><TableScan operator_id=\\"16\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"48242\\" exact_cardinality=\\"48481\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "69.sql",
    "queryText": "select  \\n  cd_gender,\\n  cd_marital_status,\\n  cd_education_status,\\n  count(*) cnt1,\\n  cd_purchase_estimate,\\n  count(*) cnt2,\\n  cd_credit_rating,\\n  count(*) cnt3\\n from\\n  customer c,customer_address ca,customer_demographics\\n where\\n  c.c_current_addr_sk = ca.ca_address_sk and\\n  ca_state in ('IN','IL','GA') and\\n  cd_demo_sk = c.c_current_cdemo_sk and \\n  exists (select *\\n          from store_sales,date_dim\\n          where c.c_customer_sk = ss_customer_sk and\\n                ss_sold_date_sk = d_date_sk and\\n                d_year = 2001 and\\n                d_moy between 2 and 2+2) and\\n   (not exists (select *\\n            from web_sales,date_dim\\n            where c.c_customer_sk = ws_bill_customer_sk and\\n                  ws_sold_date_sk = d_date_sk and\\n                  d_year = 2001 and\\n                  d_moy between 2 and 2+2) and\\n    not exists (select * \\n            from catalog_sales,date_dim\\n            where c.c_customer_sk = cs_ship_customer_sk and\\n                  cs_sold_date_sk = d_date_sk and\\n                  d_year = 2001 and\\n                  d_moy between 2 and 2+2))\\n group by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating\\n order by cd_gender,\\n          cd_marital_status,\\n          cd_education_status,\\n          cd_purchase_estimate,\\n          cd_credit_rating\\n limit 100;",
    "benchmarkResult": {
      "total": 24.08264,
      "compilation": 2.65154,
      "execution": 21.4311,
      "scale": 7331284.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"2597\\" exact_cardinality=\\"596\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"2886\\" exact_cardinality=\\"627\\"><Join operator_id=\\"4\\" type=\\"leftanti\\" method=\\"hash\\" estimated_cardinality=\\"2886\\" exact_cardinality=\\"627\\"><Join operator_id=\\"5\\" type=\\"leftanti\\" method=\\"hash\\" estimated_cardinality=\\"3417\\" exact_cardinality=\\"639\\"><Join operator_id=\\"6\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"5257\\" exact_cardinality=\\"680\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"10747\\" exact_cardinality=\\"10599\\"><TableScan operator_id=\\"8\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"5615\\" exact_cardinality=\\"5436\\" /><TableScan operator_id=\\"9\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"95703\\" exact_cardinality=\\"96562\\" /></Join><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"70173\\" exact_cardinality=\\"75845\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"89\\" /><TableScan operator_id=\\"12\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></Join><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"44511\\" exact_cardinality=\\"40045\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"89\\" /><TableScan operator_id=\\"15\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></Join><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18456\\" exact_cardinality=\\"21156\\"><TableScan operator_id=\\"17\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"89\\" /><TableScan operator_id=\\"18\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></Join><TableScan operator_id=\\"19\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "70.sql",
    "queryText": "select  \\n    sum(ss_net_profit) as total_sum\\n   ,s_state\\n   ,s_county\\n   ,grouping(s_state)+grouping(s_county) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(s_state)+grouping(s_county),\\n \\tcase when grouping(s_county) = 0 then s_state end \\n \\torder by sum(ss_net_profit) desc) as rank_within_parent\\n from\\n    store_sales\\n   ,date_dim       d1\\n   ,store\\n where\\n    d1.d_month_seq between 1224 and 1224+11\\n and d1.d_date_sk = ss_sold_date_sk\\n and s_store_sk  = ss_store_sk\\n and s_state in\\n             ( select s_state\\n               from  (select s_state as s_state,\\n \\t\\t\\t    rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking\\n                      from   store_sales, store, date_dim\\n                      where  d_month_seq between 1224 and 1224+11\\n \\t\\t\\t    and d_date_sk = ss_sold_date_sk\\n \\t\\t\\t    and s_store_sk  = ss_store_sk\\n                      group by s_state\\n                     ) tmp1 \\n               where ranking <= 5\\n             )\\n group by rollup(s_state,s_county)\\n order by\\n   lochierarchy desc\\n  ,case when lochierarchy = 0 then s_state end\\n  ,rank_within_parent\\n limit 100;",
    "benchmarkResult": {
      "total": 16.54952,
      "compilation": 3.5624200000000004,
      "execution": 12.9871,
      "scale": 2953478.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"3\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"3\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"3\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"3\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"836455\\" exact_cardinality=\\"536455\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\"><Select operator_id=\\"7\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Window operator_id=\\"8\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"843114\\" exact_cardinality=\\"536455\\"><TableScan operator_id=\\"11\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><PipelineBreakerScan operator_id=\\"12\\" scanned_id=\\"13\\" estimated_cardinality=\\"843114\\" exact_cardinality=\\"536455\\"><Temp operator_id=\\"13\\" estimated_cardinality=\\"843114\\" exact_cardinality=\\"536455\\"><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"843114\\" exact_cardinality=\\"536455\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"16\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Temp></PipelineBreakerScan></Join></GroupBy></Window></Select><TableScan operator_id=\\"17\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /></Join><PipelineBreakerScan operator_id=\\"18\\" scanned_id=\\"13\\" estimated_cardinality=\\"843114\\" exact_cardinality=\\"536455\\" /></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "71.sql",
    "queryText": "select i_brand_id brand_id, i_brand brand,t_hour,t_minute,\\n \\tsum(ext_price) ext_price\\n from item, (select ws_ext_sales_price as ext_price, \\n                        ws_sold_date_sk as sold_date_sk,\\n                        ws_item_sk as sold_item_sk,\\n                        ws_sold_time_sk as time_sk  \\n                 from web_sales,date_dim\\n                 where d_date_sk = ws_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 union all\\n                 select cs_ext_sales_price as ext_price,\\n                        cs_sold_date_sk as sold_date_sk,\\n                        cs_item_sk as sold_item_sk,\\n                        cs_sold_time_sk as time_sk\\n                 from catalog_sales,date_dim\\n                 where d_date_sk = cs_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 union all\\n                 select ss_ext_sales_price as ext_price,\\n                        ss_sold_date_sk as sold_date_sk,\\n                        ss_item_sk as sold_item_sk,\\n                        ss_sold_time_sk as time_sk\\n                 from store_sales,date_dim\\n                 where d_date_sk = ss_sold_date_sk\\n                   and d_moy=12\\n                   and d_year=1998\\n                 ) tmp,time_dim\\n where\\n   sold_item_sk = i_item_sk\\n   and i_manager_id=1\\n   and time_sk = t_time_sk\\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\\n group by i_brand, i_brand_id,t_hour,t_minute\\n order by ext_price desc, i_brand_id\\n ;",
    "benchmarkResult": {
      "total": 12.22198,
      "compilation": 2.73762,
      "execution": 9.48436,
      "scale": 5364884.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"661\\" exact_cardinality=\\"1066\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"661\\" exact_cardinality=\\"1066\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"661\\" exact_cardinality=\\"1066\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"735\\" exact_cardinality=\\"1090\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2214\\" exact_cardinality=\\"2846\\"><TableScan operator_id=\\"5\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"333\\" exact_cardinality=\\"321\\" /><SetOperation operator_id=\\"6\\" type=\\"unionall\\" estimated_cardinality=\\"126328\\" exact_cardinality=\\"165529\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18888\\" exact_cardinality=\\"25137\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"9\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719105\\" /></Join><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"81947\\" exact_cardinality=\\"91810\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"12\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2683501\\" exact_cardinality=\\"2685616\\" /></Join><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"25493\\" exact_cardinality=\\"48582\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"15\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1430856\\" /></Join></SetOperation></Join><TableScan operator_id=\\"16\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"25312\\" exact_cardinality=\\"25200\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "72.sql",
    "queryText": "select  i_item_desc\\n      ,w_warehouse_name\\n      ,d1.d_week_seq\\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\\n      ,count(*) total_cnt\\nfrom catalog_sales\\njoin inventory on (cs_item_sk = inv_item_sk)\\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\\njoin item on (i_item_sk = cs_item_sk)\\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\\nwhere d1.d_week_seq = d2.d_week_seq\\n  and inv_quantity_on_hand < cs_quantity \\n  and d3.d_date > d1.d_date + interval '5 days'\\n  and hd_buy_potential = '>10000'\\n  and d1.d_year = 1998\\n  and cd_marital_status = 'D'\\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\\nlimit 100;",
    "benchmarkResult": {
      "total": 58.81367,
      "compilation": 3.4525699999999997,
      "execution": 55.3611,
      "scale": 15352001.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"745571\\" exact_cardinality=\\"2022\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4593100.0\\" exact_cardinality=\\"2032\\"><TableScan operator_id=\\"4\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"4787954\\" exact_cardinality=\\"2032\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"51357\\" exact_cardinality=\\"62426\\"><Join operator_id=\\"7\\" type=\\"rightouter\\" method=\\"hash\\" estimated_cardinality=\\"6365\\" exact_cardinality=\\"8918\\"><TableScan operator_id=\\"8\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"300\\" exact_cardinality=\\"300\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4811\\" exact_cardinality=\\"8918\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4186\\" exact_cardinality=\\"9337\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3981\\" exact_cardinality=\\"9337\\"><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"20180\\" exact_cardinality=\\"48004\\"><TableScan operator_id=\\"13\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1272\\" exact_cardinality=\\"1200\\" /><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"113153\\" exact_cardinality=\\"284979\\"><TableScan operator_id=\\"15\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"285\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"16\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1433101\\" exact_cardinality=\\"1434457\\" /></Join></Join><TableScan operator_id=\\"17\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"378907\\" exact_cardinality=\\"378907\\" /></Join><TableScan operator_id=\\"18\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><TableScan operator_id=\\"19\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></Join><TableScan operator_id=\\"20\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"21\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"11160043\\" exact_cardinality=\\"11160043\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "73.sql",
    "queryText": "select c_last_name\\n       ,c_first_name\\n       ,c_salutation\\n       ,c_preferred_cust_flag \\n       ,ss_ticket_number\\n       ,cnt from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,count(*) cnt\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and date_dim.d_dom between 1 and 2 \\n    and (household_demographics.hd_buy_potential = '1001-5000' or\\n         household_demographics.hd_buy_potential = '0-500')\\n    and household_demographics.hd_vehicle_count > 0\\n    and case when household_demographics.hd_vehicle_count > 0 then \\n             household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1\\n    and date_dim.d_year in (2000,2000+1,2000+2)\\n    and store.s_county in ('Walker County','Williamson County','Ziebach County','Walker County')\\n    group by ss_ticket_number,ss_customer_sk) dj,customer\\n    where ss_customer_sk = c_customer_sk\\n      and cnt between 1 and 5\\n    order by cnt desc, c_last_name asc;",
    "benchmarkResult": {
      "total": 8.51958,
      "compilation": 2.6122699999999996,
      "execution": 5.90731,
      "scale": 3060666.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"6172\\" exact_cardinality=\\"4\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"6172\\" exact_cardinality=\\"4\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"6172\\" exact_cardinality=\\"4\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"5929\\" exact_cardinality=\\"4\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"10964\\" exact_cardinality=\\"1008\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12182\\" exact_cardinality=\\"11077\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"12182\\" exact_cardinality=\\"11077\\"><TableScan operator_id=\\"8\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"773\\" exact_cardinality=\\"800\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"108140\\" exact_cardinality=\\"104474\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"72\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2655372\\" exact_cardinality=\\"2636740.0\\" /></Join></Join></Join></GroupBy></Select><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "74.sql",
    "queryText": "with year_total as (\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,d_year as year\\n       ,avg(ss_net_paid) year_total\\n       ,'s' sale_type\\n from customer\\n     ,store_sales\\n     ,date_dim\\n where c_customer_sk = ss_customer_sk\\n   and ss_sold_date_sk = d_date_sk\\n   and d_year in (1998,1998+1)\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,d_year\\n union all\\n select c_customer_id customer_id\\n       ,c_first_name customer_first_name\\n       ,c_last_name customer_last_name\\n       ,d_year as year\\n       ,avg(ws_net_paid) year_total\\n       ,'w' sale_type\\n from customer\\n     ,web_sales\\n     ,date_dim\\n where c_customer_sk = ws_bill_customer_sk\\n   and ws_sold_date_sk = d_date_sk\\n   and d_year in (1998,1998+1)\\n group by c_customer_id\\n         ,c_first_name\\n         ,c_last_name\\n         ,d_year\\n         )\\n  select \\n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\\n from year_total t_s_firstyear\\n     ,year_total t_s_secyear\\n     ,year_total t_w_firstyear\\n     ,year_total t_w_secyear\\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\\n         and t_s_firstyear.sale_type = 's'\\n         and t_w_firstyear.sale_type = 'w'\\n         and t_s_secyear.sale_type = 's'\\n         and t_w_secyear.sale_type = 'w'\\n         and t_s_firstyear.year = 1998\\n         and t_s_secyear.year = 1998+1\\n         and t_w_firstyear.year = 1998\\n         and t_w_secyear.year = 1998+1\\n         and t_s_firstyear.year_total > 0\\n         and t_w_firstyear.year_total > 0\\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\\n order by 3,1,2\\nlimit 100;",
    "benchmarkResult": {
      "total": 47.00808,
      "compilation": 3.35668,
      "execution": 43.6514,
      "scale": 3945887.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"99\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"99\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"473\\" exact_cardinality=\\"99\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1882\\" exact_cardinality=\\"1590\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"13441\\" exact_cardinality=\\"4132\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"94200\\" exact_cardinality=\\"11256\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\"><SetOperation operator_id=\\"8\\" type=\\"unionall\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\"><Select operator_id=\\"9\\" estimated_cardinality=\\"315495\\" exact_cardinality=\\"75699\\"><GroupBy operator_id=\\"10\\" mode=\\"regular\\" estimated_cardinality=\\"422755\\" exact_cardinality=\\"75699\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"469727\\" exact_cardinality=\\"1068858\\"><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"451225\\" exact_cardinality=\\"1068858\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"730\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></Join></GroupBy></Select><Select operator_id=\\"19\\" estimated_cardinality=\\"87562\\" exact_cardinality=\\"22565\\"><GroupBy operator_id=\\"20\\" mode=\\"regular\\" estimated_cardinality=\\"117330\\" exact_cardinality=\\"22565\\"><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"130367\\" exact_cardinality=\\"285923\\"><TableScan operator_id=\\"22\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"125232\\" exact_cardinality=\\"285923\\"><TableScan operator_id=\\"24\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"730\\" /><TableScan operator_id=\\"25\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join></Join></GroupBy></Select></SetOperation></Temp></PipelineBreakerScan></Select><Select operator_id=\\"17\\" estimated_cardinality=\\"94200\\" exact_cardinality=\\"37708\\"><PipelineBreakerScan operator_id=\\"26\\" scanned_id=\\"7\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\" /></Select></Join><Select operator_id=\\"18\\" estimated_cardinality=\\"222395\\" exact_cardinality=\\"37991\\"><PipelineBreakerScan operator_id=\\"27\\" scanned_id=\\"7\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\" /></Select></Join><Select operator_id=\\"16\\" estimated_cardinality=\\"222395\\" exact_cardinality=\\"11309\\"><PipelineBreakerScan operator_id=\\"28\\" scanned_id=\\"7\\" estimated_cardinality=\\"403057\\" exact_cardinality=\\"98264\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "75.sql",
    "queryText": "WITH all_sales AS (\\n SELECT d_year\\n       ,i_brand_id\\n       ,i_class_id\\n       ,i_category_id\\n       ,i_manufact_id\\n       ,SUM(sales_cnt) AS sales_cnt\\n       ,SUM(sales_amt) AS sales_amt\\n FROM (SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \\n                                                    AND cs_item_sk=cr_item_sk)\\n       WHERE i_category='Home'\\n       UNION\\n       SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \\n                                                AND ss_item_sk=sr_item_sk)\\n       WHERE i_category='Home'\\n       UNION\\n       SELECT d_year\\n             ,i_brand_id\\n             ,i_class_id\\n             ,i_category_id\\n             ,i_manufact_id\\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \\n                                            AND ws_item_sk=wr_item_sk)\\n       WHERE i_category='Home') sales_detail\\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\\n SELECT  prev_yr.d_year AS prev_year\\n                          ,curr_yr.d_year AS year\\n                          ,curr_yr.i_brand_id\\n                          ,curr_yr.i_class_id\\n                          ,curr_yr.i_category_id\\n                          ,curr_yr.i_manufact_id\\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\\n FROM all_sales curr_yr, all_sales prev_yr\\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\\n   AND curr_yr.i_class_id=prev_yr.i_class_id\\n   AND curr_yr.i_category_id=prev_yr.i_category_id\\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\\n   AND curr_yr.d_year=1999\\n   AND prev_yr.d_year=1999-1\\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\\n ORDER BY sales_cnt_diff,sales_amt_diff\\n limit 100;",
    "benchmarkResult": {
      "total": 62.06621,
      "compilation": 4.67941,
      "execution": 57.3868,
      "scale": 5817828.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"86108\\" exact_cardinality=\\"220\\"><Select operator_id=\\"4\\" estimated_cardinality=\\"16959\\" exact_cardinality=\\"880\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"74391\\" exact_cardinality=\\"1760\\"><Temp operator_id=\\"6\\" estimated_cardinality=\\"74391\\" exact_cardinality=\\"1760\\"><Select operator_id=\\"7\\" estimated_cardinality=\\"74391\\" exact_cardinality=\\"1760\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"74392\\" exact_cardinality=\\"1760\\"><SetOperation operator_id=\\"9\\" type=\\"union\\" estimated_cardinality=\\"82658\\" exact_cardinality=\\"190734\\"><Join operator_id=\\"10\\" type=\\"leftouter\\" method=\\"hash\\" estimated_cardinality=\\"24243\\" exact_cardinality=\\"55832\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"24126\\" exact_cardinality=\\"55832\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"730\\" /><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"164287\\" exact_cardinality=\\"142423\\"><TableScan operator_id=\\"14\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1951\\" exact_cardinality=\\"1803\\" /><TableScan operator_id=\\"15\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1441548\\" exact_cardinality=\\"1441548\\" /></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join><Join operator_id=\\"17\\" type=\\"leftouter\\" method=\\"hash\\" estimated_cardinality=\\"13681\\" exact_cardinality=\\"27983\\"><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"13616\\" exact_cardinality=\\"27983\\"><TableScan operator_id=\\"19\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"730\\" /><Join operator_id=\\"20\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"81985\\" exact_cardinality=\\"71117\\"><TableScan operator_id=\\"21\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1951\\" exact_cardinality=\\"1803\\" /><TableScan operator_id=\\"22\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"719384\\" exact_cardinality=\\"719384\\" /></Join></Join><TableScan operator_id=\\"23\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"71763\\" exact_cardinality=\\"71763\\" /></Join><Join operator_id=\\"24\\" type=\\"leftouter\\" method=\\"hash\\" estimated_cardinality=\\"53918\\" exact_cardinality=\\"107558\\"><Join operator_id=\\"25\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"53659\\" exact_cardinality=\\"107558\\"><TableScan operator_id=\\"26\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"356\\" exact_cardinality=\\"730\\" /><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"328267\\" exact_cardinality=\\"284578\\"><TableScan operator_id=\\"28\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1951\\" exact_cardinality=\\"1803\\" /><TableScan operator_id=\\"29\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2880404\\" exact_cardinality=\\"2880404\\" /></Join></Join><TableScan operator_id=\\"30\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /></Join></SetOperation></GroupBy></Select></Temp></PipelineBreakerScan></Select><Select operator_id=\\"31\\" estimated_cardinality=\\"54133\\" exact_cardinality=\\"880\\"><PipelineBreakerScan operator_id=\\"32\\" scanned_id=\\"6\\" estimated_cardinality=\\"74391\\" exact_cardinality=\\"1760\\" /></Select></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "76.sql",
    "queryText": "select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM (\\n        SELECT 'store' as channel, 'ss_customer_sk' col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price\\n         FROM store_sales, item, date_dim\\n         WHERE ss_customer_sk IS NULL\\n           AND ss_sold_date_sk=d_date_sk\\n           AND ss_item_sk=i_item_sk\\n        UNION ALL\\n        SELECT 'web' as channel, 'ws_warehouse_sk' col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price\\n         FROM web_sales, item, date_dim\\n         WHERE ws_warehouse_sk IS NULL\\n           AND ws_sold_date_sk=d_date_sk\\n           AND ws_item_sk=i_item_sk\\n        UNION ALL\\n        SELECT 'catalog' as channel, 'cs_bill_hdemo_sk' col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price\\n         FROM catalog_sales, item, date_dim\\n         WHERE cs_bill_hdemo_sk IS NULL\\n           AND cs_sold_date_sk=d_date_sk\\n           AND cs_item_sk=i_item_sk) foo\\nGROUP BY channel, col_name, d_year, d_qoy, i_category\\nORDER BY channel, col_name, d_year, d_qoy, i_category\\nlimit 100;",
    "benchmarkResult": {
      "total": 18.03679,
      "compilation": 2.9297899999999997,
      "execution": 15.107000000000001,
      "scale": 5314484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"36681\\" exact_cardinality=\\"511\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"56919\\" exact_cardinality=\\"68529\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"53243\\" exact_cardinality=\\"64858\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"50279\\" exact_cardinality=\\"64858\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"47819\\" exact_cardinality=\\"64858\\" /></Join><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3134\\" exact_cardinality=\\"3583\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2960\\" exact_cardinality=\\"3583\\"><TableScan operator_id=\\"11\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"2815\\" exact_cardinality=\\"3583\\" /><TableScan operator_id=\\"12\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"542\\" exact_cardinality=\\"88\\"><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"512\\" exact_cardinality=\\"88\\"><TableScan operator_id=\\"16\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"487\\" exact_cardinality=\\"88\\" /><TableScan operator_id=\\"17\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><TableScan operator_id=\\"18\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "77.sql",
    "queryText": "with ss as\\n (select s_store_sk,\\n         sum(ss_ext_sales_price) as sales,\\n         sum(ss_net_profit) as profit\\n from store_sales,\\n      date_dim,\\n      store\\n where ss_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date) \\n                  and (cast('2001-08-29' as date) +  interval '30 days') \\n       and ss_store_sk = s_store_sk\\n group by s_store_sk)\\n ,\\n sr as\\n (select s_store_sk,\\n         sum(sr_return_amt) as returns,\\n         sum(sr_net_loss) as profit_loss\\n from store_returns,\\n      date_dim,\\n      store\\n where sr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and sr_store_sk = s_store_sk\\n group by s_store_sk), \\n cs as\\n (select cs_call_center_sk,\\n        sum(cs_ext_sales_price) as sales,\\n        sum(cs_net_profit) as profit\\n from catalog_sales,\\n      date_dim\\n where cs_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n group by cs_call_center_sk \\n ), \\n cr as\\n (select cr_call_center_sk,\\n         sum(cr_return_amount) as returns,\\n         sum(cr_net_loss) as profit_loss\\n from catalog_returns,\\n      date_dim\\n where cr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n group by cr_call_center_sk\\n ), \\n ws as\\n ( select wp_web_page_sk,\\n        sum(ws_ext_sales_price) as sales,\\n        sum(ws_net_profit) as profit\\n from web_sales,\\n      date_dim,\\n      web_page\\n where ws_sold_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and ws_web_page_sk = wp_web_page_sk\\n group by wp_web_page_sk), \\n wr as\\n (select wp_web_page_sk,\\n        sum(wr_return_amt) as returns,\\n        sum(wr_net_loss) as profit_loss\\n from web_returns,\\n      date_dim,\\n      web_page\\n where wr_returned_date_sk = d_date_sk\\n       and d_date between cast('2001-08-29' as date)\\n                  and (cast('2001-08-29' as date) +  interval '30 days')\\n       and wr_web_page_sk = wp_web_page_sk\\n group by wp_web_page_sk)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , ss.s_store_sk as id\\n        , sales\\n        , coalesce(returns, 0) as returns\\n        , (profit - coalesce(profit_loss,0)) as profit\\n from   ss left join sr\\n        on  ss.s_store_sk = sr.s_store_sk\\n union all\\n select 'catalog channel' as channel\\n        , cs_call_center_sk as id\\n        , sales\\n        , returns\\n        , (profit - profit_loss) as profit\\n from  cs\\n       , cr\\n union all\\n select 'web channel' as channel\\n        , ws.wp_web_page_sk as id\\n        , sales\\n        , coalesce(returns, 0) as returns\\n        , (profit - coalesce(profit_loss,0)) as profit\\n from   ws left join wr\\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 13.91719,
      "compilation": 4.9388000000000005,
      "execution": 8.97839,
      "scale": 5983119.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"44\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"44\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"102\\" exact_cardinality=\\"44\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"119\\" exact_cardinality=\\"56\\"><Join operator_id=\\"4\\" type=\\"leftouter\\" method=\\"hash\\" estimated_cardinality=\\"8\\" exact_cardinality=\\"6\\"><GroupJoin operator_id=\\"5\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"7\\" exact_cardinality=\\"6\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1932\\" exact_cardinality=\\"59074\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"9\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></GroupJoin><GroupJoin operator_id=\\"10\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"4\\" exact_cardinality=\\"6\\"><EarlyProbe operator_id=\\"11\\" source=\\"4\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\"><TableScan operator_id=\\"12\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /></EarlyProbe><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"194\\" exact_cardinality=\\"3445\\"><TableScan operator_id=\\"14\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"15\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"270948\\" exact_cardinality=\\"272426\\" /></Join></GroupJoin></Join><Join operator_id=\\"16\\" type=\\"rightouter\\" method=\\"hash\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"30\\"><GroupJoin operator_id=\\"17\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"35\\" exact_cardinality=\\"40\\"><TableScan operator_id=\\"18\\" table_name=\\"web_page\\" table_size=\\"60\\" estimated_cardinality=\\"60\\" exact_cardinality=\\"60\\" /><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"1008\\"><TableScan operator_id=\\"20\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"21\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"66787\\" exact_cardinality=\\"67029\\" /></Join></GroupJoin><GroupJoin operator_id=\\"22\\" type=\\"inner\\" method=\\"eagerright\\" estimated_cardinality=\\"60\\" exact_cardinality=\\"30\\"><TableScan operator_id=\\"23\\" table_name=\\"web_page\\" table_size=\\"60\\" estimated_cardinality=\\"60\\" exact_cardinality=\\"60\\" /><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"515\\" exact_cardinality=\\"17064\\"><TableScan operator_id=\\"25\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"26\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719106\\" /></Join></GroupJoin></Join><Join operator_id=\\"27\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"40\\" exact_cardinality=\\"20\\"><GroupBy operator_id=\\"28\\" mode=\\"regular\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"4\\"><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1025\\" exact_cardinality=\\"32165\\"><TableScan operator_id=\\"30\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"31\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></GroupBy><GroupBy operator_id=\\"32\\" mode=\\"regular\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"5\\"><Join operator_id=\\"33\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"103\\" exact_cardinality=\\"1482\\"><TableScan operator_id=\\"34\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"35\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join></GroupBy></Join></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "78.sql",
    "queryText": "with ws as\\n  (select d_year AS ws_sold_year, ws_item_sk,\\n    ws_bill_customer_sk ws_customer_sk,\\n    sum(ws_quantity) ws_qty,\\n    sum(ws_wholesale_cost) ws_wc,\\n    sum(ws_sales_price) ws_sp\\n   from web_sales\\n   left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk\\n   join date_dim on ws_sold_date_sk = d_date_sk\\n   where wr_order_number is null\\n   group by d_year, ws_item_sk, ws_bill_customer_sk\\n   ),\\ncs as\\n  (select d_year AS cs_sold_year, cs_item_sk,\\n    cs_bill_customer_sk cs_customer_sk,\\n    sum(cs_quantity) cs_qty,\\n    sum(cs_wholesale_cost) cs_wc,\\n    sum(cs_sales_price) cs_sp\\n   from catalog_sales\\n   left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk\\n   join date_dim on cs_sold_date_sk = d_date_sk\\n   where cr_order_number is null\\n   group by d_year, cs_item_sk, cs_bill_customer_sk\\n   ),\\nss as\\n  (select d_year AS ss_sold_year, ss_item_sk,\\n    ss_customer_sk,\\n    sum(ss_quantity) ss_qty,\\n    sum(ss_wholesale_cost) ss_wc,\\n    sum(ss_sales_price) ss_sp\\n   from store_sales\\n   left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk\\n   join date_dim on ss_sold_date_sk = d_date_sk\\n   where sr_ticket_number is null\\n   group by d_year, ss_item_sk, ss_customer_sk\\n   )\\n select \\nss_customer_sk,\\nround(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2)::integer ratio,\\nss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price,\\ncoalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty,\\ncoalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost,\\ncoalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price\\nfrom ss\\nleft join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk)\\nleft join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk)\\nwhere (coalesce(ws_qty,0)>0 or coalesce(cs_qty, 0)>0) and ss_sold_year=2002\\norder by \\n  ss_customer_sk,\\n  ss_qty desc, ss_wc desc, ss_sp desc,\\n  other_chan_qty,\\n  other_chan_wholesale_cost,\\n  other_chan_sales_price,\\n  ratio\\nlimit 100;",
    "benchmarkResult": {
      "total": 75.09543,
      "compilation": 3.72643,
      "execution": 71.369,
      "scale": 5763828.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"4\\" type=\\"rightouter\\" method=\\"hash\\" estimated_cardinality=\\"1205974\\" exact_cardinality=\\"196\\"><GroupBy operator_id=\\"5\\" mode=\\"regular\\" estimated_cardinality=\\"370155\\" exact_cardinality=\\"256795\\"><Join operator_id=\\"6\\" type=\\"rightanti\\" method=\\"hash\\" estimated_cardinality=\\"411283\\" exact_cardinality=\\"256845\\"><TableScan operator_id=\\"7\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"454510\\" exact_cardinality=\\"285286\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"10\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1441548\\" exact_cardinality=\\"1441548\\" /></Join></Join></GroupBy><Join operator_id=\\"11\\" type=\\"rightouter\\" method=\\"hash\\" estimated_cardinality=\\"948236\\" exact_cardinality=\\"489260\\"><GroupBy operator_id=\\"12\\" mode=\\"regular\\" estimated_cardinality=\\"161860\\" exact_cardinality=\\"128249\\"><Join operator_id=\\"13\\" type=\\"rightanti\\" method=\\"hash\\" estimated_cardinality=\\"179844\\" exact_cardinality=\\"128249\\"><TableScan operator_id=\\"14\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"71763\\" exact_cardinality=\\"71763\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"198710\\" exact_cardinality=\\"142498\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"17\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"719384\\" exact_cardinality=\\"719384\\" /></Join></Join></GroupBy><GroupBy operator_id=\\"18\\" mode=\\"regular\\" estimated_cardinality=\\"669127\\" exact_cardinality=\\"489260\\"><Join operator_id=\\"19\\" type=\\"rightanti\\" method=\\"hash\\" estimated_cardinality=\\"743474\\" exact_cardinality=\\"494626\\"><TableScan operator_id=\\"20\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"821516\\" exact_cardinality=\\"549330\\"><TableScan operator_id=\\"22\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"23\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2880404\\" exact_cardinality=\\"2880404\\" /></Join></Join></GroupBy></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "79.sql",
    "queryText": "select \\n  c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit\\n  from\\n   (select ss_ticket_number\\n          ,ss_customer_sk\\n          ,store.s_city\\n          ,sum(ss_coupon_amt) amt\\n          ,sum(ss_net_profit) profit\\n    from store_sales,date_dim,store,household_demographics\\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n    and store_sales.ss_store_sk = store.s_store_sk  \\n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\\n    and (household_demographics.hd_dep_count = 9 or household_demographics.hd_vehicle_count > 3)\\n    and date_dim.d_dow = 1\\n    and date_dim.d_year in (1999,1999+1,1999+2) \\n    and store.s_number_employees between 200 and 295\\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\\n    where ss_customer_sk = c_customer_sk\\n order by c_last_name,c_first_name,substr(s_city,1,30), profit\\nlimit 100;",
    "benchmarkResult": {
      "total": 10.10613,
      "compilation": 2.3956899999999997,
      "execution": 7.71044,
      "scale": 3060666.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"26018\\" exact_cardinality=\\"4423\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"24993\\" exact_cardinality=\\"4423\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"27770\\" exact_cardinality=\\"46890\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"11\\" exact_cardinality=\\"11\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"30295\\" exact_cardinality=\\"56789\\"><TableScan operator_id=\\"8\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1863\\" exact_cardinality=\\"1800\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"115981\\" exact_cardinality=\\"225868\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"157\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2655372\\" exact_cardinality=\\"2636740.0\\" /></Join></Join></Join></GroupBy><TableScan operator_id=\\"12\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "80.sql",
    "queryText": "with ssr as\\n (select  s_store_id as store_id,\\n          sum(ss_ext_sales_price) as sales,\\n          sum(coalesce(sr_return_amt, 0)) as returns,\\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\\n  from store_sales left outer join store_returns on\\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\\n     date_dim,\\n     store,\\n     item,\\n     promotion\\n where ss_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date) \\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n       and ss_store_sk = s_store_sk\\n       and ss_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and ss_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\n group by s_store_id)\\n ,\\n csr as\\n (select  cp_catalog_page_id as catalog_page_id,\\n          sum(cs_ext_sales_price) as sales,\\n          sum(coalesce(cr_return_amount, 0)) as returns,\\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\\n  from catalog_sales left outer join catalog_returns on\\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\\n     date_dim,\\n     catalog_page,\\n     item,\\n     promotion\\n where cs_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date)\\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n        and cs_catalog_page_sk = cp_catalog_page_sk\\n       and cs_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and cs_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\ngroup by cp_catalog_page_id)\\n ,\\n wsr as\\n (select  web_site_id,\\n          sum(ws_ext_sales_price) as sales,\\n          sum(coalesce(wr_return_amt, 0)) as returns,\\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\\n  from web_sales left outer join web_returns on\\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\\n     date_dim,\\n     web_site,\\n     item,\\n     promotion\\n where ws_sold_date_sk = d_date_sk\\n       and d_date between cast('2000-08-22' as date)\\n                  and (cast('2000-08-22' as date) +  interval '30 days')\\n        and ws_web_site_sk = web_site_sk\\n       and ws_item_sk = i_item_sk\\n       and i_current_price > 50\\n       and ws_promo_sk = p_promo_sk\\n       and p_channel_tv = 'N'\\ngroup by web_site_id)\\n  select  channel\\n        , id\\n        , sum(sales) as sales\\n        , sum(returns) as returns\\n        , sum(profit) as profit\\n from \\n (select 'store channel' as channel\\n        , 'store' || store_id as id\\n        , sales\\n        , returns\\n        , profit\\n from   ssr\\n union all\\n select 'catalog channel' as channel\\n        , 'catalog_page' || catalog_page_id as id\\n        , sales\\n        , returns\\n        , profit\\n from  csr\\n union all\\n select 'web channel' as channel\\n        , 'web_site' || web_site_id as id\\n        , sales\\n        , returns\\n        , profit\\n from   wsr\\n ) x\\n group by rollup (channel, id)\\n order by channel\\n         ,id\\n limit 100;",
    "benchmarkResult": {
      "total": 26.00408,
      "compilation": 4.57688,
      "execution": 21.4272,
      "scale": 5830488.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"100\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"432\\"><SetOperation operator_id=\\"3\\" type=\\"unionall\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"428\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\"><Join operator_id=\\"5\\" type=\\"leftouter\\" method=\\"indexnl\\" estimated_cardinality=\\"73\\" exact_cardinality=\\"3406\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"73\\" exact_cardinality=\\"3406\\"><TableScan operator_id=\\"7\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"73\\" exact_cardinality=\\"3406\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"85\\" exact_cardinality=\\"3486\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1072\\" exact_cardinality=\\"1055\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1351\\" exact_cardinality=\\"60707\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><EarlyProbe operator_id=\\"13\\" source=\\"6\\" estimated_cardinality=\\"1885031\\" exact_cardinality=\\"2653425\\"><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2660998\\" exact_cardinality=\\"2653425\\" /></EarlyProbe></Join></Join><TableScan operator_id=\\"15\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"294\\" exact_cardinality=\\"294\\" /></Join></Join><TableScan operator_id=\\"16\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"287514\\" exact_cardinality=\\"287514\\" /></Join></GroupBy><GroupBy operator_id=\\"17\\" mode=\\"regular\\" estimated_cardinality=\\"15\\" exact_cardinality=\\"15\\"><Join operator_id=\\"18\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"22\\" exact_cardinality=\\"883\\"><TableScan operator_id=\\"19\\" table_name=\\"web_site\\" table_size=\\"30\\" estimated_cardinality=\\"30\\" exact_cardinality=\\"30\\" /><Join operator_id=\\"20\\" type=\\"leftouter\\" method=\\"indexnl\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"883\\"><Join operator_id=\\"21\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"883\\"><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"899\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"373\\" exact_cardinality=\\"16183\\"><TableScan operator_id=\\"24\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><EarlyProbe operator_id=\\"25\\" source=\\"18\\" estimated_cardinality=\\"520641\\" exact_cardinality=\\"719057\\"><TableScan operator_id=\\"26\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719057\\" /></EarlyProbe></Join><TableScan operator_id=\\"27\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1072\\" exact_cardinality=\\"1072\\" /></Join><TableScan operator_id=\\"28\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"294\\" exact_cardinality=\\"294\\" /></Join><TableScan operator_id=\\"29\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"71763\\" exact_cardinality=\\"71763\\" /></Join></Join></GroupBy><GroupBy operator_id=\\"30\\" mode=\\"regular\\" estimated_cardinality=\\"50\\" exact_cardinality=\\"407\\"><Join operator_id=\\"31\\" type=\\"leftouter\\" method=\\"indexnl\\" estimated_cardinality=\\"55\\" exact_cardinality=\\"1781\\"><Join operator_id=\\"32\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"55\\" exact_cardinality=\\"1781\\"><Join operator_id=\\"33\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"55\\" exact_cardinality=\\"1781\\"><Join operator_id=\\"34\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"64\\" exact_cardinality=\\"1822\\"><TableScan operator_id=\\"35\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1072\\" exact_cardinality=\\"1055\\" /><Join operator_id=\\"36\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1022\\" exact_cardinality=\\"31521\\"><TableScan operator_id=\\"37\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"38\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1426062\\" exact_cardinality=\\"1429035\\" /></Join></Join><TableScan operator_id=\\"39\\" table_name=\\"promotion\\" table_size=\\"300\\" estimated_cardinality=\\"294\\" exact_cardinality=\\"294\\" /></Join><TableScan operator_id=\\"40\\" table_name=\\"catalog_page\\" table_size=\\"11718\\" estimated_cardinality=\\"11718\\" exact_cardinality=\\"11718\\" /></Join><TableScan operator_id=\\"41\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join></GroupBy></SetOperation></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "81.sql",
    "queryText": "with customer_total_return as\\n (select cr_returning_customer_sk as ctr_customer_sk\\n        ,ca_state as ctr_state, \\n \\tsum(cr_return_amt_inc_tax) as ctr_total_return\\n from catalog_returns\\n     ,date_dim\\n     ,customer_address\\n where cr_returned_date_sk = d_date_sk \\n   and d_year =1999\\n   and cr_returning_addr_sk = ca_address_sk \\n group by cr_returning_customer_sk\\n         ,ca_state )\\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\\n                  ,ca_location_type,ctr_total_return\\n from customer_total_return ctr1\\n     ,customer_address\\n     ,customer\\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\\n \\t\\t\\t  from customer_total_return ctr2 \\n                  \\t  where ctr1.ctr_state = ctr2.ctr_state)\\n       and ca_address_sk = c_current_addr_sk\\n       and ca_state = 'CO'\\n       and ctr1.ctr_customer_sk = c_customer_sk\\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\\n                  ,ca_location_type,ctr_total_return\\n limit 100;",
    "benchmarkResult": {
      "total": 9.69397,
      "compilation": 2.6332500000000003,
      "execution": 7.060720000000001,
      "scale": 417117.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"63\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"63\\" exact_cardinality=\\"100\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"63\\" exact_cardinality=\\"154\\"><Select operator_id=\\"3\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"51\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"48\\" exact_cardinality=\\"51\\"><Select operator_id=\\"5\\" estimated_cardinality=\\"4349\\" exact_cardinality=\\"27049\\"><PipelineBreakerScan operator_id=\\"6\\" scanned_id=\\"7\\" estimated_cardinality=\\"4440\\" exact_cardinality=\\"27887\\"><Temp operator_id=\\"7\\" estimated_cardinality=\\"4440\\" exact_cardinality=\\"27887\\"><Select operator_id=\\"8\\" estimated_cardinality=\\"4440\\" exact_cardinality=\\"27887\\"><GroupBy operator_id=\\"9\\" mode=\\"regular\\" estimated_cardinality=\\"4440\\" exact_cardinality=\\"27893\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4934\\" exact_cardinality=\\"28314\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4934\\" exact_cardinality=\\"28314\\"><TableScan operator_id=\\"12\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"13\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"140549\\" exact_cardinality=\\"141223\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"50000\\" exact_cardinality=\\"50000\\" /></Join></GroupBy></Select></Temp></PipelineBreakerScan></Select></GroupBy></Select><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"86\\" exact_cardinality=\\"586\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1854\\" exact_cardinality=\\"1985\\"><TableScan operator_id=\\"18\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"927\\" exact_cardinality=\\"980\\" /><TableScan operator_id=\\"19\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /></Join><Select operator_id=\\"15\\" estimated_cardinality=\\"4439\\" exact_cardinality=\\"27686\\"><PipelineBreakerScan operator_id=\\"20\\" scanned_id=\\"7\\" estimated_cardinality=\\"4440\\" exact_cardinality=\\"27887\\" /></Select></Join></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "82.sql",
    "queryText": "select  i_item_id\\n       ,i_item_desc\\n       ,i_current_price\\n from item, inventory, date_dim, store_sales\\n where i_current_price between 34 and 34+30\\n and inv_item_sk = i_item_sk\\n and d_date_sk=inv_date_sk\\n and d_date between cast('2002-04-30' as date) and (cast('2002-04-30' as date) +  interval '60 days')\\n and i_manufact_id in (840,109,510,582)\\n and inv_quantity_on_hand between 100 and 500\\n and ss_item_sk = i_item_sk\\n group by i_item_id,i_item_desc,i_current_price\\n order by i_item_id\\n limit 100;",
    "benchmarkResult": {
      "total": 11.93559,
      "compilation": 1.63809,
      "execution": 10.2975,
      "scale": 14716454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"1\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"1\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"400\\" exact_cardinality=\\"1020\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"15\\"><TableScan operator_id=\\"5\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3314\\" exact_cardinality=\\"98\\"><TableScan operator_id=\\"7\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"1\\" /><TableScan operator_id=\\"8\\" table_name=\\"inventory\\" table_size=\\"11745000.0\\" estimated_cardinality=\\"4656708\\" exact_cardinality=\\"4469511\\" /></Join></Join><TableScan operator_id=\\"9\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2880404\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "83.sql",
    "queryText": "with sr_items as\\n (select i_item_id item_id,\\n        sum(sr_return_quantity) sr_item_qty\\n from store_returns,\\n      item,\\n      date_dim\\n where sr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t  where d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   sr_returned_date_sk   = d_date_sk\\n group by i_item_id),\\n cr_items as\\n (select i_item_id item_id,\\n        sum(cr_return_quantity) cr_item_qty\\n from catalog_returns,\\n      item,\\n      date_dim\\n where cr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t  where d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   cr_returned_date_sk   = d_date_sk\\n group by i_item_id),\\n wr_items as\\n (select i_item_id item_id,\\n        sum(wr_return_quantity) wr_item_qty\\n from web_returns,\\n      item,\\n      date_dim\\n where wr_item_sk = i_item_sk\\n and   d_date    in \\n\\t(select d_date\\n\\tfrom date_dim\\n\\twhere d_week_seq in \\n\\t\\t(select d_week_seq\\n\\t\\tfrom date_dim\\n\\t\\twhere d_date in ('2000-05-29','2000-10-01','2000-11-04')))\\n and   wr_returned_date_sk   = d_date_sk\\n group by i_item_id)\\n  select  sr_items.item_id\\n       ,sr_item_qty\\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\\n       ,cr_item_qty\\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\\n       ,wr_item_qty\\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\\n from sr_items\\n     ,cr_items\\n     ,wr_items\\n where sr_items.item_id=cr_items.item_id\\n   and sr_items.item_id=wr_items.item_id \\n order by sr_items.item_id\\n         ,sr_item_qty\\n limit 100;",
    "benchmarkResult": {
      "total": 7.79301,
      "compilation": 3.7133700000000003,
      "execution": 4.0796399999999995,
      "scale": 776492.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"26\\" exact_cardinality=\\"25\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"26\\" exact_cardinality=\\"25\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"26\\" exact_cardinality=\\"25\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"29\\" exact_cardinality=\\"32\\"><PipelineBreakerScan operator_id=\\"5\\" scanned_id=\\"6\\" estimated_cardinality=\\"414\\" exact_cardinality=\\"21\\"><Temp operator_id=\\"6\\" estimated_cardinality=\\"414\\" exact_cardinality=\\"21\\"><Join operator_id=\\"7\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"414\\" exact_cardinality=\\"21\\"><Join operator_id=\\"8\\" type=\\"rightsemi\\" method=\\"hash\\" estimated_cardinality=\\"392\\" exact_cardinality=\\"21\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"3\\" /><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"73049\\" exact_cardinality=\\"73049\\" /></Join></Temp></PipelineBreakerScan><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"4766\\" exact_cardinality=\\"2881\\"><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"294\\" exact_cardinality=\\"206\\"><Join operator_id=\\"14\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"136\\" exact_cardinality=\\"97\\"><GroupBy operator_id=\\"15\\" mode=\\"regular\\" estimated_cardinality=\\"388\\" exact_cardinality=\\"702\\"><Join operator_id=\\"16\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"432\\" exact_cardinality=\\"726\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"410\\" exact_cardinality=\\"726\\"><PipelineBreakerScan operator_id=\\"18\\" scanned_id=\\"6\\" estimated_cardinality=\\"414\\" exact_cardinality=\\"21\\" /><TableScan operator_id=\\"19\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"68399\\" exact_cardinality=\\"68636\\" /></Join><TableScan operator_id=\\"20\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join></GroupBy><GroupBy operator_id=\\"21\\" mode=\\"regular\\" estimated_cardinality=\\"286\\" exact_cardinality=\\"106\\"><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"318\\" exact_cardinality=\\"116\\"><Join operator_id=\\"23\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"864\\" exact_cardinality=\\"1391\\"><PipelineBreakerScan operator_id=\\"24\\" scanned_id=\\"6\\" estimated_cardinality=\\"414\\" exact_cardinality=\\"21\\" /><TableScan operator_id=\\"25\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"144067\\" exact_cardinality=\\"144067\\" /></Join><EarlyProbe operator_id=\\"26\\" source=\\"14\\" estimated_cardinality=\\"6304\\" exact_cardinality=\\"1596\\"><TableScan operator_id=\\"27\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></EarlyProbe></Join></GroupBy></Join><TableScan operator_id=\\"28\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /></Join><TableScan operator_id=\\"29\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"277406\\" exact_cardinality=\\"277502\\" /></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "84.sql",
    "queryText": "select  c_customer_id as customer_id\\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\\n from customer\\n     ,customer_address\\n     ,customer_demographics\\n     ,household_demographics\\n     ,income_band\\n     ,store_returns\\n where ca_city\\t        =  'Hamilton'\\n   and c_current_addr_sk = ca_address_sk\\n   and ib_lower_bound   >=  51361\\n   and ib_upper_bound   <=  51361 + 50000\\n   and ib_income_band_sk = hd_income_band_sk\\n   and cd_demo_sk = c_current_cdemo_sk\\n   and hd_demo_sk = c_current_hdemo_sk\\n   and sr_cdemo_sk = cd_demo_sk\\n order by c_customer_id\\n limit 100;",
    "benchmarkResult": {
      "total": 4.4683600000000006,
      "compilation": 1.81033,
      "execution": 2.65803,
      "scale": 2365515.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"19\\" exact_cardinality=\\"17\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"19\\" exact_cardinality=\\"17\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"19\\" exact_cardinality=\\"17\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"65\\" exact_cardinality=\\"17\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"125\\" exact_cardinality=\\"146\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"639\\" exact_cardinality=\\"788\\"><TableScan operator_id=\\"7\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"341\\" exact_cardinality=\\"402\\" /><TableScan operator_id=\\"8\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"93750\\" exact_cardinality=\\"94811\\" /></Join><TableScan operator_id=\\"9\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1399\\" exact_cardinality=\\"1440\\" /></Join><TableScan operator_id=\\"10\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"276282\\" exact_cardinality=\\"277631\\" /></Join><TableScan operator_id=\\"11\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "85.sql",
    "queryText": "select  substr(r_reason_desc,1,20)\\n       ,avg(ws_quantity)\\n       ,avg(wr_refunded_cash)\\n       ,avg(wr_fee)\\n from web_sales, web_returns, web_page, customer_demographics cd1,\\n      customer_demographics cd2, customer_address, date_dim, reason \\n where ws_web_page_sk = wp_web_page_sk\\n   and ws_item_sk = wr_item_sk\\n   and ws_order_number = wr_order_number\\n   and ws_sold_date_sk = d_date_sk and d_year = 1999\\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\\n   and ca_address_sk = wr_refunded_addr_sk\\n   and r_reason_sk = wr_reason_sk\\n   and\\n   (\\n    (\\n     cd1.cd_marital_status = 'U'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = 'Advanced Degree'\\n     and \\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 100.00 and 150.00\\n    )\\n   or\\n    (\\n     cd1.cd_marital_status = 'D'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = 'Secondary' \\n     and\\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 50.00 and 100.00\\n    )\\n   or\\n    (\\n     cd1.cd_marital_status = 'M'\\n     and\\n     cd1.cd_marital_status = cd2.cd_marital_status\\n     and\\n     cd1.cd_education_status = '2 yr Degree'\\n     and\\n     cd1.cd_education_status = cd2.cd_education_status\\n     and\\n     ws_sales_price between 150.00 and 200.00\\n    )\\n   )\\n   and\\n   (\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('KY', 'OK', 'MO')\\n     and ws_net_profit between 100 and 200  \\n    )\\n    or\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('IN', 'AK', 'MN')\\n     and ws_net_profit between 150 and 300  \\n    )\\n    or\\n    (\\n     ca_country = 'United States'\\n     and\\n     ca_state in ('WI', 'KS', 'GA')\\n     and ws_net_profit between 50 and 250  \\n    )\\n   )\\ngroup by r_reason_desc\\norder by substr(r_reason_desc,1,20)\\n        ,avg(ws_quantity)\\n        ,avg(wr_refunded_cash)\\n        ,avg(wr_fee)\\nlimit 100;",
    "benchmarkResult": {
      "total": 11.478449999999999,
      "compilation": 3.05319,
      "execution": 8.42526,
      "scale": 4755892.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"3\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"10\\" exact_cardinality=\\"15\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"483\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1100\\" exact_cardinality=\\"4987\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"71\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"26695\\" exact_cardinality=\\"25628\\" /></Join><TableScan operator_id=\\"13\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"65385\\" exact_cardinality=\\"65773\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"193205\\" exact_cardinality=\\"193205\\" /></Join><TableScan operator_id=\\"15\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"13623\\" exact_cardinality=\\"13623\\" /></Join><TableScan operator_id=\\"16\\" table_name=\\"reason\\" table_size=\\"35\\" estimated_cardinality=\\"35\\" exact_cardinality=\\"35\\" /></Join><TableScan operator_id=\\"17\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"1920800.0\\" exact_cardinality=\\"1920800.0\\" /></Join><TableScan operator_id=\\"18\\" table_name=\\"web_page\\" table_size=\\"60\\" estimated_cardinality=\\"60\\" exact_cardinality=\\"60\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "86.sql",
    "queryText": "select   \\n    sum(ws_net_paid) as total_sum\\n   ,i_category\\n   ,i_class\\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\\n   ,rank() over (\\n \\tpartition by grouping(i_category)+grouping(i_class),\\n \\tcase when grouping(i_class) = 0 then i_category end \\n \\torder by sum(ws_net_paid) desc) as rank_within_parent\\n from\\n    web_sales\\n   ,date_dim       d1\\n   ,item\\n where\\n    d1.d_month_seq between 1191 and 1191+11\\n and d1.d_date_sk = ws_sold_date_sk\\n and i_item_sk  = ws_item_sk\\n group by rollup(i_category,i_class)\\n order by\\n   lochierarchy desc,\\n   case when lochierarchy = 0 then i_category end,\\n   rank_within_parent\\n limit 100;",
    "benchmarkResult": {
      "total": 7.98256,
      "compilation": 2.63324,
      "execution": 5.3493200000000005,
      "scale": 810434.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"119\\" exact_cardinality=\\"139\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"119\\" exact_cardinality=\\"139\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"57565\\" exact_cardinality=\\"143325\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"18000\\" exact_cardinality=\\"18000\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"54748\\" exact_cardinality=\\"143325\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"366\\" /><TableScan operator_id=\\"9\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></Join></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "87.sql",
    "queryText": "select count(*) \\nfrom ((select distinct c_last_name, c_first_name, d_date\\n       from store_sales, date_dim, customer\\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\\n         and store_sales.ss_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n       except\\n      (select distinct c_last_name, c_first_name, d_date\\n       from catalog_sales, date_dim, customer\\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n       except\\n      (select distinct c_last_name, c_first_name, d_date\\n       from web_sales, date_dim, customer\\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\\n         and d_month_seq between 1199 and 1199+11)\\n) cool_cust\\n;",
    "benchmarkResult": {
      "total": 29.718700000000002,
      "compilation": 2.7266,
      "execution": 26.9921,
      "scale": 5560484.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><SetOperation operator_id=\\"2\\" type=\\"except\\" estimated_cardinality=\\"325340\\" exact_cardinality=\\"47311\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"722978\\" exact_cardinality=\\"541478\\"><TableScan operator_id=\\"4\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"694501\\" exact_cardinality=\\"541478\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"366\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2697565\\" exact_cardinality=\\"2685453\\" /></Join></Join><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"166734\\" exact_cardinality=\\"142783\\"><TableScan operator_id=\\"9\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"160167\\" exact_cardinality=\\"142783\\"><TableScan operator_id=\\"11\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"366\\" /><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719119\\" /></Join></Join><Join operator_id=\\"13\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"351232\\" exact_cardinality=\\"287115\\"><TableScan operator_id=\\"14\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"100000\\" exact_cardinality=\\"100000\\" /><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"337398\\" exact_cardinality=\\"287115\\"><TableScan operator_id=\\"16\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"428\\" exact_cardinality=\\"366\\" /><TableScan operator_id=\\"17\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1428878\\" exact_cardinality=\\"1430939\\" /></Join></Join></SetOperation></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "88.sql",
    "queryText": "select  *\\nfrom\\n (select count(*) h8_30_to_9\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk   \\n     and ss_hdemo_sk = household_demographics.hd_demo_sk \\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 8\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) \\n     and store.s_store_name = 'ese') s1,\\n (select count(*) h9_to_9_30 \\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk \\n     and time_dim.t_hour = 9 \\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s2,\\n (select count(*) h9_30_to_10 \\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 9\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s3,\\n (select count(*) h10_to_10_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 10 \\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s4,\\n (select count(*) h10_30_to_11\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 10 \\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s5,\\n (select count(*) h11_to_11_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk \\n     and time_dim.t_hour = 11\\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s6,\\n (select count(*) h11_30_to_12\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 11\\n     and time_dim.t_minute >= 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s7,\\n (select count(*) h12_to_12_30\\n from store_sales, household_demographics , time_dim, store\\n where ss_sold_time_sk = time_dim.t_time_sk\\n     and ss_hdemo_sk = household_demographics.hd_demo_sk\\n     and ss_store_sk = s_store_sk\\n     and time_dim.t_hour = 12\\n     and time_dim.t_minute < 30\\n     and ((household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or\\n          (household_demographics.hd_dep_count = -1 and household_demographics.hd_vehicle_count<=-1+2) or\\n          (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))\\n     and store.s_store_name = 'ese') s8\\n;",
    "benchmarkResult": {
      "total": 25.252299999999998,
      "compilation": 6.6743999999999994,
      "execution": 18.5779,
      "scale": 23792033.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"1\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"2\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1965\\" exact_cardinality=\\"2515\\"><TableScan operator_id=\\"4\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"13037\\" exact_cardinality=\\"17717\\"><TableScan operator_id=\\"6\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1518\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"7\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"9\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2417\\" exact_cardinality=\\"2702\\"><TableScan operator_id=\\"11\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"16034\\" exact_cardinality=\\"15240\\"><TableScan operator_id=\\"13\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1856\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"14\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"15\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"16\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2236\\" exact_cardinality=\\"2287\\"><TableScan operator_id=\\"18\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"19\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"14832\\" exact_cardinality=\\"14922\\"><TableScan operator_id=\\"20\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1687\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"21\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"22\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"23\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"24\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2395\\" exact_cardinality=\\"3886\\"><TableScan operator_id=\\"25\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"26\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15887\\" exact_cardinality=\\"26912\\"><TableScan operator_id=\\"27\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1771\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"28\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"29\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"30\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"31\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2712\\" exact_cardinality=\\"4144\\"><TableScan operator_id=\\"32\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"33\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"17996\\" exact_cardinality=\\"27151\\"><TableScan operator_id=\\"34\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1940\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"35\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"36\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"37\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"38\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2315\\" exact_cardinality=\\"2502\\"><TableScan operator_id=\\"39\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"40\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"15360\\" exact_cardinality=\\"17611\\"><TableScan operator_id=\\"41\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1603\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"42\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><Join operator_id=\\"43\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"44\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"45\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2986\\" exact_cardinality=\\"1376\\"><TableScan operator_id=\\"46\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"47\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"19813\\" exact_cardinality=\\"8908\\"><TableScan operator_id=\\"48\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1771\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"49\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy><GroupBy operator_id=\\"50\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"51\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2844\\" exact_cardinality=\\"2634\\"><TableScan operator_id=\\"52\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1075\\" exact_cardinality=\\"1080\\" /><Join operator_id=\\"53\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"18872\\" exact_cardinality=\\"17857\\"><TableScan operator_id=\\"54\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1856\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"55\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy></Join></Join></Join></Join></Join></Join></Join></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "89.sql",
    "queryText": "select  *\\nfrom(\\nselect i_category, i_class, i_brand,\\n       s_store_name, s_company_name,\\n       d_moy,\\n       sum(ss_sales_price) sum_sales,\\n       avg(sum(ss_sales_price)) over\\n         (partition by i_category, i_brand, s_store_name, s_company_name)\\n         avg_monthly_sales\\nfrom item, store_sales, date_dim, store\\nwhere ss_item_sk = i_item_sk and\\n      ss_sold_date_sk = d_date_sk and\\n      ss_store_sk = s_store_sk and\\n      d_year in (2002) and\\n        ((i_category in ('Children','Home','Shoes') and\\n          i_class in ('school-uniforms','decor','athletic')\\n         )\\n      or (i_category in ('Men','Music','Jewelry') and\\n          i_class in ('shirts','rock','jewelry boxes') \\n        ))\\ngroup by i_category, i_class, i_brand,\\n         s_store_name, s_company_name, d_moy) tmp1\\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\\norder by sum_sales - avg_monthly_sales, s_store_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 16.77282,
      "compilation": 3.40182,
      "execution": 13.370999999999999,
      "scale": 2971466.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"100\\"><Select operator_id=\\"2\\" estimated_cardinality=\\"44014\\" exact_cardinality=\\"1709\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"88029\\" exact_cardinality=\\"1840\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"88029\\" exact_cardinality=\\"1840\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"97810\\" exact_cardinality=\\"61563\\"><TableScan operator_id=\\"6\\" table_name=\\"store\\" table_size=\\"12\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"12\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"97810\\" exact_cardinality=\\"61563\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"570\\" exact_cardinality=\\"365\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"312618\\" exact_cardinality=\\"303535\\"><TableScan operator_id=\\"10\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"1986\\" exact_cardinality=\\"2041\\" /><TableScan operator_id=\\"11\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2694752\\" exact_cardinality=\\"2685687\\" /></Join></Join></Join></GroupBy></Window></Select></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "90.sql",
    "queryText": "select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio\\n from ( select count(*) amc\\n       from web_sales, household_demographics , time_dim, web_page\\n       where ws_sold_time_sk = time_dim.t_time_sk\\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\\n         and ws_web_page_sk = web_page.wp_web_page_sk\\n         and time_dim.t_hour between 10 and 10+1\\n         and household_demographics.hd_dep_count = 7\\n         and web_page.wp_char_count between 5000 and 5200) at,\\n      ( select count(*) pmc\\n       from web_sales, household_demographics , time_dim, web_page\\n       where ws_sold_time_sk = time_dim.t_time_sk\\n         and ws_ship_hdemo_sk = household_demographics.hd_demo_sk\\n         and ws_web_page_sk = web_page.wp_web_page_sk\\n         and time_dim.t_hour between 20 and 20+1\\n         and household_demographics.hd_dep_count = 7\\n         and web_page.wp_char_count between 5000 and 5200) pt\\n order by am_pm_ratio\\n limit 100;",
    "benchmarkResult": {
      "total": 5.93346,
      "compilation": 2.82327,
      "execution": 3.1101900000000002,
      "scale": 1625969.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"bnl\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"3\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"200\\" exact_cardinality=\\"131\\"><TableScan operator_id=\\"5\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"787\\" exact_cardinality=\\"720\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1812\\" exact_cardinality=\\"1352\\"><TableScan operator_id=\\"7\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"7256\\" exact_cardinality=\\"7200\\" /><TableScan operator_id=\\"8\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"20373\\" exact_cardinality=\\"14052\\" /></Join></Join></GroupBy><GroupBy operator_id=\\"9\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"10\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"273\\" exact_cardinality=\\"205\\"><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2248\\" exact_cardinality=\\"1455\\"><TableScan operator_id=\\"12\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"787\\" exact_cardinality=\\"720\\" /><TableScan operator_id=\\"13\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"20373\\" exact_cardinality=\\"14052\\" /></Join><TableScan operator_id=\\"14\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"8437\\" exact_cardinality=\\"7200\\" /></Join></GroupBy></Join></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "91.sql",
    "queryText": "select  \\n        cc_call_center_id Call_Center,\\n        cc_name Call_Center_Name,\\n        cc_manager Manager,\\n        sum(cr_net_loss) Returns_Loss\\nfrom\\n        call_center,\\n        catalog_returns,\\n        date_dim,\\n        customer,\\n        customer_address,\\n        customer_demographics,\\n        household_demographics\\nwhere\\n        cr_call_center_sk       = cc_call_center_sk\\nand     cr_returned_date_sk     = d_date_sk\\nand     cr_returning_customer_sk= c_customer_sk\\nand     cd_demo_sk              = c_current_cdemo_sk\\nand     hd_demo_sk              = c_current_hdemo_sk\\nand     ca_address_sk           = c_current_addr_sk\\nand     d_year                  = 2000 \\nand     d_moy                   = 12\\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\\nand     hd_buy_potential like '501-1000%'\\nand     ca_gmt_offset           = -7\\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\\norder by sum(cr_net_loss) desc;",
    "benchmarkResult": {
      "total": 15.715459999999998,
      "compilation": 2.74466,
      "execution": 12.970799999999999,
      "scale": 2295123.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"4\\"><TableScan operator_id=\\"4\\" table_name=\\"call_center\\" table_size=\\"6\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"4\\"><TableScan operator_id=\\"6\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"23\\" exact_cardinality=\\"134\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"16\\" exact_cardinality=\\"102\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"95\\" exact_cardinality=\\"614\\"><TableScan operator_id=\\"10\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"5566\\" exact_cardinality=\\"5449\\" /><Join operator_id=\\"11\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"853\\" exact_cardinality=\\"667\\"><EarlyProbe operator_id=\\"12\\" source=\\"9\\" estimated_cardinality=\\"14564\\" exact_cardinality=\\"11257\\"><TableScan operator_id=\\"13\\" table_name=\\"customer\\" table_size=\\"100000\\" estimated_cardinality=\\"93750\\" exact_cardinality=\\"94811\\" /></EarlyProbe><TableScan operator_id=\\"14\\" table_name=\\"customer_demographics\\" table_size=\\"1920800.0\\" estimated_cardinality=\\"112546\\" exact_cardinality=\\"112546\\" /></Join></Join><TableScan operator_id=\\"15\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"1209\\" exact_cardinality=\\"1209\\" /></Join><TableScan operator_id=\\"16\\" table_name=\\"catalog_returns\\" table_size=\\"144067\\" estimated_cardinality=\\"138439\\" exact_cardinality=\\"139801\\" /></Join></Join></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "92.sql",
    "queryText": "select  \\n   sum(ws_ext_discount_amt)  as \\"Excess Discount Amount\\" \\nfrom \\n    web_sales \\n   ,item \\n   ,date_dim\\nwhere\\ni_manufact_id = 790\\nand i_item_sk = ws_item_sk \\nand d_date between '2002-03-17' and \\n        (cast('2002-03-17' as date) + interval '90 days')\\nand d_date_sk = ws_sold_date_sk \\nand ws_ext_discount_amt  \\n     > ( \\n         SELECT \\n            1.3 * avg(ws_ext_discount_amt) \\n         FROM \\n            web_sales \\n           ,date_dim\\n         WHERE \\n              ws_item_sk = i_item_sk \\n          and d_date between '2002-03-17' and\\n                             (cast('2002-03-17' as date) + interval '90 days')\\n          and d_date_sk = ws_sold_date_sk \\n      ) \\norder by sum(ws_ext_discount_amt)\\nlimit 100;",
    "benchmarkResult": {
      "total": 4.3380600000000005,
      "compilation": 1.75665,
      "execution": 2.58141,
      "scale": 1602867.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"3\\" exact_cardinality=\\"1\\"><TableScan operator_id=\\"3\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"91\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"42\\" exact_cardinality=\\"5\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"2\\"><TableScan operator_id=\\"6\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"12\\" exact_cardinality=\\"2\\" /><Select operator_id=\\"7\\" estimated_cardinality=\\"32\\" exact_cardinality=\\"2\\"><GroupBy operator_id=\\"8\\" mode=\\"regular\\" estimated_cardinality=\\"32\\" exact_cardinality=\\"2\\"><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"36\\" exact_cardinality=\\"3\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"142\\" exact_cardinality=\\"91\\" /><EarlyProbe operator_id=\\"11\\" source=\\"5\\" estimated_cardinality=\\"511\\" exact_cardinality=\\"50\\"><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719195\\" /></EarlyProbe></Join></GroupBy></Select></Join><TableScan operator_id=\\"13\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"718681\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "93.sql",
    "queryText": "select  ss_customer_sk\\n            ,sum(act_sales) sumsales\\n      from (select ss_item_sk\\n                  ,ss_ticket_number\\n                  ,ss_customer_sk\\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\\n                                                            else (ss_quantity*ss_sales_price) end act_sales\\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\\n                                                               and sr_ticket_number = ss_ticket_number)\\n                ,reason\\n            where sr_reason_sk = r_reason_sk\\n              and r_reason_desc = 'reason 47') t\\n      group by ss_customer_sk\\n      order by sumsales, ss_customer_sk\\nlimit 100;",
    "benchmarkResult": {
      "total": 4.0444700000000005,
      "compilation": 2.2135800000000003,
      "execution": 1.83089,
      "scale": 3167919.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"100\\" exact_cardinality=\\"0\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"7083\\" exact_cardinality=\\"0\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"7870\\" exact_cardinality=\\"0\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7870\\" exact_cardinality=\\"0\\"><EarlyExecution operator_id=\\"5\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"0\\"><TableScan operator_id=\\"6\\" table_name=\\"reason\\" table_size=\\"35\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\" /></EarlyExecution><TableScan operator_id=\\"7\\" table_name=\\"store_returns\\" table_size=\\"287514\\" estimated_cardinality=\\"275440\\" exact_cardinality=\\"277530\\" /></Join><TableScan operator_id=\\"8\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2880404\\" exact_cardinality=\\"2880404\\" /></Join></GroupBy></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "94.sql",
    "queryText": "select  \\n   count(distinct ws_order_number) as \\"order count\\"\\n  ,sum(ws_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(ws_net_profit) as \\"total net profit\\"\\nfrom\\n   web_sales ws1\\n  ,date_dim\\n  ,customer_address\\n  ,web_site\\nwhere\\n    d_date between '2002-2-01' and \\n           (cast('2002-2-01' as date) + interval '60 days')\\nand ws1.ws_ship_date_sk = d_date_sk\\nand ws1.ws_ship_addr_sk = ca_address_sk\\nand ca_state = 'IA'\\nand ws1.ws_web_site_sk = web_site_sk\\nand web_company_name = 'pri'\\nand exists (select *\\n            from web_sales ws2\\n            where ws1.ws_order_number = ws2.ws_order_number\\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\\nand not exists(select *\\n               from web_returns wr1\\n               where ws1.ws_order_number = wr1.wr_order_number)\\norder by count(distinct ws_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 7.610049999999999,
      "compilation": 3.76227,
      "execution": 3.8477799999999998,
      "scale": 1633611.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"171\\" exact_cardinality=\\"43\\"><Join operator_id=\\"3\\" type=\\"leftanti\\" method=\\"hash\\" estimated_cardinality=\\"189\\" exact_cardinality=\\"43\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"393\\" exact_cardinality=\\"130\\"><TableScan operator_id=\\"5\\" table_name=\\"web_site\\" table_size=\\"30\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"2141\\" exact_cardinality=\\"988\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"61\\" /><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"20353\\" exact_cardinality=\\"22697\\"><TableScan operator_id=\\"9\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"1416\\" exact_cardinality=\\"1555\\" /><TableScan operator_id=\\"10\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719067\\" /></Join></Join></Join><TableScan operator_id=\\"11\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"71763\\" exact_cardinality=\\"71763\\" /></Join><TableScan operator_id=\\"12\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"719384\\" exact_cardinality=\\"719384\\" /></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "95.sql",
    "queryText": "with ws_wh as\\n(select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2\\n from web_sales ws1,web_sales ws2\\n where ws1.ws_order_number = ws2.ws_order_number\\n   and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\\n select  \\n   count(distinct ws_order_number) as \\"order count\\"\\n  ,sum(ws_ext_ship_cost) as \\"total shipping cost\\"\\n  ,sum(ws_net_profit) as \\"total net profit\\"\\nfrom\\n   web_sales ws1\\n  ,date_dim\\n  ,customer_address\\n  ,web_site\\nwhere\\n    d_date between '1999-2-01' and \\n           (cast('1999-2-01' as date) + interval '60 days')\\nand ws1.ws_ship_date_sk = d_date_sk\\nand ws1.ws_ship_addr_sk = ca_address_sk\\nand ca_state = 'OR'\\nand ws1.ws_web_site_sk = web_site_sk\\nand web_company_name = 'pri'\\nand ws1.ws_order_number in (select ws_order_number\\n                            from ws_wh)\\nand ws1.ws_order_number in (select wr_order_number\\n                            from web_returns,ws_wh\\n                            where wr_order_number = ws_wh.ws_order_number)\\norder by count(distinct ws_order_number)\\nlimit 100;",
    "benchmarkResult": {
      "total": 45.25324,
      "compilation": 2.8129399999999998,
      "execution": 42.4403,
      "scale": 2352995.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"37\\"><Join operator_id=\\"3\\" type=\\"leftsemi\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"37\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"47\\"><TableScan operator_id=\\"5\\" table_name=\\"web_site\\" table_size=\\"30\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"indexnl\\" estimated_cardinality=\\"2\\" exact_cardinality=\\"47\\"><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"114\\" exact_cardinality=\\"4036\\"><TableScan operator_id=\\"8\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"61\\" /><EarlyProbe operator_id=\\"9\\" source=\\"4\\" estimated_cardinality=\\"158530\\" exact_cardinality=\\"95473\\"><TableScan operator_id=\\"10\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"718681\\" exact_cardinality=\\"719067\\" /></EarlyProbe></Join><TableScan operator_id=\\"11\\" table_name=\\"customer_address\\" table_size=\\"50000\\" estimated_cardinality=\\"781\\" exact_cardinality=\\"781\\" /></Join></Join><Join operator_id=\\"12\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"128\\" exact_cardinality=\\"6304\\"><EarlyProbe operator_id=\\"13\\" source=\\"3\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"46\\"><TableScan operator_id=\\"14\\" table_name=\\"web_returns\\" table_size=\\"71763\\" estimated_cardinality=\\"71763\\" exact_cardinality=\\"71763\\" /></EarlyProbe><PipelineBreakerScan operator_id=\\"15\\" scanned_id=\\"16\\" estimated_cardinality=\\"7613182\\" exact_cardinality=\\"6644004\\"><Temp operator_id=\\"16\\" estimated_cardinality=\\"7613182\\" exact_cardinality=\\"6644004\\"><Join operator_id=\\"17\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"7613182\\" exact_cardinality=\\"6644004\\"><TableScan operator_id=\\"18\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"719384\\" exact_cardinality=\\"719205\\" /><TableScan operator_id=\\"19\\" table_name=\\"web_sales\\" table_size=\\"719384\\" estimated_cardinality=\\"719384\\" exact_cardinality=\\"719205\\" /></Join></Temp></PipelineBreakerScan></Join></Join><PipelineBreakerScan operator_id=\\"20\\" scanned_id=\\"16\\" estimated_cardinality=\\"7613182\\" exact_cardinality=\\"6644004\\" /></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "96.sql",
    "queryText": "select  count(*) \\nfrom store_sales\\n    ,household_demographics \\n    ,time_dim, store\\nwhere ss_sold_time_sk = time_dim.t_time_sk   \\n    and ss_hdemo_sk = household_demographics.hd_demo_sk \\n    and ss_store_sk = s_store_sk\\n    and time_dim.t_hour = 16\\n    and time_dim.t_minute >= 30\\n    and household_demographics.hd_dep_count = 0\\n    and store.s_store_name = 'ese'\\norder by count(*)\\nlimit 100;",
    "benchmarkResult": {
      "total": 5.67408,
      "compilation": 1.7252999999999998,
      "execution": 3.9487799999999997,
      "scale": 2974005.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1897\\" exact_cardinality=\\"951\\"><TableScan operator_id=\\"3\\" table_name=\\"household_demographics\\" table_size=\\"7200\\" estimated_cardinality=\\"829\\" exact_cardinality=\\"720\\" /><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"16318\\" exact_cardinality=\\"8959\\"><TableScan operator_id=\\"5\\" table_name=\\"time_dim\\" table_size=\\"86400\\" estimated_cardinality=\\"1856\\" exact_cardinality=\\"1800\\" /><TableScan operator_id=\\"6\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"427559\\" exact_cardinality=\\"442113\\" /></Join></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "97.sql",
    "queryText": "with ssci as (\\nselect ss_customer_sk customer_sk\\n      ,ss_item_sk item_sk\\nfrom store_sales,date_dim\\nwhere ss_sold_date_sk = d_date_sk\\n  and d_month_seq between 1204 and 1204 + 11\\ngroup by ss_customer_sk\\n        ,ss_item_sk),\\ncsci as(\\n select cs_bill_customer_sk customer_sk\\n      ,cs_item_sk item_sk\\nfrom catalog_sales,date_dim\\nwhere cs_sold_date_sk = d_date_sk\\n  and d_month_seq between 1204 and 1204 + 11\\ngroup by cs_bill_customer_sk\\n        ,cs_item_sk)\\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\\n                               and ssci.item_sk = csci.item_sk)\\nlimit 100;",
    "benchmarkResult": {
      "total": 42.83399000000001,
      "compilation": 1.9294900000000001,
      "execution": 40.904500000000006,
      "scale": 4468051.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><GroupBy operator_id=\\"1\\" mode=\\"static\\" estimated_cardinality=\\"1\\" exact_cardinality=\\"1\\"><Join operator_id=\\"2\\" type=\\"fullouter\\" method=\\"hash\\" estimated_cardinality=\\"1442552\\" exact_cardinality=\\"829498\\"><GroupBy operator_id=\\"3\\" mode=\\"regular\\" estimated_cardinality=\\"394351\\" exact_cardinality=\\"285788\\"><Join operator_id=\\"4\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"438168\\" exact_cardinality=\\"285839\\"><TableScan operator_id=\\"5\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"6\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1430285\\" exact_cardinality=\\"1434368\\" /></Join></GroupBy><GroupBy operator_id=\\"7\\" mode=\\"regular\\" estimated_cardinality=\\"610773\\" exact_cardinality=\\"543861\\"><Join operator_id=\\"8\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"678636\\" exact_cardinality=\\"549559\\"><TableScan operator_id=\\"9\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"499\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"10\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join></GroupBy></Join></GroupBy></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "98.sql",
    "queryText": "select i_item_id\\n      ,i_item_desc \\n      ,i_category \\n      ,i_class \\n      ,i_current_price\\n      ,sum(ss_ext_sales_price) as itemrevenue \\n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\\n          (partition by i_class) as revenueratio\\nfrom\\t\\n\\tstore_sales\\n    \\t,item \\n    \\t,date_dim\\nwhere \\n\\tss_item_sk = i_item_sk \\n  \\tand i_category in ('Books', 'Home', 'Music')\\n  \\tand ss_sold_date_sk = d_date_sk\\n\\tand d_date between cast('1998-02-22' as date) \\n\\t\\t\\t\\tand (cast('1998-02-22' as date) + interval '30 days')\\ngroup by \\n\\ti_item_id\\n        ,i_item_desc \\n        ,i_category\\n        ,i_class\\n        ,i_current_price\\norder by \\n\\ti_category\\n        ,i_class\\n        ,i_item_id\\n        ,i_item_desc\\n        ,revenueratio;",
    "benchmarkResult": {
      "total": 16.47206,
      "compilation": 3.13796,
      "execution": 13.3341,
      "scale": 2971454.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"556\\" exact_cardinality=\\"2554\\"><Sort operator_id=\\"1\\" estimated_cardinality=\\"556\\" exact_cardinality=\\"2554\\"><Window operator_id=\\"3\\" estimated_cardinality=\\"556\\" exact_cardinality=\\"2554\\"><GroupBy operator_id=\\"4\\" mode=\\"regular\\" estimated_cardinality=\\"556\\" exact_cardinality=\\"2554\\"><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"618\\" exact_cardinality=\\"8125\\"><Join operator_id=\\"6\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"1968\\" exact_cardinality=\\"26713\\"><TableScan operator_id=\\"7\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"49\\" exact_cardinality=\\"31\\" /><TableScan operator_id=\\"8\\" table_name=\\"store_sales\\" table_size=\\"2880404\\" estimated_cardinality=\\"2745385\\" exact_cardinality=\\"2750311\\" /></Join><TableScan operator_id=\\"9\\" table_name=\\"item\\" table_size=\\"18000\\" estimated_cardinality=\\"5378\\" exact_cardinality=\\"5400\\" /></Join></GroupBy></Window></Sort></Result>"
  },
  {
    "system": "umbra_prebuilt [2023-01-13]",
    "dataset": "tpcdsSf1",
    "query": "99.sql",
    "queryText": "select  \\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,cc_name\\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \\"30 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \\"31-60 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \\"61-90 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \\"91-120 days\\" \\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \\">120 days\\" \\nfrom\\n   catalog_sales\\n  ,warehouse\\n  ,ship_mode\\n  ,call_center\\n  ,date_dim\\nwhere\\n    d_month_seq between 1179 and 1179 + 11\\nand cs_ship_date_sk   = d_date_sk\\nand cs_warehouse_sk   = w_warehouse_sk\\nand cs_ship_mode_sk   = sm_ship_mode_sk\\nand cs_call_center_sk = cc_call_center_sk\\ngroup by\\n   substr(w_warehouse_name,1,20)\\n  ,sm_type\\n  ,cc_name\\norder by substr(w_warehouse_name,1,20)\\n        ,sm_type\\n        ,cc_name\\nlimit 100;",
    "benchmarkResult": {
      "total": 12.16026,
      "compilation": 2.43151,
      "execution": 9.72875,
      "scale": 1514629.0
    },
    "queryPlanXml": "<Result operator_id=\\"-1\\" estimated_cardinality=\\"16\\" exact_cardinality=\\"90\\"><Sort operator_id=\\"1\\" limit=\\"100\\" estimated_cardinality=\\"16\\" exact_cardinality=\\"90\\"><GroupBy operator_id=\\"2\\" mode=\\"regular\\" estimated_cardinality=\\"16\\" exact_cardinality=\\"90\\"><Join operator_id=\\"3\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"116683\\" exact_cardinality=\\"284589\\"><TableScan operator_id=\\"4\\" table_name=\\"call_center\\" table_size=\\"6\\" estimated_cardinality=\\"6\\" exact_cardinality=\\"6\\" /><Join operator_id=\\"5\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"116683\\" exact_cardinality=\\"284589\\"><TableScan operator_id=\\"6\\" table_name=\\"ship_mode\\" table_size=\\"20\\" estimated_cardinality=\\"20\\" exact_cardinality=\\"20\\" /><Join operator_id=\\"7\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"116683\\" exact_cardinality=\\"284589\\"><TableScan operator_id=\\"8\\" table_name=\\"warehouse\\" table_size=\\"5\\" estimated_cardinality=\\"5\\" exact_cardinality=\\"5\\" /><Join operator_id=\\"9\\" type=\\"inner\\" method=\\"hash\\" estimated_cardinality=\\"116683\\" exact_cardinality=\\"284589\\"><TableScan operator_id=\\"10\\" table_name=\\"date_dim\\" table_size=\\"73049\\" estimated_cardinality=\\"214\\" exact_cardinality=\\"365\\" /><TableScan operator_id=\\"11\\" table_name=\\"catalog_sales\\" table_size=\\"1441548\\" estimated_cardinality=\\"1424654\\" exact_cardinality=\\"1428170.0\\" /></Join></Join></Join></Join></GroupBy></Sort></Result>"
  }
]`;
